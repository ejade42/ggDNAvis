<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ggplot2-Based Tools for Visualising DNA Sequences and Modifications • ggDNAvis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><meta property="og:title" content="ggplot2-Based Tools for Visualising DNA Sequences and Modifications">
<meta name="description" content="Uses ggplot2 to visualise either (a) a single DNA/RNA sequence split across multiple lines, (b) multiple DNA/RNA sequences, each occupying a whole line, or (c) base modifications such as DNA methylation called by modified bases models in Dorado or Guppy. Functions starting with visualise_&lt;&gt;() are the main plotting functions, and functions starting with extract_and_sort_&lt;&gt;() are key helper functions for reading files and reformatting data. Source code is available at &lt;https://github.com/ejade42/ggDNAvis&gt;, a full non-expert user guide is available at &lt;https://ejade42.github.io/ggDNAvis/&gt;, and an interactive web-app version of the software is available at &lt;https://ejade42.github.io/ggDNAvis/articles/interactive_app.html&gt;">
<meta property="og:description" content="Uses ggplot2 to visualise either (a) a single DNA/RNA sequence split across multiple lines, (b) multiple DNA/RNA sequences, each occupying a whole line, or (c) base modifications such as DNA methylation called by modified bases models in Dorado or Guppy. Functions starting with visualise_&lt;&gt;() are the main plotting functions, and functions starting with extract_and_sort_&lt;&gt;() are key helper functions for reading files and reformatting data. Source code is available at &lt;https://github.com/ejade42/ggDNAvis&gt;, a full non-expert user guide is available at &lt;https://ejade42.github.io/ggDNAvis/&gt;, and an interactive web-app version of the software is available at &lt;https://ejade42.github.io/ggDNAvis/articles/interactive_app.html&gt;">
<meta property="og:image" content="https://ejade42.github.io/ggDNAvis/logo.png">
<link rel="stylesheet" href="extra.css">
<script src="extra.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ggDNAvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2.9053</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-interactive-app" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Interactive App</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-interactive-app">
<li><a class="dropdown-item" href="articles/interactive_app.html">Embedded</a></li>
    <li><a class="external-link dropdown-item" href="https://ejade42-ggdnavis.share.connect.posit.cloud/" target="_blank">Fullscreen</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-version" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Version</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-version">
<li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/">Latest release</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/dev/">Latest dev</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.2/">v0.3.2</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.1/">v0.3.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.0/">v0.3.0</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.1/">v0.2.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.0/">v0.2.0</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ejade42/ggDNAvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ggdnavis-">ggDNAvis 
<a class="anchor" aria-label="anchor" href="#ggdnavis-"></a>
</h1>
</div>
<!-- badges: start -->

<div id="github-only-warning">
<blockquote>
<p><strong>Important:</strong> I strongly recommend reading this documentation on the <a href="https://ejade42.github.io/ggDNAvis/">pkgdown documentation website</a> rather than on GitHub! The website includes proper formatting, a dynamic table of contents, an embedded interactive GUI for the tools, full documentation and examples for all functions, and a much better reading experience. Bear in mind that GitHub always displays the latest version of the README (usually a dev version) while the main website is for the latest release version – however, the <a href="https://ejade42.github.io/ggDNAvis/dev/">latest dev section of the website</a> always matches the latest dev GitHub.</p>
</blockquote>
</div>
</div>
<div class="section level1">
<h1 id="id_1-introduction">1 Introduction<a class="anchor" aria-label="anchor" href="#id_1-introduction"></a>
</h1>
<div class="section level2">
<h2 id="id_11-general-introduction">1.1 General introduction<a class="anchor" aria-label="anchor" href="#id_11-general-introduction"></a>
</h2>
<p>ggDNAvis is an R package that uses ggplot2 to visualise genetic data of three main types:</p>
<ol style="list-style-type: decimal">
<li><p>a single DNA/RNA sequence split across multiple lines,</p></li>
<li><p>multiple DNA/RNA sequences, each occupying a whole line, or</p></li>
<li><p>base modifications such as DNA methylation called by modified-bases models in Dorado or Guppy.</p></li>
</ol>
<p>This is accomplished through main functions <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>, and <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> respectively. Each of these has helper sequences for streamlined data processing, as detailed later in the section for each visualisation type.</p>
<p>Additionally, ggDNAvis contains a built-in example dataset (<code>example_many_sequences</code>) and a set of colour palettes for DNA visualisation (<code>sequence_colour_palettes</code>).</p>
<p>As of v1.0.0, <code>aliases</code> are now fully configured so either American or British spellings should work. “Colour” and “visualise” remain the spellings used throughout the code and documentation but “color”, “col”, and “visualize” should also work in all function and argument names (e.g. <code><a href="reference/visualise_single_sequence.html">visualize_single_sequence()</a></code>). If any American spellings don’t work then please submit a bug report at <a href="https://github.com/ejade42/ggDNAvis/issues" class="external-link uri">https://github.com/ejade42/ggDNAvis/issues</a>.</p>
</div>
<div class="section level2">
<h2 id="id_12-installation">1.2 Installation<a class="anchor" aria-label="anchor" href="#id_12-installation"></a>
</h2>
<p>The latest release of ggDNAvis is available from CRAN or via github releases. Alternatively, the latest in-development version can be installed directly from the github repository, but may have unexpected bugs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Latest release version</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggDNAvis"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Current development build (may have unexpected bugs!)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ejade42/ggDNAvis"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Specific version from github</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ejade42/ggDNAvis"</span>, ref <span class="op">=</span> <span class="st">"v1.0.0"</span><span class="op">)</span></span></code></pre></div>
<p>Throughout this manual, only <code>ggDNAvis</code>, <code>dplyr</code>, and <code>ggplot2</code> are loaded. The following chunk provides setup for rendering this README page and should NOT be copied verbatim. If you are trying to work through the examples, use the alternative setup chunk below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## THIS SETUP CHUNK IS FOR THE WEBPAGE AND WILL NOT WORK FOR RUNNING THE EXAMPLES LOCALLY</span></span>
<span></span>
<span><span class="co">## Load this package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ejade42.github.io/ggDNAvis/">ggDNAvis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load useful tidyverse packages</span></span>
<span><span class="co">## These are ggDNAvis dependencies, so will always be installed when installing ggDNAvis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Function for viewing tables throughout this document</span></span>
<span><span class="co">## This is not a package data-processing function, it just helps make this document</span></span>
<span><span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">quoted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"`"</span>, <span class="va">x</span>, <span class="st">"`"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>        check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">kable_output</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">quoted</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">kable_output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Function for viewing figures throughout this document</span></span>
<span><span class="va">view_image</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Set up file locations</span></span>
<span><span class="va">output_location</span> <span class="op">&lt;-</span> <span class="st">"README_files/output/"</span></span>
<span><span class="va">display_location</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/"</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>fig.path <span class="op">=</span> <span class="va">output_location</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Print current ggDNAvis version</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Loaded ggDNAvis version is:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## Loaded ggDNAvis version is: 0.3.2.9026</span></span></code></pre></div>
<p>If you are working through the examples, use this setup chunk instead:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## THIS SETUP CHUNK WILL ALLOW YOU TO RUN THE EXAMPLES YOURSELF</span></span>
<span></span>
<span><span class="co">## Load pacakges</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ejade42.github.io/ggDNAvis/">ggDNAvis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span> <span class="co">## additional - needed for viewing images</span></span>
<span></span>
<span><span class="co">## Function for printing tables to console</span></span>
<span><span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">quoted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"`"</span>, <span class="va">x</span>, <span class="st">"`"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>        check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">table_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">quoted</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">table_output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Function for viewing figures in plot window</span></span>
<span><span class="va">view_image</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## File location to output to</span></span>
<span><span class="va">output_location</span> <span class="op">&lt;-</span> <span class="st">"PUT YOUR FOLDER NAME HERE ENDING IN A SLASH/"</span></span>
<span><span class="va">display_location</span> <span class="op">&lt;-</span> <span class="va">output_location</span> <span class="co"># you probably want these to be the same</span></span>
<span></span>
<span><span class="co">## Print current ggDNAvis version</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Loaded ggDNAvis version is:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_13-interactive-suite">1.3 Interactive suite<a class="anchor" aria-label="anchor" href="#id_13-interactive-suite"></a>
</h2>
<p>An interactive GUI-based version of ggDNAvis that runs in a browser is available from the “interactive app” tab of the top navbar of this website, or directly from <a href="https://ejade42-ggdnavis.share.connect.posit.cloud/" class="external-link uri">https://ejade42-ggdnavis.share.connect.posit.cloud/</a>.</p>
<p>This is implemented via a Shiny app, which can also be launched from R on any local computer that has <code>ggDNAvis</code> installed, via the <code><a href="reference/ggDNAvis_shinyapp.html">ggDNAvis_shinyapp()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ggDNAvis_shinyapp.html">ggDNAvis_shinyapp</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The files for the app are stored in the <code>inst/shinyapp/</code> directory, accessible via <code>system.file("shinyapp/", package = "ggDNAvis")</code>.</p>
</div>
</div>
<div class="section level1">
<h1 id="id_2-summaryquickstart">2 Summary/quickstart<a class="anchor" aria-label="anchor" href="#id_2-summaryquickstart"></a>
</h1>
<p>This section contains one example for each type of visualisation. See the relevant full sections for more details and customisation options.</p>
<div class="section level2">
<h2 id="id_21-single-sequence">2.1 Single sequence<a class="anchor" aria-label="anchor" href="#id_21-single-sequence"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create input sequence. This can be any DNA/RNA string</span></span>
<span><span class="va">sequence</span> <span class="op">&lt;-</span> <span class="st">"GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGC"</span></span>
<span></span>
<span><span class="co">## Create visualisation</span></span>
<span><span class="co">## This lists out all arguments</span></span>
<span><span class="co">## Usually it's fine to leave most of these as defaults</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    sequence <span class="op">=</span> <span class="va">sequence</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_single_sequence.png"</span><span class="op">)</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_single_sequence.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_single_sequence.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_22-many-sequences">2.2 Many sequences<a class="anchor" aria-label="anchor" href="#id_22-many-sequences"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Read and merge data</span></span>
<span><span class="va">fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_fastq.html">read_fastq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span>, calculate_length <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">metadata</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">merged_fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_fastq_with_metadata.html">merge_fastq_with_metadata</a></span><span class="op">(</span><span class="va">fastq_data</span>, <span class="va">metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract character vector</span></span>
<span><span class="co">## These arguments should all be considered, as they are highly specific to your data</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    sequence_dataframe <span class="op">=</span> <span class="va">merged_fastq_data</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"forward_sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create visualisation</span></span>
<span><span class="co">## Usually it's fine to leave most of these as defaults</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    sequences_vector <span class="op">=</span> <span class="va">sequences_for_visualisation</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_many_sequences.png"</span><span class="op">)</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_many_sequences.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_many_sequences.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_23-methylationmodification">2.3 Methylation/modification<a class="anchor" aria-label="anchor" href="#id_23-methylationmodification"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Read and merge data</span></span>
<span><span class="va">modification_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_modified_fastq.html">read_modified_fastq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw_modified.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metadata</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">merged_modification_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata</a></span><span class="op">(</span></span>
<span>    <span class="va">modification_data</span>, </span>
<span>    <span class="va">metadata</span>,</span>
<span>    reversed_location_offset <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract list of character vectors</span></span>
<span><span class="co">## These arguments should all be considered, as they are highly specific to your data</span></span>
<span><span class="va">methylation_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    modification_data <span class="op">=</span> <span class="va">merged_modification_data</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"forward_C+m?_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"forward_C+m?_probabilities"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create visualisation</span></span>
<span><span class="co">## Usually it's fine to leave most of these as defaults</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">51</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_methylation_none.png"</span><span class="op">)</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_methylation_none.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_methylation_none.png"><!-- --></p>
<div class="section level3">
<h3 id="id_231-methylation-showing-sequence">2.3.1 Methylation showing sequence<a class="anchor" aria-label="anchor" href="#id_231-methylation-showing-sequence"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create visualisation showing sequence</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_methylation_sequence.png"</span><span class="op">)</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_methylation_sequence.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_methylation_sequence.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="id_232-methylation-showing-probabilities">2.3.2 Methylation showing probabilities<a class="anchor" aria-label="anchor" href="#id_232-methylation-showing-probabilities"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create visualisation showing probabilities</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span>
<span>    sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">256</span><span class="op">)</span>,</span>
<span>    sequence_text_rounding <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_methylation_probabilities.png"</span><span class="op">)</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_methylation_probabilities.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_methylation_probabilities.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="id_233-methylation-showing-probability-integers">2.3.3 Methylation showing probability integers<a class="anchor" aria-label="anchor" href="#id_233-methylation-showing-probability-integers"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create visualisation showing probability integers</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span>
<span>    sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sequence_text_rounding <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_methylation_probability_integers.png"</span><span class="op">)</span>,</span>
<span>    render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_methylation_probability_integers.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_methylation_probability_integers.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="id_234-methylation-scalebar">2.3.4 Methylation scalebar<a class="anchor" aria-label="anchor" href="#id_234-methylation-scalebar"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to ggplot object</span></span>
<span><span class="co">## Usually it's fine to leave most of these as defaults</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    full_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">255</span><span class="op">)</span>,</span>
<span>    precision <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    axis_location <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    do_axis_ticks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object (the object is just a standard ggplot)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"summary_methylation_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"summary_methylation_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/summary_methylation_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="id_3-loading-data">3 Loading data<a class="anchor" aria-label="anchor" href="#id_3-loading-data"></a>
</h1>
<div class="section level2">
<h2 id="id_31-introduction-to-example_many_sequences">3.1 Introduction to <code>example_many_sequences</code>
<a class="anchor" aria-label="anchor" href="#id_31-introduction-to-example_many_sequences"></a>
</h2>
<p>ggDNAvis comes with example dataset <code>example_many_sequences</code>. In this data, each row/observation represents one read. Reads are associated with metadata such as the participant and family to which they belong, and with sequence data such as the DNA sequence, FASTQ quality scores, and modification information retrieved from the MM and ML tags in a SAM/BAM file.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View the first 4 rows of example_many_sequences data</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_many_sequences</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">methylation_locations</th>
<th align="left">methylation_probabilities</th>
<th align="left">hydroxymethylation_locations</th>
<th align="left">hydroxymethylation_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
</tr>
</tbody>
</table>
<p>The DNA sequence in column <code>sequence</code> is the information used for visualising single/multiple sequences. For visualising DNA modification, this data contains information on both 5-cytosine-methylation and 5-cytosine-hydroxymethylation. For a given modification type (e.g. methylation), visualisation requires a column of locations and a column of probabilities. In this dataset, the relevant columns are <code>methylation_locations</code> and <code>methylation_probabilities</code> for methylation and <code>hydroxymethylation_locations</code> and <code>hydroxymethylation_probabilities</code> for hydroxymethylation.</p>
<p>Locations are stored as a comma-condensed string of integers for each read, produced via <code><a href="reference/vector_to_string.html">vector_to_string()</a></code>, and indicate the indices along the read at which the probability of modification was assessed. For example, methylation might be assessed at each CpG site, which in the read <code>"GGCGGCGGAGGCGGCGGA"</code> would be the third, sixth, twelfth, and fifteenth bases, thus the location string would be <code>"3,6,12,15"</code> for that read.</p>
<p>Probabilities are also a comma-condensed string of integers produced via <code><a href="reference/vector_to_string.html">vector_to_string()</a></code>, but here each integer represents the probability that the corresponding base is modified. Probabilities are stored as 8-bit integers (0-255) where a score of <span class="math inline">p</span> represents the probability space from <span class="math inline">\frac{p}{256}</span> to <span class="math inline">\frac{p+1}{256}</span>. For the read above, a probability string of <code>"250,3,50,127"</code> would indicate that the third base is almost certainly methylated (97.66%-98.05%), the sixth base is almost certainly not methylated (1.17%-1.56%), the twelfth base is most likely not methylated (19.53%-19.92%), and the fifteenth base may or may not be methylated (49.61%-50.00%)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Function to convert integer scores to corresponding percentages</span></span>
<span><span class="va">convert_8bit_to_decimal_prob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="va">x</span>   <span class="op">/</span> <span class="fl">256</span>, </span>
<span>             <span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Convert comma-condensed string back to numerical vector</span></span>
<span><span class="co">## string_to_vector() and vector_to_string() are crucial ggDNAvis helpers</span></span>
<span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/string_to_vector.html">string_to_vector</a></span><span class="op">(</span><span class="st">"250,3,50,127"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For each probability, print 8-bit score then percentage range</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">probability</span> <span class="kw">in</span> <span class="va">probabilities</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">percentages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">convert_8bit_to_decimal_prob</span><span class="op">(</span><span class="va">probability</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"8-bit probability: "</span>, <span class="va">probability</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Decimal probability: "</span>, <span class="va">percentages</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"% - "</span>, <span class="va">percentages</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"%"</span>, <span class="st">"\n\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="do">## 8-bit probability: 250</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="do">## Decimal probability: 97.66% - 98.05%</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="do">## 8-bit probability: 3</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="do">## Decimal probability: 1.17% - 1.56%</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="do">## 8-bit probability: 50</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="do">## Decimal probability: 19.53% - 19.92%</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="do">## 8-bit probability: 127</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="do">## Decimal probability: 49.61% - 50%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_32-introduction-to-string_to_vector-and-vector_to_string">3.2 Introduction to <code>string_to_vector()</code> and <code>vector_to_string()</code>
<a class="anchor" aria-label="anchor" href="#id_32-introduction-to-string_to_vector-and-vector_to_string"></a>
</h2>
<p>Lots of the data used in ggDNAvis requires a series of multiple values to be stored within a single observation in a dataframe. The solution used here is condensing vectors to a single string (character value) for simple storage, then reconstituting the original vectors when needed. These functions are basic wrappers around <code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code> and <code>paste(, collapse = ",")</code> but are easy to use and readable.</p>
<p>Additionally, these can be used when reading SAM/BAM MM and ML tags, which are stored as comma-separated lists within modified FASTQ files, so can also be processed using these functions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/vector_to_string.html">vector_to_string</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## [1] "1,2,3,4"</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/string_to_vector.html">string_to_vector</a></span><span class="op">(</span><span class="st">"1,2,3,4"</span><span class="op">)</span> <span class="co"># the default vector type is numeric</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="do">## [1] 1 2 3 4</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/vector_to_string.html">vector_to_string</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"these"</span>, <span class="st">"are"</span>, <span class="st">"some"</span>, <span class="st">"words"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="do">## [1] "these,are,some,words"</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/string_to_vector.html">string_to_vector</a></span><span class="op">(</span><span class="st">"these,are,some,words"</span>, type <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="do">## [1] "these" "are"   "some"  "words"</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/vector_to_string.html">vector_to_string</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="do">## [1] "TRUE,FALSE,TRUE"</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/string_to_vector.html">string_to_vector</a></span><span class="op">(</span><span class="st">"TRUE,FALSE,TRUE"</span>, type <span class="op">=</span> <span class="st">"logical"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="do">## [1]  TRUE FALSE  TRUE</span></span></code></pre></div>
<p>If multiple strings (i.e. a character vector) are input to <code><a href="reference/string_to_vector.html">string_to_vector()</a></code>, it will concatenate them and produce a single output vector. This is intended, useful behaviour to help with some of the visualisation code in this package. If a list of separate vectors for each input value is desired, <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> can be used.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/string_to_vector.html">string_to_vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1,2,3"</span>, <span class="st">"4,5,6"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="do">## [1] 1 2 3 4 5 6</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1,2,3"</span>, <span class="st">"4,5,6"</span><span class="op">)</span>, <span class="va">string_to_vector</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="do">## [1] 1 2 3</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="do">## [1] 4 5 6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_33-loading-from-fastq-and-metadata-file">3.3 Loading from FASTQ and metadata file<a class="anchor" aria-label="anchor" href="#id_33-loading-from-fastq-and-metadata-file"></a>
</h2>
<div class="section level3">
<h3 id="id_331-standard-fastq">3.3.1 Standard FASTQ<a class="anchor" aria-label="anchor" href="#id_331-standard-fastq"></a>
</h3>
<p>To read in a normal FASTQ file (containing a read ID/header, sequence, and quality scores for each read), the function <code><a href="reference/read_fastq.html">read_fastq()</a></code> can be used. The example data file for this is <code>inst/extdata/example_many_sequences_raw.fastq</code>, accessible via <code>system.file("extdata/example_many_sequences_raw.fastq", package = "ggDNAvis")</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Look at first 16 lines of FASTQ</span></span>
<span><span class="va">fastq_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">fastq_raw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="do">## F1-1a </span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="do">## )8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90 </span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="do">## F1-1b </span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="do">## 60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139 </span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="do">## F1-1c </span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="do">## TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC </span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="do">## @9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F; </span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="do">## F1-1d </span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="do">## :&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load data from FASTQ</span></span>
<span><span class="va">fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_fastq.html">read_fastq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span>, </span>
<span>    calculate_length <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    strip_at <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fastq_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">quality</th>
<th align="left">sequence_length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>102</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>63</code></td>
</tr>
<tr class="odd">
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC</code></td>
<td align="left"><code>@9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F;</code></td>
<td align="left"><code>87</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>81</code></td>
</tr>
</tbody>
</table>
<p>Using the basic <code><a href="reference/read_fastq.html">read_fastq()</a></code> function returns a dataframe with read ID, sequence, and quality columns. Optionally, a <code>sequence_length</code> column can be generated by setting <code>calculate_length = TRUE</code>. However, we can see that some of the sequences (e.g. F1-1c) are reversed. This occurs when the read is of the - strand at the biochemical level.</p>
<p>To convert reverse reads to their forward equivalents, and incorporate additional data such as the participant and family to which each read belongs, we will make use of a metadata file located at <code>inst/extdata/example_many_sequences_metadata.csv</code>.</p>
<p>Depending on how the FASTQ was created, the read IDs may be prefixed with <code>@</code> (e.g. <code>samtools fastq</code> generally leaves these <code>@</code>s). This can cause issues with metadata merging if the FASTQ has <code>@</code> at the start of each read ID but the metadata doesn’t, as then the reads can’t be matched up. The <code>strip_at</code> argument in <code><a href="reference/read_fastq.html">read_fastq()</a></code> and <code><a href="reference/read_modified_fastq.html">read_modified_fastq()</a></code> (on by default), removes a single leading <code>@</code> from each read ID that starts with <code>@</code>, and does nothing to read IDs that don’t start with <code>@</code>. If the metadata <em>does</em> have IDs beginning with <code>@</code>, then they can be kept in the FASTQ data by setting <code>strip_at = FALSE</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load metadata from CSV</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metadata</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">direction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>forward</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>forward</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>reverse</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>forward</code></td>
</tr>
</tbody>
</table>
<p>We see that this metadata file contains the same <code>read</code> column with the same unique read IDs and a <code>direction</code> column specifying whether each read is <code>"forward"</code> or <code>"reverse"</code>. These two columns are mandatory. Additionally, we have family and participant ID columns providing additional information on each read.</p>
<p>Note: the <code>direction</code> column can be produced manually. However, for large data volumes it may be more effective to use SAMtools to write TXT files of all forward and reverse read IDs via the <code>-F</code>/<code>-f 16</code> flags, e.g.:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co">## bash/shell code for using SAMtools on the command line:</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co">## See the samtools flag documentation for more details on why</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co">## -F 16 selects forward reads and -f 16 selects reverse reads</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="ex">samtools</span> view <span class="at">-F</span> 16 <span class="va">${input_bam_file}</span> <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="fu">awk</span> <span class="st">'{print $1}'</span> <span class="op">&gt;</span> <span class="st">"forward_reads.txt"</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="ex">samtools</span> view <span class="at">-f</span> 16 <span class="va">${input_bam_file}</span> <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="fu">awk</span> <span class="st">'{print $1}'</span> <span class="op">&gt;</span> <span class="st">"reverse_reads.txt"</span></span></code></pre></div>
<p>Then simply read the lines from each file and use that to assign directions:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use files from last step to construct vectors of forward and reverse IDs</span></span>
<span><span class="va">forward_reads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"forward_reads.txt"</span><span class="op">)</span></span>
<span><span class="va">reverse_reads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"reverse_reads.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use rep() to add a direction column</span></span>
<span><span class="va">constructed_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    read <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">forward_reads</span>, <span class="va">reverse_reads</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"forward"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">forward_reads</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"reverse"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">reverse_reads</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In any case, once we have metadata with the <code>read</code> and <code>direction</code> columns, we can use <code><a href="reference/merge_fastq_with_metadata.html">merge_fastq_with_metadata()</a></code> to combine the metadata and the fastq data. Crucially, this function uses the <code>direction</code> column of the metadata to determine which reads are reverse, and reverse-complements these reverse reads only to produce a new column containing the forward version of all reads.</p>
<p>Note that there are three options for how to manage these reverse reads:</p>
<ul>
<li>
<code>reverse_complement_mode = "DNA"</code> reverse-complements, with A being mapped to T. This is the default.</li>
<li>
<code>reverse_complement_mode = "RNA"</code> reverse-complements, with A being mapped to U.</li>
<li>
<code>reverse_complement_mode = "reverse_only"</code> reverses but does not complement, meaning reverse reads will be shown 3’-5’ (i.e. complementary to the 5’-3’ forward reads) as opposed to being complemented into the 5’-3’ forward reads.</li>
</ul>
<p>This example with proceed with the default <code>reverse_complement_mode = "DNA"</code>, but be aware that <code>"reverse_only"</code> is an option if reverse reads want to be visualised aligned with forward reads without complementing.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Merge fastq data with metadata</span></span>
<span><span class="co">## This function reverse-complements reverse reads to get all forward versions</span></span>
<span><span class="va">merged_fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_fastq_with_metadata.html">merge_fastq_with_metadata</a></span><span class="op">(</span><span class="va">fastq_data</span>, <span class="va">metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_fastq_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">read</th>
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">direction</th>
<th align="left">sequence</th>
<th align="left">quality</th>
<th align="left">sequence_length</th>
<th align="left">forward_sequence</th>
<th align="left">forward_quality</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
</tr>
<tr class="odd">
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>reverse</code></td>
<td align="left"><code>TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC</code></td>
<td align="left"><code>@9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F;</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
</tr>
</tbody>
</table>
<p>Now we have a <code>forward_sequence</code> column (scroll to the right if you can’t see it!). We can now reformat this data to be exactly the same as the included <code>example_many_sequences</code> data:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Subset to only the columns present in example_many_sequences</span></span>
<span><span class="va">merged_fastq_data</span> <span class="op">&lt;-</span> <span class="va">merged_fastq_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"individual"</span>, <span class="st">"read"</span>, <span class="st">"forward_sequence"</span>, <span class="st">"sequence_length"</span>, <span class="st">"forward_quality"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Rename "forward_sequence" to "sequence" and same for quality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">merged_fastq_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"quality"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows of data produced from files</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_fastq_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View first 4 rows of example_many_sequences (with modification columns excluded)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Check if equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">merged_fastq_data</span>, <span class="va">example_many_sequences</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>So, from just a standard FASTQ file and a simple metadata CSV we have successfully reproduced the example_many_sequences data (excluding methylation/modification information) via <code><a href="reference/read_fastq.html">read_fastq()</a></code> and <code><a href="reference/merge_fastq_with_metadata.html">merge_fastq_with_metadata()</a></code>. We can also write from this dataframe to FASTQ using <code><a href="reference/write_fastq.html">write_fastq()</a></code>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use write_fastq with filename = NA and return = TRUE to create the FASTQ, </span></span>
<span><span class="co">## but return it as a character vector rather than writing to file.</span></span>
<span><span class="va">output_fastq</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/write_fastq.html">write_fastq</a></span><span class="op">(</span></span>
<span>    <span class="va">merged_fastq_data</span>, </span>
<span>    filename <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    read_id_colname <span class="op">=</span> <span class="st">"read"</span>, </span>
<span>    sequence_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    quality_colname <span class="op">=</span> <span class="st">"quality"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 16 lines</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">output_fastq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="do">## F1-1a </span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="do">## )8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90 </span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="do">## F1-1b </span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="do">## 60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139 </span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="do">## F1-1c </span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="do">## ;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@ </span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a><span class="do">## F1-1d </span></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="do">## :&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</span></span></code></pre></div>
<p>Note that this is not quite identical to the original. That’s because we wrote from the forward-sequence and forward-quality columns (after renaming), so the new FASTQ contains all forward versions. If we wanted the original FASTQ we would just provide colnames for the original sequence and quality rather than the forward versions.</p>
<p>Do be careful that either both sequence and quality are the forward versions or neither are. If they are mismatched then the new FASTQ will be wrong.</p>
</div>
<div class="section level3">
<h3 id="id_332-modified-fastq-eg-methylation">3.3.2 Modified FASTQ (eg methylation)<a class="anchor" aria-label="anchor" href="#id_332-modified-fastq-eg-methylation"></a>
</h3>
<p>FASTQ files can be modified to include DNA modification (most often 5-cytosine-methylation) information within the header lines. This is a very specific file format that is generally produced under the following conditions:</p>
<ul>
<li>Oxford Nanopore sequencing is used</li>
<li>Raw FAST5/POD5/BLOW5 signal files are basecalled to SAM/BAM using a modification-capable model in Guppy or Dorado (see <a href="https://software-docs.nanoporetech.com/dorado/latest/basecaller/mods/" target="_blank" class="external-link">modified basecalling documentation</a>)</li>
<li>SAM/BAM, which stores modification information in the MM and ML tags, is converted to FASTQ with MM/ML information copied to header rows via:</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="ex">samtools</span> fastq <span class="at">-T</span> MM,ML <span class="va">${input_bam_file}</span> <span class="op">&gt;</span> <span class="st">"modified_fastq_file.fastq"</span></span></code></pre></div>
<p>ggDNAvis then contains tools for reading from, processing, and writing to these modified FASTQ files. The example data file for this is <code>inst/extdata/example_many_sequences_raw_modified.fastq</code>, accessible via <code>system.file("extdata/example_many_sequences_raw_modified.fastq", package = "ggDNAvis")</code>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Look at first 16 lines of FASTQ</span></span>
<span><span class="va">modified_fastq_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw_modified.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">modified_fastq_raw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="do">## F1-1a    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34,29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41 </span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="do">## )8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90 </span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="do">## F1-1b    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2,10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253 </span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="do">## 60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139 </span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a><span class="do">## F1-1c    MM:Z:C+h?,1,1,5,1,1,5,1,1,5,1,1,5,1,1,1,1,1,1,1,1;C+m?,1,1,5,1,1,5,1,1,5,1,1,5,1,1,1,1,1,1,1,1; ML:B:C,37,47,64,63,33,64,52,55,17,46,47,64,56,64,56,60,55,58,63,40,45,192,126,129,39,129,183,79,19,195,62,124,173,128,84,159,80,165,141,206 </span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="do">## TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC </span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="do">## @9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F; </span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a><span class="do">## F1-1d    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55,216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82 </span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="do">## :&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</span></span></code></pre></div>
<p>This file is identical to the standard FASTQ seen in the <a href="#id_331-standard-fastq">reading standard FASTQ</a> section in the sequence and quality lines, but has the MM and ML tags stored in the header. See the <a href="https://samtools.github.io/hts-specs/SAMtags.pdf" class="external-link">SAM tags specification</a> or the documentation for <code><a href="reference/read_modified_fastq.html">read_modified_fastq()</a></code>, <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>, and <code><a href="reference/reverse_locations_if_needed.html">reverse_locations_if_needed()</a></code> for a comprehensive explanation of how these store methylation/modification information.</p>
<p>The modification information stored in these FASTQ header lines can be parsed with <code><a href="reference/read_modified_fastq.html">read_modified_fastq()</a></code>. This converts the locations from the SAM/BAM MM format to simply being the indices along the read at which modification was assessed (starting indexing at 1). For example, in F1-1a, the <code>C+m?</code> (methylation) locations start <code>"3,6,9,12"</code>, indicating that the third, sixth, ninth, and twelfth bases in the read were assessed for probability of methylation. Checking the sequence, we see that all of these are CpG sites (CG dinucleotides), which are the main DNA methylation sites in the genome. For each assessed site, the modification probability is given as an 8-bit integer (0-255), where 0 represents ~0% modification probability and 255 represents ~100% modification probability (this is fully explained in <a href="#id_31-introduction-to-example_many_sequences">introduction to <code>example_many_sequences</code></a>).</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load data from FASTQ</span></span>
<span><span class="va">methylation_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_modified_fastq.html">read_modified_fastq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw_modified.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span>,</span>
<span>    strip_at <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">methylation_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">modification_types</th>
<th align="left">C+h?_locations</th>
<th align="left">C+h?_probabilities</th>
<th align="left">C+m?_locations</th>
<th align="left">C+m?_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
</tr>
<tr class="odd">
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>@9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F;</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>37,47,64,63,33,64,52,55,17,46,47,64,56,64,56,60,55,58,63,40</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>45,192,126,129,39,129,183,79,19,195,62,124,173,128,84,159,80,165,141,206</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
</tr>
</tbody>
</table>
<p>Ultimately, <code><a href="reference/read_modified_fastq.html">read_modified_fastq()</a></code> outputs a dataframe with the standard read information (ID, sequence, length, quality), a column stating which modification types were assessed for each read (e.g. <code>"C+h?"</code> for hydroxymethylation or <code>"C+m?"</code> for methylation - refer to the <a href="https://samtools.github.io/hts-specs/SAMtags.pdf" class="external-link">SAM tags specification</a>), and for each modification type, a column of assessed locations (indices along the read) and a column of modification probabilities (as 8-bit integers).</p>
<p>Modification types, locations, and probabilities are all stored as comma-condensed strings produced from vectors via <code><a href="reference/vector_to_string.html">vector_to_string()</a></code>. These can be converted back to vectors via <code><a href="reference/string_to_vector.html">string_to_vector()</a></code> - see <a href="#id_32-introduction-to-string_to_vector-and-vector_to_string">introduction to string/vector functions</a>.</p>
<p>As with the standard FASTQ, some of the reads in the modified FASTQ are reverse. However, as the assessed modification locations are indices along the read and the probabilities correspond to locations in sequence, the modification information needs to be reversed in addition to reverse complementing the DNA sequence. Analogous to before, this is achieved via the <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code> function.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load metadata from CSV</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metadata</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">direction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>forward</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>forward</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>reverse</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>forward</code></td>
</tr>
</tbody>
</table>
<p>The metadata is identical to its previous use in the <a href="#id_331-standard-fastq">reading from standard FASTQ</a> section.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Merge fastq data with metadata</span></span>
<span><span class="co">## This function reverse-complements reverse reads to get all forward versions</span></span>
<span><span class="co">## And correctly flips location and probability information</span></span>
<span><span class="co">## See ?merged_methylation_data and ?reverse_locations_if_needed for details</span></span>
<span><span class="va">merged_methylation_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata</a></span><span class="op">(</span><span class="va">methylation_data</span>, <span class="va">metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_methylation_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">read</th>
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">direction</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">modification_types</th>
<th align="left">C+h?_locations</th>
<th align="left">C+h?_probabilities</th>
<th align="left">C+m?_locations</th>
<th align="left">C+m?_probabilities</th>
<th align="left">forward_sequence</th>
<th align="left">forward_quality</th>
<th align="left">forward_C+h?_locations</th>
<th align="left">forward_C+h?_probabilities</th>
<th align="left">forward_C+m?_locations</th>
<th align="left">forward_C+m?_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
</tr>
<tr class="odd">
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>reverse</code></td>
<td align="left"><code>TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>@9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F;</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>37,47,64,63,33,64,52,55,17,46,47,64,56,64,56,60,55,58,63,40</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>45,192,126,129,39,129,183,79,19,195,62,124,173,128,84,159,80,165,141,206</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>4,7,10,13,16,19,22,25,28,37,40,43,52,55,58,67,70,73,82,85</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
<td align="left"><code>4,7,10,13,16,19,22,25,28,37,40,43,52,55,58,67,70,73,82,85</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
</tr>
</tbody>
</table>
<p>The merged methylation data contains <code>forward_</code> rows for sequence and quality, as before, but also for hydroxymethylation and methylation locations and probabilities. However, looking at the modification locations columns (scroll right on the table), we can see that the indices assessed for modification are 4, 7, 10 etc for sequence <code>"GGCGGCGGCGGC..."</code>. This is because the actual biochemical modification was on the Cs on the reverse strand, corresponding to Gs on the forward strand according to Watson-Crick base pairing. For many purposes, it may be desirable to keep these positions to indicate that in reality, the modification occurred at exactly that location on the other strand. This is accomplished by setting <code>offset = 0</code> (the default) inside <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>.</p>
<p>However, there is also the option to offset the modification locations by 1. For symmetrical modification sites such as CGs, this means that when the C on the reverse strand is modified, that gets attributed to the <em>C</em> on the forward strand even though the direct complementary base is the G. The advantage of this is that it means CG sites (i.e. potential methylation sites) always have 5-methylcytosine modifications associated with the C of each CG, regardless of which strand the information came from. This is also often useful, as it ensures the information is consistent and (provided locations are palindromic when reverse-complemented) modifications are always attached to the correct base e.g. C-methylation to C. This is accomplished by setting <code>offset = 1</code> inside <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>.</p>
<p><strong><em>Either of these options can be valid and useful, but make sure you think about it!</em></strong></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="do">## Here the stars represent the true biochemical modifications on the reverse strand:</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="do">## (occurring at the Cs of CGs in the 5'-3' direction)</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="do">## If we take the complementary locations on the forward strand,</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a><span class="do">## the modification locations correspond to Gs rather than Cs,</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="do">## but are in the exact same locations:</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a><span class="do">##        o  o  o  o  o      </span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a><span class="do">## If we offset the locations by 1 on the forward strand,</span></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a><span class="do">## the modifications are always associated with the C of a CG,</span></span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a><span class="do">## but the locations are moved slightly:</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a><span class="do">##       o  o  o  o  o       </span></span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span></code></pre></div>
<p>We will proceed with <code>offset = 1</code> so that the forward versions match up with <code>example_many_sequences</code>.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Merge fastq data with metadata, offsetting reversed locations by 1</span></span>
<span><span class="va">merged_methylation_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata</a></span><span class="op">(</span></span>
<span>    <span class="va">methylation_data</span>, </span>
<span>    <span class="va">metadata</span>, </span>
<span>    reversed_location_offset <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_methylation_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">read</th>
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">direction</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">modification_types</th>
<th align="left">C+h?_locations</th>
<th align="left">C+h?_probabilities</th>
<th align="left">C+m?_locations</th>
<th align="left">C+m?_probabilities</th>
<th align="left">forward_sequence</th>
<th align="left">forward_quality</th>
<th align="left">forward_C+h?_locations</th>
<th align="left">forward_C+h?_probabilities</th>
<th align="left">forward_C+m?_locations</th>
<th align="left">forward_C+m?_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
</tr>
<tr class="odd">
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>reverse</code></td>
<td align="left"><code>TCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCTCCTCCGCCGCCGCCGCCGCCGCCGCCGCCGCC</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>@9889C8&lt;&lt;*96;52!*86,227.&lt;I.8AI&lt;&gt;;2/391%D19*5@G=8&lt;7&lt;:!7+;:I:-!03&lt;0AI&gt;9?4!57I*-C#25FD24F;</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>37,47,64,63,33,64,52,55,17,46,47,64,56,64,56,60,55,58,63,40</code></td>
<td align="left"><code>3,6,15,18,21,30,33,36,45,48,51,60,63,66,69,72,75,78,81,84</code></td>
<td align="left"><code>45,192,126,129,39,129,183,79,19,195,62,124,173,128,84,159,80,165,141,206</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
</tr>
<tr class="even">
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>forward</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>C+h?,C+m?</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
</tr>
</tbody>
</table>
<p>Now, looking at the methylation and hydroxymethylation locations we see that the forward-version locations are 3, 6, 9, 12…, corresponding to the Cs of CGs. This makes the reversed reverse read consistent with the forward reads.</p>
<p>We can now extract the relevant columns and demonstrate that this new dataframe read from modified FASTQ and metadata CSV is exactly the same as <code>example_many_sequences</code>.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Subset to only the columns present in example_many_sequences</span></span>
<span><span class="va">merged_methylation_data</span> <span class="op">&lt;-</span> <span class="va">merged_methylation_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"individual"</span>, <span class="st">"read"</span>, <span class="st">"forward_sequence"</span>, <span class="st">"sequence_length"</span>, <span class="st">"forward_quality"</span>, <span class="st">"forward_C+m?_locations"</span>, <span class="st">"forward_C+m?_probabilities"</span>, <span class="st">"forward_C+h?_locations"</span>, <span class="st">"forward_C+h?_probabilities"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Rename "forward_sequence" to "sequence" and same for quality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">merged_methylation_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"quality"</span>, <span class="st">"methylation_locations"</span>, <span class="st">"methylation_probabilities"</span>, <span class="st">"hydroxymethylation_locations"</span>, <span class="st">"hydroxymethylation_probabilities"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 4 rows of data produced from files</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_methylation_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">methylation_locations</th>
<th align="left">methylation_probabilities</th>
<th align="left">hydroxymethylation_locations</th>
<th align="left">hydroxymethylation_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View first 4 rows of example_many_sequences</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_many_sequences</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">methylation_locations</th>
<th align="left">methylation_probabilities</th>
<th align="left">hydroxymethylation_locations</th>
<th align="left">hydroxymethylation_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Check if equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">merged_methylation_data</span>, <span class="va">example_many_sequences</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>So, from a modified FASTQ file and the metadata CSV we have successfully reproduced the example_many_sequences data <em>including</em> methylation/modification information via <code><a href="reference/read_modified_fastq.html">read_modified_fastq()</a></code> and <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>. And similarly to before, we can write back to a modified FASTQ file via <code><a href="reference/write_modified_fastq.html">write_modified_fastq()</a></code>.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use write_modified_fastq with filename = NA and return = TRUE to create </span></span>
<span><span class="co">## the FASTQ, but return it as a character vector rather than writing to file.</span></span>
<span><span class="va">output_fastq</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/write_modified_fastq.html">write_modified_fastq</a></span><span class="op">(</span></span>
<span>    <span class="va">merged_methylation_data</span>, </span>
<span>    filename <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    read_id_colname <span class="op">=</span> <span class="st">"read"</span>, </span>
<span>    sequence_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    quality_colname <span class="op">=</span> <span class="st">"quality"</span>,</span>
<span>    locations_colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydroxymethylation_locations"</span>,</span>
<span>                        <span class="st">"methylation_locations"</span><span class="op">)</span>,</span>
<span>    probabilities_colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydroxymethylation_probabilities"</span>,</span>
<span>                            <span class="st">"methylation_probabilities"</span><span class="op">)</span>,</span>
<span>    modification_prefixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C+h?"</span>, <span class="st">"C+m?"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View first 16 lines</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">output_fastq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="do">## F1-1a    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34,29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41 </span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a><span class="do">## )8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90 </span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="do">## F1-1b    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2,10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253 </span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a><span class="do">## 60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139 </span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="do">## F1-1c    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37,206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45 </span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a><span class="do">## ;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@ </span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a><span class="do">## F1-1d    MM:Z:C+h?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;C+m?,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ML:B:C,33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55,216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82 </span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="do">## GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA </span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="do">## + </span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a><span class="do">## :&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</span></span></code></pre></div>
<p>As with the standard FASTQ, this is not quite identical to the original. That’s because we wrote from the forward-sequence, forward-quality, forward-locations, and forward-probabilities columns (after renaming), so the new FASTQ contains all forward versions. If we wanted the original FASTQ we would just provide colnames for the original sequence, quality, locations, and probabilities rather than the forward versions.</p>
<p>Do be careful that either all of sequence, quality, locations, and probabilities are the forward versions or none are. If they are mismatched then the new FASTQ will be wrong.</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="id_4-visualising-a-single-dnarna-sequence">4 Visualising a single DNA/RNA sequence<a class="anchor" aria-label="anchor" href="#id_4-visualising-a-single-dnarna-sequence"></a>
</h1>
<div class="section level2">
<h2 id="id_41-basic-visualisation">4.1 Basic visualisation<a class="anchor" aria-label="anchor" href="#id_41-basic-visualisation"></a>
</h2>
<p>ggDNAvis can be used to visualise a single DNA sequence via <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>. This function is extremely simple, just taking a DNA sequence as input. We will use the <em>NOTCH2NLC</em> repeat expansion sequence of F1-1 from Figure 1 of Sone et al. (2019), but with some GGCs replaced with GGT so that all four nucleotides are visualised.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define sequence variable</span></span>
<span><span class="va">sone_2019_f1_1_expanded_ggt_added</span> <span class="op">&lt;-</span> <span class="st">"GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGTGGTGGTGGTGGTGGTGGTGGTGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGCGGCGGCGGCGGC"</span></span>
<span></span>
<span><span class="co">## Use all default settings</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span><span class="va">sone_2019_f1_1_expanded_ggt_added</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_default-1.png"><!-- --></p>
<p>By default, <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> will return a ggplot object. It can be useful to view this for instant debugging. However, it is not usually rendered at a sensible scale or aspect ratio. Therefore, it is preferable to set a <code>filename = &lt;file_to_write_to.png&gt;</code> for export, as the function has built-in logic for scaling correctly (with resolution configurable via the <code>pixels_per_base</code> argument). We don’t have a use for interactive debugging, so we will also set <code>return = FALSE</code>.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>, </span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_01.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_01.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_01.png"><!-- --></p>
<p>This is the typical single sequence visualisation produced by this package. However, almost every aspect of the visualisation is configurable via arguments to <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> (and the resulting <code>ggplot</code> object can be further modified in standard <code>ggplot</code> manner if required).</p>
<p>The resolution can be changed with <code>pixels_per_base</code>, but it is recommended to not go too low otherwise text can become illegible (and going too high obviously increases filesize). The default value of 100 is often a happy medium.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>, </span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_02.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_02.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_02.png"><!-- --></p>
<p>For all <code>visualise_</code> functions, the <code>render_device</code> argument can be used to control the rendering method. It is fed directly to <code>ggsave(device = )</code>, so the <code>ggsave</code> documentation fully explains its use. The default <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png</a></code> works well and ensures consistent graphics (though not font) rendering across platforms/operating systems, so you should not need to change it.</p>
</div>
<div class="section level2">
<h2 id="id_42-colour-customisation">4.2 Colour customisation<a class="anchor" aria-label="anchor" href="#id_42-colour-customisation"></a>
</h2>
<p>All of the colours used in the visualisation can be modified with the following arguments:</p>
<ul>
<li>
<code>sequence_colours</code>: A length-4 vector of the colours used for the boxes of A, C, G, and T respectively.</li>
<li>
<code>sequence_text_colour</code>: The colour used for the A, C, G, and T lettering inside the boxes.</li>
<li>
<code>index_annotation_colour</code>: The colour used for the index numbers above/below the boxes.</li>
<li>
<code>background_colour</code>: The colour used for the background.</li>
<li>
<code>outline_colour</code>: The colour used for the box outlines.</li>
</ul>
<p>All colour-type arguments should accept <code>colour</code>, <code>color</code>, or <code>col</code> for the argument name.</p>
<p>For example, we can change all of the colours in an inadvisable way:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_03.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span>, <span class="st">"#00FFFF"</span>, <span class="st">"#00FF00"</span><span class="op">)</span>,</span>
<span>    sequence_text_col <span class="op">=</span> <span class="st">"magenta"</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>    background_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"orange"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_03.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_03.png"><!-- --></p>
<p>Included in <code>ggDNAvis</code> are a set of colour palettes for sequence colours that can often be helpful. The default is <code>sequence_colour_palettes$ggplot_style</code>, as seen in the first example above. The other palettes are <code>$bright_pale</code>, <code>$bright_pale2</code>, <code>$bright_deep</code>, <code>$sanger</code>, and <code>$accessible</code>:</p>
<p>The <code>bright_pale</code> palette works well with either white or black text, depending on how much the text is desired to “pop”:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_04.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_04.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_04.png"><!-- --></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_05.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_05.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_05.png"><!-- --></p>
<p><code>bright_pale2</code> is the same but with a slightly lighter shade of green:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_06.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_06.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_06.png"><!-- --></p>
<p>The <code>bright_deep</code> palette works best with white text:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_07.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_07.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_07.png"><!-- --></p>
<p>The <code>sanger</code> palette is inspired by old-school Sanger sequencing readouts and works best with white text:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_08.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">sanger</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"darkgrey"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_08.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_08.png"><!-- --></p>
<p>The <code>accessible</code> palette is light and dark each of blue and green, which is the only 4-category qualitative colourblind-safe palette recommended by <a href="https://colorbrewer2.org" class="external-link">colorbrewer2.org</a> (Harrower &amp; Brewer, 2003):</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_09.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">accessible</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_09.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_09.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_43-layout-customisation">4.3 Layout customisation<a class="anchor" aria-label="anchor" href="#id_43-layout-customisation"></a>
</h2>
<p>Many aspects of the sequence layout are also customisable via arguments:</p>
<ul>
<li>
<code>line_wrapping</code>: The length/number of bases in each line.</li>
<li>
<code>spacing</code>: The number of blank lines in between each line of sequence. Must be an integer - this is a fundamental consequence of how the images are rasterised and the whole visualisation logic would need to be re-implemented to allow non-integer spacing values.</li>
<li>
<code>margin</code>: The margin around the image in terms of the size of base boxes (e.g. the default value of <code>0.5</code> adds a margin half the size of the base boxes, which is 50 px with the default <code>pixels_per_base = 100</code>). Note that if index annotations are on, there is a minimum margin of 1 above (if annotations are above) of below (if annotations are below) to allow space to render the annotations, so if margin is set to less than this then it will be increased to 1 in the relevant direction. Also note that if the margin is very narrow it can clip the box outlines, as they are rendered centred on the actual edge of the boxes (i.e. they “spill over” a little to each side if outline linewidth is non-zero), so placing the margin exactly at the box edges will cut half the outlines.</li>
<li>
<code>sequence_text_size</code>: The size of the text inside the boxes. Can be set to 0 to disable text inside boxes. Defaults to 16.</li>
<li>
<code>index_annotation_size</code>: The size of the index numbers above/below the boxes. Can be set to <code>0</code> to disable index annotations. Defaults to <code>12.5</code>.</li>
<li>
<code>index_annotation_interval</code>: The frequency at which index numbers should be listed. Can be set to <code>0</code> to disable index annotations. Defaults to <code>15</code>.</li>
<li>
<code>index_annotations_above</code>: Boolean specifying whether index annotations should be drawn above or below each line of sequence. Defaults to <code>TRUE</code> (above).</li>
<li>
<code>index_annotation_vertical_position</code>: How far annotation numbers should be rendered above (if <code>index_annotations_above = TRUE</code>) or below (if <code>index_annotations_above = FALSE</code>) each base. Defaults to <code>1/3</code>, not recommended to change generally. If spacing is much larger than <code>1</code>, setting this to a slightly higher value might be appropriate.</li>
<li>
<code>index_annotation_always_first_base</code>: Boolean specifying whether the first base should always be annotated even if it would not usually be (i.e. <code>index_annotation_interval &gt; 1</code>). Defaults to <code>TRUE</code>.</li>
<li>
<code>index_annotation_always_last_base</code>: Boolean specifying whether the last base should always be annotated even if it would not usually be (i.e. <code>line_length %% index_annotation_interval != 0</code>). Defaults to <code>TRUE</code>.</li>
<li>
<code>outline_linewidth</code>: The thickness of the box outlines. Can be set to <code>0</code> to disable box outlines. Defaults to <code>3</code>.</li>
<li>
<code>outline_join</code>: Changes how the corners of the box outlines are handled. Must be one of <code>"mitre"</code>, <code>"bevel"</code>, or <code>"round"</code>. Defaults to <code>"mitre"</code>. It is unlikely that you would ever need to change this.</li>
</ul>
<p>A sensible example of how these might be changed is as follows:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_10.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">ggplot_style</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_10.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_10.png"><!-- --></p>
<p>Setting spacing, margin, sequence text size, and index annotation interval all to 0 produces a no-frills visualisation of the sequence only. If doing so, <code>pixels_per_base</code> can be set low as there is no text that would be rendered poorly at low resolutions:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_11.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_first_base setting.</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="do">## If you want the first base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_last_base setting.</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a><span class="do">## If you want the last base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a><span class="do">## Warning: If margin is small and outlines are on (outline_linewidth &gt; 0), outlines may be cut off at the edges of the plot. Check if this is happening and consider using a bigger margin.</span></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a><span class="do">## Current margin: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_11.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_11.png"><!-- --> This produced a warning message as setting the margin to 0 clipped off the outlines of the outermost boxes. Either a slightly larger margin can be used:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_12.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_first_base setting.</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="do">## If you want the first base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_last_base setting.</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="do">## If you want the last base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_12.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_12.png"><!-- --></p>
<p>Or the outlines can be turned off:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_13.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_first_base setting.</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="do">## If you want the first base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_last_base setting.</span></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a><span class="do">## If you want the last base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="do">## ℹ Automatically using geom_raster (much faster than geom_tile) as no sequence text, index annotations, or outlines are present.</span></span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_13.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_13.png"><!-- --></p>
<p>When changing line wrapping and annotation interval, divisibility is important. It is generally recommended to make the line wrapping length a multiple of the motif length when visualising repeats (e.g. a multiple of 3 for a trinucleotide repeat), and to make the index annotation interval a factor of the line wrapping length. If the annotation interval is not a factor of the line length, then there will be uneven gaps between annotations as the interval is counted <em>from the start of each line</em>.</p>
<p>Here is an example where these guidelines are not followed:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_14.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    line_wrapping <span class="op">=</span> <span class="fl">65</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_14.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_14.png"><!-- --></p>
<p>When setting spacing to 0, it is highly recommended to disable index annotations via <code>index_annotation_interval = 0</code>, otherwise there is nowhere for them to render:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_15.png"</span><span class="op">)</span>, </span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">sanger</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"magenta"</span>,</span>
<span>    spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"magenta"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="do">## Warning: Using spacing = 0 without disabling index annotation is not recommended.</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="do">## It is likely to draw the annotations overlapping the sequence.</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="do">## Recommended to set index_annotation_interval = 0 to disable index annotations.</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_15.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_15.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_44-performance">4.4 Performance<a class="anchor" aria-label="anchor" href="#id_44-performance"></a>
</h2>
<div class="section level3">
<h3 id="id_441-performance-monitoring">4.4.1 Performance monitoring<a class="anchor" aria-label="anchor" href="#id_441-performance-monitoring"></a>
</h3>
<p>The four major <code>visualise</code> functions in <code>ggDNAvis</code> can track the time taken for each step of the visualisation processing. When the <code>monitor_performance</code> argument is set to <code>TRUE</code>, the date and timestamp will be printed along with the function name (obtained via <code><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time()</a></code>). Then at the start of each processing step, the time since the start of the previous step (i.e. the time that the previous step took) will be printed along with total time since the start of the function.</p>
<p>For example:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_16.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:43:54) visualise_single_sequence start</span></span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a><span class="do">## ℹ (0.005 secs elapsed; 0.005 secs total) resolving aliases</span></span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.006 secs total) validating arguments</span></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.007 secs total) splitting input seq to sequence vector</span></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.008 secs total) rasterising image data</span></span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.010 secs total) choosing rendering method</span></span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.011 secs total) calculating tile sizes</span></span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.012 secs total) creating basic plot via geom_tile</span></span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a><span class="do">## ℹ (0.006 secs elapsed; 0.018 secs total) generating sequence text</span></span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.020 secs total) adding sequence text</span></span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a><span class="do">## ℹ (0.006 secs elapsed; 0.025 secs total) generating index annotations</span></span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.027 secs total) adding index annotations</span></span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.030 secs total) adding general plot themes</span></span>
<span id="cb84-28"><a href="#cb84-28" tabindex="-1"></a></span>
<span id="cb84-29"><a href="#cb84-29" tabindex="-1"></a><span class="do">## ℹ (0.009 secs elapsed; 0.039 secs total) calculating margin</span></span>
<span id="cb84-30"><a href="#cb84-30" tabindex="-1"></a></span>
<span id="cb84-31"><a href="#cb84-31" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.041 secs total) exporting image file</span></span>
<span id="cb84-32"><a href="#cb84-32" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" tabindex="-1"></a><span class="do">## ℹ (0.776 secs elapsed; 0.817 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_16.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_16.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="id_442-raster-versus-tile-rendering">4.4.2 Raster versus tile rendering<a class="anchor" aria-label="anchor" href="#id_442-raster-versus-tile-rendering"></a>
</h3>
<p>Usually, visualisations in <code>ggDNAvis</code> are drawn via <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile()</a></code>. This is highly customisable and allows box outlines, text superimposition, and index annotation. However, for very large datasets, rendering thousands or millions of tiles can become unusuably slow. A much faster alternative is <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code>, which does not allow for text/annotations/outlines but can draw much bigger images when needed.</p>
<p><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> is automatically used when it would not affect the output image (i.e. when sequence text, annotations, and outlines are already off), or can be forced by setting <code>force_raster = TRUE</code>. However, as forcing <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> necessitates removal of text/annotations/outlines, this produces a warning unless they were all already turned off.</p>
<p>Furthermore, as <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> only draws simple boxes, a message is produced if <code>pixels_per_base</code> is greater than 20, as there is not really any benefit and it increases the file size of the image.</p>
<p>An example where <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> automatically switches to <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> and produces a warning for excessive resolution is as follows:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_17.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:43:55) visualise_single_sequence start</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.003 secs total) resolving aliases</span></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.005 secs total) validating arguments</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a><span class="do">## ℹ Automatically setting index_annotation_interval to 0 as index_annotation_size is 0</span></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_first_base setting.</span></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a><span class="do">## If you want the first base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_last_base setting.</span></span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a><span class="do">## If you want the last base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a></span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a><span class="do">## ℹ (0.004 secs elapsed; 0.009 secs total) splitting input seq to sequence vector</span></span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.011 secs total) rasterising image data</span></span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a></span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.014 secs total) choosing rendering method</span></span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a><span class="do">## ℹ Automatically using geom_raster (much faster than geom_tile) as no sequence text, index annotations, or outlines are present.</span></span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a><span class="do">## Warning: When using geom_raster, it is recommended to use a smaller pixels_per_base e.g. 10, as there is no text/outlines that would benefit from higher resolution.</span></span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a><span class="do">## Current value: 100</span></span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a></span>
<span id="cb87-28"><a href="#cb87-28" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.017 secs total) creating basic plot via geom_raster</span></span>
<span id="cb87-29"><a href="#cb87-29" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" tabindex="-1"></a><span class="do">## ℹ (0.005 secs elapsed; 0.021 secs total) adding general plot themes</span></span>
<span id="cb87-31"><a href="#cb87-31" tabindex="-1"></a></span>
<span id="cb87-32"><a href="#cb87-32" tabindex="-1"></a><span class="do">## ℹ (0.011 secs elapsed; 0.033 secs total) calculating margin</span></span>
<span id="cb87-33"><a href="#cb87-33" tabindex="-1"></a></span>
<span id="cb87-34"><a href="#cb87-34" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.035 secs total) exporting image file</span></span>
<span id="cb87-35"><a href="#cb87-35" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" tabindex="-1"></a><span class="do">## ℹ (0.665 secs elapsed; 0.699 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_17.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_17.png"><!-- --></p>
<p>An example of forcing rasterisation when there would otherwise be sequence text, index annotations, and outlines (thus producing a warning) is as follows:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_18.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:43:56) visualise_single_sequence start</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a><span class="do">## ℹ (0.004 secs elapsed; 0.004 secs total) resolving aliases</span></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.006 secs total) validating arguments</span></span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.008 secs total) splitting input seq to sequence vector</span></span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.009 secs total) rasterising image data</span></span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.012 secs total) choosing rendering method</span></span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a><span class="do">## Warning: Forcing geom_raster via force_raster = TRUE will remove all sequence</span></span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a><span class="do">## text, index annotations (though any inserted blank lines/spacers will remain),</span></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a><span class="do">## and box outlines.</span></span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.014 secs total) creating basic plot via geom_raster</span></span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a><span class="do">## ℹ (0.004 secs elapsed; 0.018 secs total) adding general plot themes</span></span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a><span class="do">## ℹ (0.011 secs elapsed; 0.029 secs total) calculating margin</span></span>
<span id="cb90-24"><a href="#cb90-24" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.032 secs total) exporting image file</span></span>
<span id="cb90-26"><a href="#cb90-26" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" tabindex="-1"></a><span class="do">## ℹ (0.295 secs elapsed; 0.327 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_18.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_18.png"><!-- --></p>
<p>If sequence text, annotations, and outlines are all already off (i.e. <code>sequence_text_size = 0</code>, either <code>index_annotation_size = 0</code> or <code>index_annotation_interval = 0</code>, and <code>outline_linewidth = 0</code>), then no warning is produced from <code>force_raster</code> (but it is redundant and doesn’t do anything):</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create image</span></span>
<span><span class="fu"><a href="reference/visualise_single_sequence.html">visualise_single_sequence</a></span><span class="op">(</span></span>
<span>    <span class="va">sone_2019_f1_1_expanded_ggt_added</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"single_sequence_19.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_deep</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:43:56) visualise_single_sequence start</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.002 secs total) resolving aliases</span></span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.003 secs total) validating arguments</span></span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_first_base setting.</span></span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a><span class="do">## If you want the first base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a><span class="do">## Warning: Disabling index annotations via index_annotation_interval = 0 or index_annotation_size = 0 overrides the index_annotation_always_last_base setting.</span></span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a><span class="do">## If you want the last base in each line to be annotated but no other bases, set index_annotation_interval greater than line_wrapping.</span></span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.006 secs total) splitting input seq to sequence vector</span></span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a><span class="do">## ℹ (0.006 secs elapsed; 0.012 secs total) rasterising image data</span></span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.016 secs total) choosing rendering method</span></span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a></span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a><span class="do">## ℹ Automatically using geom_raster (much faster than geom_tile) as no sequence text, index annotations, or outlines are present.</span></span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.018 secs total) creating basic plot via geom_raster</span></span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a></span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a><span class="do">## ℹ (0.005 secs elapsed; 0.024 secs total) adding general plot themes</span></span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a></span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a><span class="do">## ℹ (0.014 secs elapsed; 0.038 secs total) calculating margin</span></span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a></span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.040 secs total) exporting image file</span></span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a></span>
<span id="cb93-31"><a href="#cb93-31" tabindex="-1"></a><span class="do">## ℹ (0.302 secs elapsed; 0.343 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"single_sequence_19.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/single_sequence_19.png"><!-- --></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="id_5-visualising-many-dnarna-sequences">5 Visualising many DNA/RNA sequences<a class="anchor" aria-label="anchor" href="#id_5-visualising-many-dnarna-sequences"></a>
</h1>
<div class="section level2">
<h2 id="id_51-basic-visualisation">5.1 Basic visualisation<a class="anchor" aria-label="anchor" href="#id_51-basic-visualisation"></a>
</h2>
<p>ggDNAvis can be used to visualise multiple DNA sequences via <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>. This function takes a vector of sequences as its primary input, which do not all have to be the same length and can be blank for spacing lines. This can be constructed manually e.g. <code>c("GGCGGCGGC", "", "TTATTA")</code>, but is more easily produced by <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code>.</p>
<p>Here is an example of how that could be accomplished with the <code>example_many_sequences</code> data, with a reminder of how to load sequence/quality data from FASTQ and merge with metadata (as fully explained in the <a href="#id_331-standard-fastq">reading standard FASTQ</a> section):</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reminder of how to load data from file</span></span>
<span><span class="va">fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_fastq.html">read_fastq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span>, </span>
<span>    calculate_length <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">metadata</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">merged_fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_fastq_with_metadata.html">merge_fastq_with_metadata</a></span><span class="op">(</span><span class="va">fastq_data</span>, <span class="va">metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Subset and change colnames to make it match example_many_sequences</span></span>
<span><span class="va">merged_fastq_data</span> <span class="op">&lt;-</span> <span class="va">merged_fastq_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"individual"</span>, <span class="st">"read"</span>, <span class="st">"forward_sequence"</span>, <span class="st">"sequence_length"</span>, <span class="st">"forward_quality"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">merged_fastq_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"quality"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Prove equivalance to example_many_sequences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">merged_fastq_data</span>, <span class="va">example_many_sequences</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Look at first 4 rows of the data as a reminder</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_fastq_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span><span class="va">merged_fastq_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View the character vector</span></span>
<span><span class="va">sequences_for_visualisation</span></span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="do">##  [1] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="do">##  [2] "GGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="do">##  [3] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a><span class="do">##  [4] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                     </span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a><span class="do">##  [5] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="do">##  [6] ""                                                                                                      </span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="do">##  [7] ""                                                                                                      </span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a><span class="do">##  [8] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                 </span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a><span class="do">##  [9] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="do">## [10] ""                                                                                                      </span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a><span class="do">## [11] ""                                                                                                      </span></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a><span class="do">## [12] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a><span class="do">## [13] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a><span class="do">## [14] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a><span class="do">## [15] ""                                                                                                      </span></span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a><span class="do">## [16] ""                                                                                                      </span></span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a><span class="do">## [17] ""                                                                                                      </span></span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a><span class="do">## [18] ""                                                                                                      </span></span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a><span class="do">## [19] ""                                                                                                      </span></span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a><span class="do">## [20] ""                                                                                                      </span></span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a><span class="do">## [21] ""                                                                                                      </span></span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a><span class="do">## [22] ""                                                                                                      </span></span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a><span class="do">## [23] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a><span class="do">## [24] ""                                                                                                      </span></span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a><span class="do">## [25] ""                                                                                                      </span></span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a><span class="do">## [26] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"            </span></span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a><span class="do">## [27] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a><span class="do">## [28] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a><span class="do">## [29] ""                                                                                                      </span></span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a><span class="do">## [30] ""                                                                                                      </span></span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a><span class="do">## [31] ""                                                                                                      </span></span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a><span class="do">## [32] ""                                                                                                      </span></span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a><span class="do">## [33] ""                                                                                                      </span></span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a><span class="do">## [34] ""                                                                                                      </span></span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a><span class="do">## [35] ""                                                                                                      </span></span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a><span class="do">## [36] ""                                                                                                      </span></span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a><span class="do">## [37] "GGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a><span class="do">## [38] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a><span class="do">## [39] ""                                                                                                      </span></span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a><span class="do">## [40] ""                                                                                                      </span></span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a><span class="do">## [41] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"         </span></span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a><span class="do">## [42] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGA"            </span></span>
<span id="cb99-43"><a href="#cb99-43" tabindex="-1"></a><span class="do">## [43] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGCGGA"               </span></span>
<span id="cb99-44"><a href="#cb99-44" tabindex="-1"></a><span class="do">## [44] ""                                                                                                      </span></span>
<span id="cb99-45"><a href="#cb99-45" tabindex="-1"></a><span class="do">## [45] ""                                                                                                      </span></span>
<span id="cb99-46"><a href="#cb99-46" tabindex="-1"></a><span class="do">## [46] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb99-47"><a href="#cb99-47" tabindex="-1"></a><span class="do">## [47] ""                                                                                                      </span></span>
<span id="cb99-48"><a href="#cb99-48" tabindex="-1"></a><span class="do">## [48] ""                                                                                                      </span></span>
<span id="cb99-49"><a href="#cb99-49" tabindex="-1"></a><span class="do">## [49] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb99-50"><a href="#cb99-50" tabindex="-1"></a><span class="do">## [50] "GGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGA"            </span></span>
<span id="cb99-51"><a href="#cb99-51" tabindex="-1"></a><span class="do">## [51] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGCGGCGGA"</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_01.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_01.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_01.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_52-sequence-arrangement-customisation">5.2 Sequence arrangement customisation<a class="anchor" aria-label="anchor" href="#id_52-sequence-arrangement-customisation"></a>
</h2>
<p>The <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code> function is highly configurable to change the arrangement and spacing of the sequences.</p>
<p>It takes the following arguments:</p>
<ul>
<li>
<code>sequence_dataframe</code>: The data to be processed</li>
<li>
<code>sequence_variable</code>: The name of the column we are extracting. This doesn’t actually have to be a sequence, it could be any information that we want to convert into a sorted vector spaced out with empty strings.</li>
<li>
<code>grouping_levels</code>: How the data should be grouped. This is a named numerical vector stating which variables/columns should be used to group the data, and how many lines should be left between groups at each level. For example, the default <code>c("family" = 8, "individual" = 2)</code> means the top-level grouping is done by categories in the <code>"family"</code> column and there are 8 blank lines between each family, and the second-level gropuing is done by the <code>"individual"</code> column and there are 2 blank lines between individuals within the same family. This is implemented recursively, so any number of grouping variables can be used (or this can be set to <code>NA</code> to turn off grouping entirely).</li>
<li>
<code>sort_by</code>: The name of the column used to sort sequences within the lowest-level groups. This is generally the sequence length (but doesn’t have to be).</li>
<li>
<code>desc_sort</code>: Whether the sequences should be sorted by the <code>sort_by</code> variable descending (<code>desc_sort = TRUE</code>) or (<code>desc_sort = FALSE</code>).</li>
</ul>
<p>The image above used all the default values, which are set up to work with the columns present in <code>example_many_sequences</code> and use the families-separated-by-8, individuals-separated-by-2 grouping and arranged sequences in descending length order.</p>
<p>Here is the same image but with the default arguments explicitly stated:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="co">## Remember that example_many_sequences is identical to the data </span></span>
<span><span class="co">## read from FASTQ and metadata CSV in the previous code section</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## We will not view the character vector in the interests of avoiding clutter.</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_02.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_02.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_02.png"><!-- --></p>
<p>Here the top large cluster is Family 1, containing individuals F1-1, F1-2, and F-3. These individuals contain 5, 2, and 3 reads respectively, and are separated from each other by 2 blank lines. After Family 1, there is there 8 blank lines before Family 2. Family 2 contains F2-1 and F2-2 with 1 and 3 reads (individuals separated by 2 blank lines), then there are 8 blank lines before Family 3. Family 3 contains F3-1, F3-2, F3-3, and F3-4 with 2, 3, 1, and 3 reads.</p>
<p>If we wanted to group only by individual without showing the family structure, and present reads in ascending length order for each individual, we could do the following:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"individual"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_03.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_03.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_03.png"><!-- --></p>
<p>Now we have a group for each individual, with sequences in ascending length order per individual, and one blank line between individuals.</p>
<p>We could also turn off grouping entirely to just visualise all of the reads in length order, via <code>grouping_levels = NA</code>:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_04.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_04.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_04.png"><!-- --></p>
<p>We can also turn off sorting entirely (keeping grouping off) with <code>sort_by = NA</code> to simply show all the reads in the order in which they appear in the dataframe:</p>
<p>NB: if <code>sort_by = NA</code> is used, then <code>desc_sort</code> does nothing so it doesn’t matter what it is set to.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_05.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_05.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_05.png"><!-- --></p>
<p>It is also possible to keep grouping on while turning sorting off if desired:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_06.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_06.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_06.png"><!-- --></p>
<p>The grouping spacers can be set to 0 to sort within groups without visually separating them (but negative values don’t work - they produce an error in <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code> as the blank line can’t be repeated a negative number of times). Additionally, the order of the groups/levels within a grouping variable can be changed in standard R fashion with <code>factor(x, levels = ...)</code>:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reorder families</span></span>
<span><span class="va">example_many_sequences_reordered</span> <span class="op">&lt;-</span> <span class="va">example_many_sequences</span></span>
<span><span class="va">example_many_sequences_reordered</span><span class="op">$</span><span class="va">family_reordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences_reordered</span><span class="op">$</span><span class="va">family</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Family 2"</span>, </span>
<span>               <span class="st">"Family 3"</span>, </span>
<span>               <span class="st">"Family 1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences_reordered</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family_reordered"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_07.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_07.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_07.png"><!-- --></p>
<p>Finally, all the same grouping and sorting logic can be used to extract any other column as a character vector, though of course if it isn’t DNA sequence then the resulting vector is not valid input to <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>. The column for extraction is specified by <code>sequence_variable</code>, and the column for sorting is <code>sort_by</code>. If the <code>sort_by</code> column is non-numeric then it will be sorted alphabetically, just like using <code><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort()</a></code> on a character vector.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract qualities to character vector,</span></span>
<span><span class="co">## sorted alphabetically by quality string</span></span>
<span><span class="va">extracted_and_sorted_qualities</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    sequence_variable <span class="op">=</span> <span class="st">"quality"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"quality"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View character vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">extracted_and_sorted_qualities</span>, quote <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="do">##  [1] )8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="do">##  [2] *46.5//3:37?24:(:0*#.))E)?:,/172=2!4"&gt;.*/;"8+5&lt;;D6.I2=&gt;:C3)108,&lt;)GC161)!55E!.&gt;86/                     </span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="do">##  [3] 60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139                                       </span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="do">##  [4] 736/A@B121C269&lt;2I,'5G66&gt;46A6-9*&amp;4*;4-E4C429?I+3@83(234E0%:43;!/3;2+956A0)(+'5G4=*3;1                  </span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="do">##  [5] :&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0                     </span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a><span class="do">##  [6] ;4*2E3-48?@6A-!00!;-3%:H,4H&gt;H530C(85I/&amp;75-62.:2#!/D=A?8&amp;7E!-@:=::5,)51,97D*04'2.!20@/;6)947&lt;6         </span></span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a><span class="do">##  [7] ;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@               </span></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a><span class="do">##  [8] ?;.*26&lt;C-8B,3#8/,-9!1++:94:/!A317=9&gt;502=-+8;$=53@D*?/6:6&amp;0D7-.@8,5;F,1?0D?$9'&amp;665B8.604               </span></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a><span class="do">##  [9] E6(&lt;)"-./EE&lt;(5:47,(C818I9CC1=.&amp;)4G6-7&lt;(*"(,2C&gt;8/5:0@@).A$97I!-&lt;                                       </span></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a><span class="do">## [10] F='I#*5I:&lt;F?)&lt;4G3&amp;:95*-5?1,!:9BD4B5.-27577&lt;2E9)2:189B.5/*#7;;'**.7;-!                                 </span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="do">## [11]                                                                                                       </span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a><span class="do">## [12]                                                                                                       </span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a><span class="do">## [13] 7?38,EC#3::=1)8&amp;;&lt;"&gt;3.9BE)1661!2)5-4.11B&lt;3)?')-+,B4.&lt;7)/:IE=5$.3:66G9216-C20,&gt;(0848(1$-               </span></span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a><span class="do">## [14] ;1&gt;:5417*&lt;1.2H#260197.;7&lt;(-3?0+=:)ID'I$6*128*!4.7-=5;+384F!=5&gt;4!93+.6I7+H1-).H&gt;&lt;68;7                  </span></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a><span class="do">## [15] =&lt;/-I354/,*&gt;+&lt;CA40*537/;&lt;@I7/4%6192'5'&gt;#4:&amp;C,072+90:0+4;74"D5,38&amp;&lt;7A?00+1&gt;G&gt;#=?;,@&lt;&lt;1=64D=!1&amp;         </span></span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a><span class="do">## [16] @86,/+6=8/;9=1)48E494IB3456/6.*=&lt;/B32+5469&gt;8?@!1;*+81$&gt;-99D7&lt;@1$6B'?462?CE+=1+95=G?.6CA%&gt;2            </span></span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a><span class="do">## [17]                                                                                                       </span></span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a><span class="do">## [18]                                                                                                       </span></span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a><span class="do">## [19] $&lt;,5"7+!$';8&lt;0794*@FI&gt;34224!57+#1!F&lt;+53$,?)-.A3;=1*71C02&lt;.5:1)82!86$03/;%+1C3+D3;@9B-E#+/70;9&lt;D'      </span></span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a><span class="do">## [20] .85$#;!1F$8E:B+;7CI6@11/'65&lt;3,4G:8@GF1413:0)3CH1=44.%G=#2E67=?;9DF7358.;(I!74:1I4                     </span></span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a><span class="do">## [21] /*2&lt;C643?*8?@9)-.'5A!=3-=;6,.%H3-!10'I&gt;&amp;@?;96;+/+36;:C;B@/=:6,;61&gt;?&gt;!,&gt;.97@.48B38(;7;1F464=-7;)7      </span></span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a><span class="do">## [22] /C&lt;$&gt;7/1(9%4:6&gt;6I,D%*,&amp;D?C/6@@;7)83.E.7:@9I906&lt;!4536!850!164/8,&lt;=?=15A;8B/5B364A66.1%9=(9876E8C:      </span></span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a><span class="do">## [23] 0/2&gt;@/6+-/(!=9-?G!AA70*,/!/?-E46:,-1G94*491,,38?(-!6&lt;8A;/C9;,3)4C06=%',86A)1!E@/24G59&lt;&lt;               </span></span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a><span class="do">## [24] 5@&lt;733';9+3BB)=69,3!.2B*86'8E&gt;@3?!(36:&lt;002/4&gt;:1.43A!+;&lt;.3G*G8?0*991,B(C/"I9*1-86)8.;;5-0+=            </span></span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a><span class="do">## [25] 9&gt;124!752+@06I/.72097*';-+A60=B?+/8'15477&gt;4-435D;G@G'./21:(0/1/A=7'I&gt;A"3=9;;12,@"2=3D=,458            </span></span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a><span class="do">## [26] :0I4099&lt;,4E01;/@96%2I2&lt;,%&lt;C&amp;=81F+4&lt;*@4A5.('4!%I3CE657&lt;=!5;37&gt;4D:%3;7'"4&lt;.9;?;7%0&gt;:,84B512,B7/         </span></span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a><span class="do">## [27] ?2-#-2"1:(5(4&gt;!I)&gt;I,.?-+EG3IH4-.C:;570@2I;?D5#/;A7=&gt;?&lt;3?080::459*?8:3"&lt;2;I)C1400)6:3%19./);.I?35</span></span></code></pre></div>
<p>This extracted the <code>quality</code> column, with families separated by 2 blank strings, and sorted alphabetically by quality string within each family.</p>
</div>
<div class="section level2">
<h2 id="id_53-index-annotation-customisation">5.3 Index annotation customisation<a class="anchor" aria-label="anchor" href="#id_53-index-annotation-customisation"></a>
</h2>
<p>As of <code>ggDNAvis</code> v1.0.0, <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code> (and <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code>) support index annotation. This is implemented differently to <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> because each line represents a different sequence/read, so it would not make sense to maintain a single base count. Instead, base indices are counted along each line and reset for each new line. To reduce redundancy, it is user-configurable which lines are annotated.</p>
<p>The full set of arguments controlling index annotations are:</p>
<ul>
<li>
<code>index_annotation_lines</code>: This is a <strong><em>key argument to change</em></strong>. Controls which lines should have their indices annotated. Defaults to <code>1</code> i.e. only the first line will be annotated. Can be set to <code>1:length(sequences_vector)</code> to annotate all lines, or to a custom integer vector to annotate specific lines. With the default argument values of <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code>, <code>c(1, 23, 37)</code> annotates the first sequence from each family, which I personally find a useful setting. It may take some trial and error to find the ideal setting of this for each ordering/dataset. Can be set to <code>0</code>, <code>FALSE</code>, <code>NA</code>, <code>NULL</code>, or <code>numeric(0)</code> to disable index annotations.</li>
<li>
<code>index_annotation_full_line</code>: Whether the annotations should always continue to the end of the longest sequence (<code>TRUE</code>, default) or whether they should end once the sequence along each annotated line ends (<code>FALSE</code>).</li>
<li>
<code>index_annotation_colour</code>: The colour used for the index numbers above/below the boxes. Defaults to dark red.</li>
<li>
<code>index_annotation_size</code>: The size of the index numbers above/below the boxes. Can be set to <code>0</code> to disable index annotations. Defaults to <code>12.5</code>.</li>
<li>
<code>index_annotation_interval</code>: The frequency at which index numbers should be listed. Defaults to <code>15</code>. Note that unlike <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, the count resets each line in <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code> and <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> because each line is assumed to be a different sequence.</li>
<li>
<code>index_annotations_above</code>: Boolean specifying whether index annotations should be drawn above or below each line of sequence. Defaults to <code>TRUE</code> (above).</li>
<li>
<code>index_annotation_always_first_base</code>: Boolean specifying whether the first base should always be annotated even if it would not usually be (i.e. <code>index_annotation_interval &gt; 1</code>). Defaults to <code>TRUE</code>. Note that this only applies to lines where annotations would be drawn, so not if they are excluded by <code>index_annotation_lines</code> or disabled via <code>index_annotation_interval = 0</code> or <code>index_annotation_size = 0</code>. If the goal is to annotate the first base and no others in each line, turn this on but set <code>index_annotation_interval</code> to a value greater than the maximum sequence length.</li>
<li>
<code>index_annotation_always_last_base</code>: Boolean specifying whether the last base should always be annotated even if it would not usually be (i.e. <code>line_length %% index_annotation_interval != 0</code>). Defaults to <code>TRUE</code>.</li>
<li>
<code>index_annotation_vertical_position</code>: How far annotation numbers should be rendered above (if <code>index_annotations_above = TRUE</code>) or below (if <code>index_annotations_above = FALSE</code>) each base. Defaults to <code>1/3</code>, not recommended to change generally.</li>
</ul>
<p>We will work through these arguments step by step to fully explain how they work.</p>
<p>By default, annotations are drawn above the first line:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector, using all default settings</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="co">## index_annotation_lines = c(1) is the default value</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_08.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_08.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_08.png"><!-- --></p>
<p>However, any numerical vector can be used as <code>index_annotation_lines</code> to specify which lines should be annotated. For each selected line, an additional blank/spacer line will be inserted above (if <code>index_annotations_above = TRUE</code>) or below (if <code>index_annotations_below = FALSE</code>), and index annotations will be drawn in the new space.</p>
<p><em>(Note: if <code>index_annotation_vertical_position</code> is more than 1, more than 1 additional blank line will be inserted, according to <code>ceiling(index_annotation_vertical_position)</code>).</em></p>
<p>Annotating above each line would look as follows:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_09.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">51</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_09.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_09.png"><!-- --></p>
<p>To annotate below the final line of each family, we can look at the sequences vector:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequences_for_visualisation</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="do">##  [1] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="do">##  [2] "GGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="do">##  [3] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a><span class="do">##  [4] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                     </span></span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a><span class="do">##  [5] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a><span class="do">##  [6] ""                                                                                                      </span></span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a><span class="do">##  [7] ""                                                                                                      </span></span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a><span class="do">##  [8] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                 </span></span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a><span class="do">##  [9] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a><span class="do">## [10] ""                                                                                                      </span></span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a><span class="do">## [11] ""                                                                                                      </span></span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a><span class="do">## [12] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a><span class="do">## [13] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a><span class="do">## [14] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a><span class="do">## [15] ""                                                                                                      </span></span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a><span class="do">## [16] ""                                                                                                      </span></span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a><span class="do">## [17] ""                                                                                                      </span></span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a><span class="do">## [18] ""                                                                                                      </span></span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a><span class="do">## [19] ""                                                                                                      </span></span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a><span class="do">## [20] ""                                                                                                      </span></span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a><span class="do">## [21] ""                                                                                                      </span></span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a><span class="do">## [22] ""                                                                                                      </span></span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a><span class="do">## [23] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a><span class="do">## [24] ""                                                                                                      </span></span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a><span class="do">## [25] ""                                                                                                      </span></span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a><span class="do">## [26] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"            </span></span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a><span class="do">## [27] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a><span class="do">## [28] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a><span class="do">## [29] ""                                                                                                      </span></span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a><span class="do">## [30] ""                                                                                                      </span></span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a><span class="do">## [31] ""                                                                                                      </span></span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a><span class="do">## [32] ""                                                                                                      </span></span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a><span class="do">## [33] ""                                                                                                      </span></span>
<span id="cb112-34"><a href="#cb112-34" tabindex="-1"></a><span class="do">## [34] ""                                                                                                      </span></span>
<span id="cb112-35"><a href="#cb112-35" tabindex="-1"></a><span class="do">## [35] ""                                                                                                      </span></span>
<span id="cb112-36"><a href="#cb112-36" tabindex="-1"></a><span class="do">## [36] ""                                                                                                      </span></span>
<span id="cb112-37"><a href="#cb112-37" tabindex="-1"></a><span class="do">## [37] "GGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb112-38"><a href="#cb112-38" tabindex="-1"></a><span class="do">## [38] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb112-39"><a href="#cb112-39" tabindex="-1"></a><span class="do">## [39] ""                                                                                                      </span></span>
<span id="cb112-40"><a href="#cb112-40" tabindex="-1"></a><span class="do">## [40] ""                                                                                                      </span></span>
<span id="cb112-41"><a href="#cb112-41" tabindex="-1"></a><span class="do">## [41] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"         </span></span>
<span id="cb112-42"><a href="#cb112-42" tabindex="-1"></a><span class="do">## [42] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGA"            </span></span>
<span id="cb112-43"><a href="#cb112-43" tabindex="-1"></a><span class="do">## [43] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGCGGA"               </span></span>
<span id="cb112-44"><a href="#cb112-44" tabindex="-1"></a><span class="do">## [44] ""                                                                                                      </span></span>
<span id="cb112-45"><a href="#cb112-45" tabindex="-1"></a><span class="do">## [45] ""                                                                                                      </span></span>
<span id="cb112-46"><a href="#cb112-46" tabindex="-1"></a><span class="do">## [46] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb112-47"><a href="#cb112-47" tabindex="-1"></a><span class="do">## [47] ""                                                                                                      </span></span>
<span id="cb112-48"><a href="#cb112-48" tabindex="-1"></a><span class="do">## [48] ""                                                                                                      </span></span>
<span id="cb112-49"><a href="#cb112-49" tabindex="-1"></a><span class="do">## [49] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb112-50"><a href="#cb112-50" tabindex="-1"></a><span class="do">## [50] "GGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGA"            </span></span>
<span id="cb112-51"><a href="#cb112-51" tabindex="-1"></a><span class="do">## [51] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGCGGCGGA"</span></span></code></pre></div>
<p>We can see that lines 14, 28, and 51 are the last sequence in each family, so we will annotate below those lines (and also enable annotating the first base in each line):</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_10.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">28</span>, <span class="fl">51</span><span class="op">)</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_10.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_10.png"><!-- --></p>
<p>As with <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, the frequency of annotations along each line is controlled by <code>index_annotation_interval</code>. Additionally, it is configurable whether annotations continue to the end of the image (<code>index_annotation_full_line = TRUE</code>, default) or stop when each annotated sequence ends (<code>index_annotation_full_line = FALSE</code>).</p>
<p>Annotating above every line every 3 bases until each sequence ends would look as follows:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_11.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">51</span><span class="op">)</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_11.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_11.png"><!-- --></p>
<p>And doing the same but annotating until the end of the image regardless of when each sequence ends would look as follows:</p>
<p>Note that the blank/spacing lines are also annotated, but with <code>index_annotation_full_line = FALSE</code> they don’t display anything as there is no sequence (however, the additional spacers are still inserted to make room for theoretical annotations).</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_12.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">51</span><span class="op">)</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_12.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_12.png"><!-- --></p>
<p>Customising the colour, size, and vertical position of annotations works exactly the same as <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> via <code>index_annotation_colour</code>, <code>index_annotation_size</code>, and <code>index_annotation_vertical_position</code> respectively:</p>
<p>(if you make the text much bigger than this then the <code>margin</code> will also need increasing to prevent the top of the text being cut off).</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_13.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">1.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_13.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_13.png"><!-- --></p>
<p>Finally, index annotations can of course also be turned completely off if desired. The ‘canonical’ way of doing this is by setting <code>index_annotation_lines = NA</code> or <code>index_annotation_lines = numeric(0)</code>, but <code>index_annotation_size = 0</code> and <code>index_annotation_interval = 0</code> also work perfectly well:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_14.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_14.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_14.png"><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_15.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="do">## ℹ Automatically emptying index_annotation_lines as index_annotation_interval is 0</span></span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_15.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_15.png"><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_16.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="do">## ℹ Automatically emptying index_annotation_lines as index_annotation_size is 0</span></span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_16.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_16.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_54-colour-and-layout-customisation">5.4 Colour and layout customisation<a class="anchor" aria-label="anchor" href="#id_54-colour-and-layout-customisation"></a>
</h2>
<p>As with <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, colours in <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code> are highly customisable and can use the various palettes from <code>sequence_colour_palettes</code>. Additionally, margin, resolution, and text size are customisable (including turning text off by setting size to <code>0</code>).</p>
<p>Colour-related arguments:</p>
<ul>
<li>
<code>sequence_colours</code>: A length-4 vector of the colours used for the boxes of A, C, G, and T respectively.</li>
<li>
<code>sequence_text_colour</code>: The colour used for the A, C, G, and T lettering inside the boxes.</li>
<li>
<code>index_annotation_colour</code>: The colour used for the index numbers above/below the boxes.</li>
<li>
<code>background_colour</code>: The colour used for the background.</li>
<li>
<code>outline_colour</code>: The colour used for the box outlines.</li>
</ul>
<p>Layout-related arguments:</p>
<ul>
<li>
<code>margin</code>: The margin around the image in terms of the size of base boxes (e.g. the default value of <code>0.5</code> adds a margin half the size of the base boxes, which is 50 px with the default <code>pixels_per_base = 100</code>).</li>
<li>
<code>sequence_text_size</code>: The size of the text inside the boxes. Can be set to <code>0</code> to disable text inside boxes. Defaults to <code>16</code>.</li>
<li>
<code>index_annotation_size</code>: The size of the index numbers above/below the boxes. Can be set to <code>0</code> to disable index annotations. Defaults to <code>12.5</code>.</li>
<li>
<code>outline_linewidth</code>: The thickness of the box outlines. Can be set to <code>0</code> to disable box outlines. Defaults to <code>3</code>.</li>
<li>
<code>outline_join</code>: Changes how the corners of the box outlines are handled. Must be one of <code>"mitre"</code>, <code>"bevel"</code>, or <code>"round"</code>. Defaults to <code>"mitre"</code>. It is unlikely that you would ever need to change this.</li>
<li>
<code>pixels_per_base</code>: Resolution, as determined by number of pixels in the side length of one DNA base square. Everything else is scaled proportionally. Defaults to <code>100</code> (sensible for text, but can be set lower e.g. <code>10</code> or <code>20</code> if text is turned off).</li>
<li>
<code>render_device</code>: The device <code>ggsave</code> should use to render the plot. Defaults to <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png</a></code>, not recommended to change. Can be set to <code>NULL</code> to infer device based on <code>filename</code> extension.</li>
</ul>
<p>All colour-type arguments should accept <code>colour</code>, <code>color</code>, or <code>col</code> for the argument name.</p>
<p>For example, a layout with increased margins, enlarged text, and crazy colours might be:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualization</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualize_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualization</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_17.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"#00FF00"</span>, <span class="st">"magenta"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    sequence_text_col <span class="op">=</span> <span class="st">"cyan"</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>    background_color <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>    outline_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    outline_join <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">40</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">21</span>, <span class="fl">31</span>, <span class="fl">41</span>, <span class="fl">51</span><span class="op">)</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">25</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_17.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_17.png"><!-- --></p>
<p>As with <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, text can be turned off, in which case it is sensible to reduce the resolution:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract sequences to a character vector</span></span>
<span><span class="va">sequences_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                      <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the character vector to make the image</span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences_for_visualisation</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_18.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale2</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="do">## Warning: If margin is small and outlines are on (outline_linewidth &gt; 0),</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a><span class="do">## outlines may be cut off at the edges of the plot. Check if this is happening</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a><span class="do">## and consider using a bigger margin.</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a><span class="do">## ℹ Automatically emptying index_annotation_lines as index_annotation_size is 0</span></span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_18.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_18.png"><!-- --> Note that the margin/outline warning is produced whenever the margin is ≤0.25 and the outline linewidth is &gt;0. Getting the warning does not necessarily mean that the outlines are getting cut off (as this only happens if the half of the outline that falls outside the boxes is thicker than the margin), but if you get the warning you should check. In this case it’s fine and the outlines are not getting cut off with 0.1 margin.</p>
</div>
<div class="section level2">
<h2 id="id_55-performance">5.5 Performance<a class="anchor" aria-label="anchor" href="#id_55-performance"></a>
</h2>
<p>As with <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code>, <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code> primarily uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile()</a></code> but can use the faster <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> if the bells and whistles are not required. This is fully explained in <a href="#id_44-performance"><code>visualise_single_sequence()</code> performance</a>, but the following differences apply here:</p>
<p>For <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> is automatically used if:</p>
<ul>
<li>
<code>sequence_text_size</code> is <code>0</code>,</li>
<li>
<code>index_annotation_lines</code> is <code>NA</code> or <code>numeric(0)</code>, or <code>index_annotation_interval</code> is <code>0</code>, or <code>index_annotation_size</code> is <code>0</code>, and</li>
<li>
<code>outline_linewidth</code> is <code>0</code>
</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_19.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">sanger</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:44:26) visualise_many_sequences start</span></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.003 secs total) resolving aliases</span></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a><span class="do">## ℹ (0.005 secs elapsed; 0.007 secs total) validating arguments</span></span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.009 secs total) inserting blank sequences at specified indices</span></span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a><span class="do">## ℹ (0.001 secs elapsed; 0.010 secs total) rasterising image data</span></span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a><span class="do">## ℹ (0.007 secs elapsed; 0.017 secs total) choosing rendering method</span></span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a></span>
<span id="cb129-15"><a href="#cb129-15" tabindex="-1"></a><span class="do">## ℹ Automatically using geom_raster (much faster than geom_tile) as no sequence text, index annotations, or outlines are present.</span></span>
<span id="cb129-16"><a href="#cb129-16" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" tabindex="-1"></a><span class="do">## ℹ (0.003 secs elapsed; 0.020 secs total) creating basic plot via geom_raster</span></span>
<span id="cb129-18"><a href="#cb129-18" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" tabindex="-1"></a><span class="do">## ℹ (0.004 secs elapsed; 0.024 secs total) adding general plot themes</span></span>
<span id="cb129-20"><a href="#cb129-20" tabindex="-1"></a></span>
<span id="cb129-21"><a href="#cb129-21" tabindex="-1"></a><span class="do">## ℹ (0.010 secs elapsed; 0.034 secs total) calculating margin</span></span>
<span id="cb129-22"><a href="#cb129-22" tabindex="-1"></a></span>
<span id="cb129-23"><a href="#cb129-23" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.036 secs total) exporting image file</span></span>
<span id="cb129-24"><a href="#cb129-24" tabindex="-1"></a></span>
<span id="cb129-25"><a href="#cb129-25" tabindex="-1"></a><span class="do">## ℹ (0.411 secs elapsed; 0.447 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_19.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_19.png"><!-- --></p>
<p>One important thing to note (which also applies to <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code>) is that if <code>force_raster</code> is set to <code>TRUE</code>, the index annotation text will not be drawn, but the blank rows inserted to make room for it will still be inserted (see <a href="#id_53-index-annotation-customisation">index annotation customisation</a> for how blank rows are inserted). This means the outcome is not identical between forcing <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> and allowing it to be automatically applied by manually turning off text/annotations/outlines:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_many_sequences.html">visualise_many_sequences</a></span><span class="op">(</span></span>
<span>    <span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"many_sequences_20.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">sanger</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">51</span>,</span>
<span>    pixels_per_base <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    force_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    monitor_performance <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="do">## ℹ Verbose monitoring enabled</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a><span class="do">## ℹ (2026-02-27 14:44:27) visualise_many_sequences start</span></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a><span class="do">## ℹ (0.009 secs elapsed; 0.009 secs total) resolving aliases</span></span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.011 secs total) validating arguments</span></span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.013 secs total) inserting blank sequences at specified indices</span></span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.015 secs total) rasterising image data</span></span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a><span class="do">## ℹ (0.011 secs elapsed; 0.026 secs total) choosing rendering method</span></span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a></span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a><span class="do">## Warning: Forcing geom_raster via force_raster = TRUE will remove all sequence</span></span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a><span class="do">## text, index annotations (though any inserted blank lines/spacers will remain),</span></span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a><span class="do">## and box outlines.</span></span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a></span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.028 secs total) creating basic plot via geom_raster</span></span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a></span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a><span class="do">## ℹ (0.004 secs elapsed; 0.033 secs total) adding general plot themes</span></span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a></span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a><span class="do">## ℹ (0.012 secs elapsed; 0.044 secs total) calculating margin</span></span>
<span id="cb132-24"><a href="#cb132-24" tabindex="-1"></a></span>
<span id="cb132-25"><a href="#cb132-25" tabindex="-1"></a><span class="do">## ℹ (0.002 secs elapsed; 0.047 secs total) exporting image file</span></span>
<span id="cb132-26"><a href="#cb132-26" tabindex="-1"></a></span>
<span id="cb132-27"><a href="#cb132-27" tabindex="-1"></a><span class="do">## ℹ (0.355 secs elapsed; 0.402 secs total) done</span></span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"many_sequences_20.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/many_sequences_20.png"><!-- --></p>
</div>
</div>
<div class="section level1">
<h1 id="id_6-visualising-dna-methylationmodification">6 Visualising DNA methylation/modification<a class="anchor" aria-label="anchor" href="#id_6-visualising-dna-methylationmodification"></a>
</h1>
<div class="section level2">
<h2 id="id_61-basic-visualisation">6.1 Basic visualisation<a class="anchor" aria-label="anchor" href="#id_61-basic-visualisation"></a>
</h2>
<p>When basecalling Oxford Nanopore sequencing data in Guppy or Dorado, modified basecalling can be enabled. This means the resulting BAM file contains information on DNA modifications as well as the sequence information. Most commonly, the modification assessed is 5-cytosine-methylation at CpG sites (5’-CG-3’ dinucleotides).</p>
<p>The modification information is stored in the MM and ML tags of the BAM file. It can then be written to the header row of a FASTQ file via:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="ex">samtools</span> fastq <span class="at">-T</span> MM,ML <span class="va">${input_bam_file}</span> <span class="op">&gt;</span> <span class="st">"modified_fastq_file.fastq"</span></span></code></pre></div>
<p>This is all discussed in more detail in the <a href="#id_332-modified-fastq-eg-methylation">reading from modified FASTQ</a> section.</p>
<p>As a reminder, methylation information can be read from FASTQ as follows:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modified_fastq_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_modified_fastq.html">read_modified_fastq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_raw_modified.fastq"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metadata</span>            <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_many_sequences_metadata.csv"</span>, package <span class="op">=</span> <span class="st">"ggDNAvis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Merge with offset = 1 (map C to C of palindromic CG sites when reversing)</span></span>
<span><span class="co">## See the reading from modified FASTQ section for a full discussion</span></span>
<span><span class="va">merged_modification_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata</a></span><span class="op">(</span><span class="va">modified_fastq_data</span>, <span class="va">metadata</span>,</span>
<span>                                                            reversed_location_offset <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Subset and change colnames to make it match example_many_sequences</span></span>
<span><span class="va">merged_modification_data</span> <span class="op">&lt;-</span> <span class="va">merged_modification_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"individual"</span>, <span class="st">"read"</span>, <span class="st">"forward_sequence"</span>, <span class="st">"sequence_length"</span>, <span class="st">"forward_quality"</span>, <span class="st">"forward_C+m?_locations"</span>, <span class="st">"forward_C+m?_probabilities"</span>, <span class="st">"forward_C+h?_locations"</span>, <span class="st">"forward_C+h?_probabilities"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">merged_modification_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"quality"</span>, <span class="st">"methylation_locations"</span>, <span class="st">"methylation_probabilities"</span>, <span class="st">"hydroxymethylation_locations"</span>, <span class="st">"hydroxymethylation_probabilities"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Prove equivalance to example_many_sequences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">merged_modification_data</span>, <span class="va">example_many_sequences</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Look at first 4 rows of the data as a reminder</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_modification_data</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">family</th>
<th align="left">individual</th>
<th align="left">read</th>
<th align="left">sequence</th>
<th align="left">sequence_length</th>
<th align="left">quality</th>
<th align="left">methylation_locations</th>
<th align="left">methylation_probabilities</th>
<th align="left">hydroxymethylation_locations</th>
<th align="left">hydroxymethylation_probabilities</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1a</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>102</code></td>
<td align="left"><code>)8@!9:/0/,0+-6?40,-I601:.';+5,@0.0%)!(20C*,2++*(00#/*+3;E-E)&lt;I5.5G*CB8501;I3'.8233'3&gt;&lt;:13)48F?09*&gt;?I90</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99</code></td>
<td align="left"><code>26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1b</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>63</code></td>
<td align="left"><code>60-7,7943/*=5=)7&lt;53-I=G6/&amp;/7?8)&lt;$12"&gt;/2C;4:9F8:816E,6C3*,1-2139</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60</code></td>
<td align="left"><code>10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1c</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>87</code></td>
<td align="left"><code>;F42DF52#C-*I75!4?9&gt;IA0&lt;30!-:I:;+7!:&lt;7&lt;8=G@5*91D%193/2;&gt;&lt;IA8.I&lt;.722,68*!25;69*&lt;&lt;8C9889@</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84</code></td>
<td align="left"><code>40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37</code></td>
</tr>
<tr class="even">
<td align="left"><code>Family 1</code></td>
<td align="left"><code>F1-1</code></td>
<td align="left"><code>F1-1d</code></td>
<td align="left"><code>GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA</code></td>
<td align="left"><code>81</code></td>
<td align="left"><code>:&lt;*1D)89?27#8.3)9&lt;2G&lt;&gt;I.=?58+:.=-8-3%6?7#/FG)198/+3?5/0E1=D9150A4D//650%5.@+@/8&gt;0</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82</code></td>
<td align="left"><code>3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78</code></td>
<td align="left"><code>33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55</code></td>
</tr>
</tbody>
</table>
<p>Once we have the dataframe with all forward modification columns, we can extract and sort them with <code><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation()</a></code>. This function works extremely similarly to <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code> (as explained with examples previously in the <a href="#id_52-sequence-arrangement-customisation">many sequences arrangement customisation</a> section), but instead of taking a single argument for the sequence column to extract, it takes four arguments for locations, probabilities, sequences, and sequence length colnames to extract:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract locations, probabilities, and lengths</span></span>
<span><span class="co">## Remember that example_many_sequences is identical to merged_modification_data</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">methylation_data_for_visualisation</span></span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="do">## $locations</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="do">##  [1] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99"               </span></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a><span class="do">##  [2] "3,6,9,12,15,18,27,30,33,42,45,48,57,60,63,72,75,78,87,90"                        </span></span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a><span class="do">##  [3] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84"                        </span></span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a><span class="do">##  [4] "3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78"                        </span></span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a><span class="do">##  [5] "3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60"                                    </span></span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a><span class="do">##  [6] ""                                                                                </span></span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a><span class="do">##  [7] ""                                                                                </span></span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a><span class="do">##  [8] "3,6,9,12,15,18,21,24,27,30,33,36,48,51,63,66"                                    </span></span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a><span class="do">##  [9] "3,6,9,12,15,18,21,24,27,30,42,45,57,60"                                          </span></span>
<span id="cb139-11"><a href="#cb139-11" tabindex="-1"></a><span class="do">## [10] ""                                                                                </span></span>
<span id="cb139-12"><a href="#cb139-12" tabindex="-1"></a><span class="do">## [11] ""                                                                                </span></span>
<span id="cb139-13"><a href="#cb139-13" tabindex="-1"></a><span class="do">## [12] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84"                        </span></span>
<span id="cb139-14"><a href="#cb139-14" tabindex="-1"></a><span class="do">## [13] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,78,81"                           </span></span>
<span id="cb139-15"><a href="#cb139-15" tabindex="-1"></a><span class="do">## [14] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,54,57,60,69,72,75,78"                  </span></span>
<span id="cb139-16"><a href="#cb139-16" tabindex="-1"></a><span class="do">## [15] ""                                                                                </span></span>
<span id="cb139-17"><a href="#cb139-17" tabindex="-1"></a><span class="do">## [16] ""                                                                                </span></span>
<span id="cb139-18"><a href="#cb139-18" tabindex="-1"></a><span class="do">## [17] ""                                                                                </span></span>
<span id="cb139-19"><a href="#cb139-19" tabindex="-1"></a><span class="do">## [18] ""                                                                                </span></span>
<span id="cb139-20"><a href="#cb139-20" tabindex="-1"></a><span class="do">## [19] ""                                                                                </span></span>
<span id="cb139-21"><a href="#cb139-21" tabindex="-1"></a><span class="do">## [20] ""                                                                                </span></span>
<span id="cb139-22"><a href="#cb139-22" tabindex="-1"></a><span class="do">## [21] ""                                                                                </span></span>
<span id="cb139-23"><a href="#cb139-23" tabindex="-1"></a><span class="do">## [22] ""                                                                                </span></span>
<span id="cb139-24"><a href="#cb139-24" tabindex="-1"></a><span class="do">## [23] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,87,90"</span></span>
<span id="cb139-25"><a href="#cb139-25" tabindex="-1"></a><span class="do">## [24] ""                                                                                </span></span>
<span id="cb139-26"><a href="#cb139-26" tabindex="-1"></a><span class="do">## [25] ""                                                                                </span></span>
<span id="cb139-27"><a href="#cb139-27" tabindex="-1"></a><span class="do">## [26] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,84,87"   </span></span>
<span id="cb139-28"><a href="#cb139-28" tabindex="-1"></a><span class="do">## [27] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,81,84"      </span></span>
<span id="cb139-29"><a href="#cb139-29" tabindex="-1"></a><span class="do">## [28] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,78,81"         </span></span>
<span id="cb139-30"><a href="#cb139-30" tabindex="-1"></a><span class="do">## [29] ""                                                                                </span></span>
<span id="cb139-31"><a href="#cb139-31" tabindex="-1"></a><span class="do">## [30] ""                                                                                </span></span>
<span id="cb139-32"><a href="#cb139-32" tabindex="-1"></a><span class="do">## [31] ""                                                                                </span></span>
<span id="cb139-33"><a href="#cb139-33" tabindex="-1"></a><span class="do">## [32] ""                                                                                </span></span>
<span id="cb139-34"><a href="#cb139-34" tabindex="-1"></a><span class="do">## [33] ""                                                                                </span></span>
<span id="cb139-35"><a href="#cb139-35" tabindex="-1"></a><span class="do">## [34] ""                                                                                </span></span>
<span id="cb139-36"><a href="#cb139-36" tabindex="-1"></a><span class="do">## [35] ""                                                                                </span></span>
<span id="cb139-37"><a href="#cb139-37" tabindex="-1"></a><span class="do">## [36] ""                                                                                </span></span>
<span id="cb139-38"><a href="#cb139-38" tabindex="-1"></a><span class="do">## [37] "3,6,9,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                                 </span></span>
<span id="cb139-39"><a href="#cb139-39" tabindex="-1"></a><span class="do">## [38] "3,6,9,12,15,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                           </span></span>
<span id="cb139-40"><a href="#cb139-40" tabindex="-1"></a><span class="do">## [39] ""                                                                                </span></span>
<span id="cb139-41"><a href="#cb139-41" tabindex="-1"></a><span class="do">## [40] ""                                                                                </span></span>
<span id="cb139-42"><a href="#cb139-42" tabindex="-1"></a><span class="do">## [41] "3,6,9,12,15,18,27,30,39,42,51,54,63,66,75,78,87,90"                              </span></span>
<span id="cb139-43"><a href="#cb139-43" tabindex="-1"></a><span class="do">## [42] "3,6,9,12,15,18,27,30,39,42,51,54,63,66,75,78,87"                                 </span></span>
<span id="cb139-44"><a href="#cb139-44" tabindex="-1"></a><span class="do">## [43] "3,6,9,12,15,18,21,24,27,30,39,42,51,54,63,66,75,78,81,84"                        </span></span>
<span id="cb139-45"><a href="#cb139-45" tabindex="-1"></a><span class="do">## [44] ""                                                                                </span></span>
<span id="cb139-46"><a href="#cb139-46" tabindex="-1"></a><span class="do">## [45] ""                                                                                </span></span>
<span id="cb139-47"><a href="#cb139-47" tabindex="-1"></a><span class="do">## [46] "3,6,9,12,15,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                           </span></span>
<span id="cb139-48"><a href="#cb139-48" tabindex="-1"></a><span class="do">## [47] ""                                                                                </span></span>
<span id="cb139-49"><a href="#cb139-49" tabindex="-1"></a><span class="do">## [48] ""                                                                                </span></span>
<span id="cb139-50"><a href="#cb139-50" tabindex="-1"></a><span class="do">## [49] "3,6,9,12,15,18,21,24,27,30,33,42,45,54,57,66,69,78,81,90,93"                     </span></span>
<span id="cb139-51"><a href="#cb139-51" tabindex="-1"></a><span class="do">## [50] "3,6,9,12,15,18,21,24,33,36,45,48,57,60,69,72,81,84,87"                           </span></span>
<span id="cb139-52"><a href="#cb139-52" tabindex="-1"></a><span class="do">## [51] "3,6,9,12,15,18,21,24,27,30,33,36,45,48,57,60,69,72,75,78"                        </span></span>
<span id="cb139-53"><a href="#cb139-53" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb139-54"><a href="#cb139-54" tabindex="-1"></a><span class="do">## $probabilities</span></span>
<span id="cb139-55"><a href="#cb139-55" tabindex="-1"></a><span class="do">##  [1] "29,159,155,159,220,163,2,59,170,131,177,139,72,235,75,214,73,68,48,59,81,77,41"                           </span></span>
<span id="cb139-56"><a href="#cb139-56" tabindex="-1"></a><span class="do">##  [2] "170,236,120,36,139,50,229,99,79,41,229,42,230,34,34,27,130,77,7,79"                                       </span></span>
<span id="cb139-57"><a href="#cb139-57" tabindex="-1"></a><span class="do">##  [3] "206,141,165,80,159,84,128,173,124,62,195,19,79,183,129,39,129,126,192,45"                                 </span></span>
<span id="cb139-58"><a href="#cb139-58" tabindex="-1"></a><span class="do">##  [4] "216,221,11,81,4,61,180,79,130,13,144,31,228,4,200,23,132,98,18,82"                                        </span></span>
<span id="cb139-59"><a href="#cb139-59" tabindex="-1"></a><span class="do">##  [5] "10,56,207,134,233,212,12,116,68,78,129,46,194,51,66,253"                                                  </span></span>
<span id="cb139-60"><a href="#cb139-60" tabindex="-1"></a><span class="do">##  [6] ""                                                                                                         </span></span>
<span id="cb139-61"><a href="#cb139-61" tabindex="-1"></a><span class="do">##  [7] ""                                                                                                         </span></span>
<span id="cb139-62"><a href="#cb139-62" tabindex="-1"></a><span class="do">##  [8] "31,56,233,241,71,31,203,190,234,254,240,124,72,64,128,127"                                                </span></span>
<span id="cb139-63"><a href="#cb139-63" tabindex="-1"></a><span class="do">##  [9] "189,9,144,71,52,34,83,40,33,111,10,182,26,242"                                                            </span></span>
<span id="cb139-64"><a href="#cb139-64" tabindex="-1"></a><span class="do">## [10] ""                                                                                                         </span></span>
<span id="cb139-65"><a href="#cb139-65" tabindex="-1"></a><span class="do">## [11] ""                                                                                                         </span></span>
<span id="cb139-66"><a href="#cb139-66" tabindex="-1"></a><span class="do">## [12] "81,245,162,32,108,233,119,232,152,161,222,128,251,83,123,91,160,189,144,250"                              </span></span>
<span id="cb139-67"><a href="#cb139-67" tabindex="-1"></a><span class="do">## [13] "149,181,109,88,194,108,143,30,77,122,88,153,19,244,6,215,161,79,189"                                      </span></span>
<span id="cb139-68"><a href="#cb139-68" tabindex="-1"></a><span class="do">## [14] "147,112,58,21,217,60,252,153,255,96,142,110,147,110,57,22,163,110,19,205,83,193"                          </span></span>
<span id="cb139-69"><a href="#cb139-69" tabindex="-1"></a><span class="do">## [15] ""                                                                                                         </span></span>
<span id="cb139-70"><a href="#cb139-70" tabindex="-1"></a><span class="do">## [16] ""                                                                                                         </span></span>
<span id="cb139-71"><a href="#cb139-71" tabindex="-1"></a><span class="do">## [17] ""                                                                                                         </span></span>
<span id="cb139-72"><a href="#cb139-72" tabindex="-1"></a><span class="do">## [18] ""                                                                                                         </span></span>
<span id="cb139-73"><a href="#cb139-73" tabindex="-1"></a><span class="do">## [19] ""                                                                                                         </span></span>
<span id="cb139-74"><a href="#cb139-74" tabindex="-1"></a><span class="do">## [20] ""                                                                                                         </span></span>
<span id="cb139-75"><a href="#cb139-75" tabindex="-1"></a><span class="do">## [21] ""                                                                                                         </span></span>
<span id="cb139-76"><a href="#cb139-76" tabindex="-1"></a><span class="do">## [22] ""                                                                                                         </span></span>
<span id="cb139-77"><a href="#cb139-77" tabindex="-1"></a><span class="do">## [23] "163,253,33,225,207,210,213,187,251,163,168,135,81,196,134,187,78,103,52,251,144,71,47,193,145,238,163,179"</span></span>
<span id="cb139-78"><a href="#cb139-78" tabindex="-1"></a><span class="do">## [24] ""                                                                                                         </span></span>
<span id="cb139-79"><a href="#cb139-79" tabindex="-1"></a><span class="do">## [25] ""                                                                                                         </span></span>
<span id="cb139-80"><a href="#cb139-80" tabindex="-1"></a><span class="do">## [26] "191,91,194,96,204,7,129,209,139,68,88,94,109,234,200,188,72,116,73,178,209,167,105,243,62,155,193"        </span></span>
<span id="cb139-81"><a href="#cb139-81" tabindex="-1"></a><span class="do">## [27] "176,250,122,197,146,246,203,136,152,67,71,17,144,67,1,150,133,215,8,153,68,31,26,191,4,13"                </span></span>
<span id="cb139-82"><a href="#cb139-82" tabindex="-1"></a><span class="do">## [28] "122,217,108,8,66,85,34,127,205,86,130,126,203,145,27,206,145,54,191,78,125,252,108,62,55"                 </span></span>
<span id="cb139-83"><a href="#cb139-83" tabindex="-1"></a><span class="do">## [29] ""                                                                                                         </span></span>
<span id="cb139-84"><a href="#cb139-84" tabindex="-1"></a><span class="do">## [30] ""                                                                                                         </span></span>
<span id="cb139-85"><a href="#cb139-85" tabindex="-1"></a><span class="do">## [31] ""                                                                                                         </span></span>
<span id="cb139-86"><a href="#cb139-86" tabindex="-1"></a><span class="do">## [32] ""                                                                                                         </span></span>
<span id="cb139-87"><a href="#cb139-87" tabindex="-1"></a><span class="do">## [33] ""                                                                                                         </span></span>
<span id="cb139-88"><a href="#cb139-88" tabindex="-1"></a><span class="do">## [34] ""                                                                                                         </span></span>
<span id="cb139-89"><a href="#cb139-89" tabindex="-1"></a><span class="do">## [35] ""                                                                                                         </span></span>
<span id="cb139-90"><a href="#cb139-90" tabindex="-1"></a><span class="do">## [36] ""                                                                                                         </span></span>
<span id="cb139-91"><a href="#cb139-91" tabindex="-1"></a><span class="do">## [37] "177,29,162,79,90,250,137,113,242,115,49,253,140,196,233,174,104"                                          </span></span>
<span id="cb139-92"><a href="#cb139-92" tabindex="-1"></a><span class="do">## [38] "104,37,50,49,104,89,213,51,220,101,39,87,94,109,48,168,235,187,225"                                       </span></span>
<span id="cb139-93"><a href="#cb139-93" tabindex="-1"></a><span class="do">## [39] ""                                                                                                         </span></span>
<span id="cb139-94"><a href="#cb139-94" tabindex="-1"></a><span class="do">## [40] ""                                                                                                         </span></span>
<span id="cb139-95"><a href="#cb139-95" tabindex="-1"></a><span class="do">## [41] "243,50,121,98,95,7,237,105,244,69,132,249,94,79,9,170,235,11"                                             </span></span>
<span id="cb139-96"><a href="#cb139-96" tabindex="-1"></a><span class="do">## [42] "51,190,33,181,255,241,151,186,124,196,1,142,117,84,213,249,168"                                           </span></span>
<span id="cb139-97"><a href="#cb139-97" tabindex="-1"></a><span class="do">## [43] "60,209,185,249,68,224,124,78,101,194,26,107,168,75,53,1,27,55,29,175"                                     </span></span>
<span id="cb139-98"><a href="#cb139-98" tabindex="-1"></a><span class="do">## [44] ""                                                                                                         </span></span>
<span id="cb139-99"><a href="#cb139-99" tabindex="-1"></a><span class="do">## [45] ""                                                                                                         </span></span>
<span id="cb139-100"><a href="#cb139-100" tabindex="-1"></a><span class="do">## [46] "49,251,241,176,189,187,166,43,235,144,137,5,93,175,106,193,198,146,48"                                    </span></span>
<span id="cb139-101"><a href="#cb139-101" tabindex="-1"></a><span class="do">## [47] ""                                                                                                         </span></span>
<span id="cb139-102"><a href="#cb139-102" tabindex="-1"></a><span class="do">## [48] ""                                                                                                         </span></span>
<span id="cb139-103"><a href="#cb139-103" tabindex="-1"></a><span class="do">## [49] "193,24,159,106,198,206,247,55,221,106,131,198,34,105,169,231,88,27,238,51,14"                             </span></span>
<span id="cb139-104"><a href="#cb139-104" tabindex="-1"></a><span class="do">## [50] "161,156,9,65,198,255,245,191,174,63,155,146,13,95,228,100,132,45,49"                                      </span></span>
<span id="cb139-105"><a href="#cb139-105" tabindex="-1"></a><span class="do">## [51] "109,86,70,169,200,112,237,69,168,97,239,188,150,208,225,190,128,252,142,224"                              </span></span>
<span id="cb139-106"><a href="#cb139-106" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb139-107"><a href="#cb139-107" tabindex="-1"></a><span class="do">## $sequences</span></span>
<span id="cb139-108"><a href="#cb139-108" tabindex="-1"></a><span class="do">##  [1] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"</span></span>
<span id="cb139-109"><a href="#cb139-109" tabindex="-1"></a><span class="do">##  [2] "GGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb139-110"><a href="#cb139-110" tabindex="-1"></a><span class="do">##  [3] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb139-111"><a href="#cb139-111" tabindex="-1"></a><span class="do">##  [4] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                     </span></span>
<span id="cb139-112"><a href="#cb139-112" tabindex="-1"></a><span class="do">##  [5] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb139-113"><a href="#cb139-113" tabindex="-1"></a><span class="do">##  [6] ""                                                                                                      </span></span>
<span id="cb139-114"><a href="#cb139-114" tabindex="-1"></a><span class="do">##  [7] ""                                                                                                      </span></span>
<span id="cb139-115"><a href="#cb139-115" tabindex="-1"></a><span class="do">##  [8] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                 </span></span>
<span id="cb139-116"><a href="#cb139-116" tabindex="-1"></a><span class="do">##  [9] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb139-117"><a href="#cb139-117" tabindex="-1"></a><span class="do">## [10] ""                                                                                                      </span></span>
<span id="cb139-118"><a href="#cb139-118" tabindex="-1"></a><span class="do">## [11] ""                                                                                                      </span></span>
<span id="cb139-119"><a href="#cb139-119" tabindex="-1"></a><span class="do">## [12] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb139-120"><a href="#cb139-120" tabindex="-1"></a><span class="do">## [13] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb139-121"><a href="#cb139-121" tabindex="-1"></a><span class="do">## [14] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb139-122"><a href="#cb139-122" tabindex="-1"></a><span class="do">## [15] ""                                                                                                      </span></span>
<span id="cb139-123"><a href="#cb139-123" tabindex="-1"></a><span class="do">## [16] ""                                                                                                      </span></span>
<span id="cb139-124"><a href="#cb139-124" tabindex="-1"></a><span class="do">## [17] ""                                                                                                      </span></span>
<span id="cb139-125"><a href="#cb139-125" tabindex="-1"></a><span class="do">## [18] ""                                                                                                      </span></span>
<span id="cb139-126"><a href="#cb139-126" tabindex="-1"></a><span class="do">## [19] ""                                                                                                      </span></span>
<span id="cb139-127"><a href="#cb139-127" tabindex="-1"></a><span class="do">## [20] ""                                                                                                      </span></span>
<span id="cb139-128"><a href="#cb139-128" tabindex="-1"></a><span class="do">## [21] ""                                                                                                      </span></span>
<span id="cb139-129"><a href="#cb139-129" tabindex="-1"></a><span class="do">## [22] ""                                                                                                      </span></span>
<span id="cb139-130"><a href="#cb139-130" tabindex="-1"></a><span class="do">## [23] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb139-131"><a href="#cb139-131" tabindex="-1"></a><span class="do">## [24] ""                                                                                                      </span></span>
<span id="cb139-132"><a href="#cb139-132" tabindex="-1"></a><span class="do">## [25] ""                                                                                                      </span></span>
<span id="cb139-133"><a href="#cb139-133" tabindex="-1"></a><span class="do">## [26] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"            </span></span>
<span id="cb139-134"><a href="#cb139-134" tabindex="-1"></a><span class="do">## [27] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb139-135"><a href="#cb139-135" tabindex="-1"></a><span class="do">## [28] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb139-136"><a href="#cb139-136" tabindex="-1"></a><span class="do">## [29] ""                                                                                                      </span></span>
<span id="cb139-137"><a href="#cb139-137" tabindex="-1"></a><span class="do">## [30] ""                                                                                                      </span></span>
<span id="cb139-138"><a href="#cb139-138" tabindex="-1"></a><span class="do">## [31] ""                                                                                                      </span></span>
<span id="cb139-139"><a href="#cb139-139" tabindex="-1"></a><span class="do">## [32] ""                                                                                                      </span></span>
<span id="cb139-140"><a href="#cb139-140" tabindex="-1"></a><span class="do">## [33] ""                                                                                                      </span></span>
<span id="cb139-141"><a href="#cb139-141" tabindex="-1"></a><span class="do">## [34] ""                                                                                                      </span></span>
<span id="cb139-142"><a href="#cb139-142" tabindex="-1"></a><span class="do">## [35] ""                                                                                                      </span></span>
<span id="cb139-143"><a href="#cb139-143" tabindex="-1"></a><span class="do">## [36] ""                                                                                                      </span></span>
<span id="cb139-144"><a href="#cb139-144" tabindex="-1"></a><span class="do">## [37] "GGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb139-145"><a href="#cb139-145" tabindex="-1"></a><span class="do">## [38] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb139-146"><a href="#cb139-146" tabindex="-1"></a><span class="do">## [39] ""                                                                                                      </span></span>
<span id="cb139-147"><a href="#cb139-147" tabindex="-1"></a><span class="do">## [40] ""                                                                                                      </span></span>
<span id="cb139-148"><a href="#cb139-148" tabindex="-1"></a><span class="do">## [41] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"         </span></span>
<span id="cb139-149"><a href="#cb139-149" tabindex="-1"></a><span class="do">## [42] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGA"            </span></span>
<span id="cb139-150"><a href="#cb139-150" tabindex="-1"></a><span class="do">## [43] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGCGGA"               </span></span>
<span id="cb139-151"><a href="#cb139-151" tabindex="-1"></a><span class="do">## [44] ""                                                                                                      </span></span>
<span id="cb139-152"><a href="#cb139-152" tabindex="-1"></a><span class="do">## [45] ""                                                                                                      </span></span>
<span id="cb139-153"><a href="#cb139-153" tabindex="-1"></a><span class="do">## [46] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb139-154"><a href="#cb139-154" tabindex="-1"></a><span class="do">## [47] ""                                                                                                      </span></span>
<span id="cb139-155"><a href="#cb139-155" tabindex="-1"></a><span class="do">## [48] ""                                                                                                      </span></span>
<span id="cb139-156"><a href="#cb139-156" tabindex="-1"></a><span class="do">## [49] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb139-157"><a href="#cb139-157" tabindex="-1"></a><span class="do">## [50] "GGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGA"            </span></span>
<span id="cb139-158"><a href="#cb139-158" tabindex="-1"></a><span class="do">## [51] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb139-159"><a href="#cb139-159" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb139-160"><a href="#cb139-160" tabindex="-1"></a><span class="do">## $lengths</span></span>
<span id="cb139-161"><a href="#cb139-161" tabindex="-1"></a><span class="do">##  [1] 102  93  87  81  63   0   0  69  63   0   0  87  84  81   0   0   0   0   0</span></span>
<span id="cb139-162"><a href="#cb139-162" tabindex="-1"></a><span class="do">## [20]   0   0   0  93   0   0  90  87  84   0   0   0   0   0   0   0   0  96  96</span></span>
<span id="cb139-163"><a href="#cb139-163" tabindex="-1"></a><span class="do">## [39]   0   0  93  90  87   0   0  96   0   0  96  90  81</span></span></code></pre></div>
<p>This returns a 4-item list, where each item in the list is a vector of either modification locations, probabilities, sequences, or sequence lengths. The modification locations are the indices (starting from 1) along each read at which modification was assessed, while the probabilities are 8-bit integers giving the probability of modification from 0 to 255. This is explained in more detail in the <a href="#id_31-introduction-to-example_many_sequences">introduction to <code>example_many_sequences</code></a> section.</p>
<p>To use hydroxymethylation instead of methylation, we can simply change the colnames we read from:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract locations, probabilities, and lengths</span></span>
<span><span class="va">hydroxymethylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"hydroxymethylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"hydroxymethylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hydroxymethylation_data_for_visualisation</span></span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="do">## $locations</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a><span class="do">##  [1] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84,87,96,99"               </span></span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="do">##  [2] "3,6,9,12,15,18,27,30,33,42,45,48,57,60,63,72,75,78,87,90"                        </span></span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a><span class="do">##  [3] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84"                        </span></span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a><span class="do">##  [4] "3,6,9,12,15,18,21,24,27,30,33,36,45,48,51,60,63,66,75,78"                        </span></span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a><span class="do">##  [5] "3,6,9,12,15,18,21,24,27,30,33,42,45,48,57,60"                                    </span></span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a><span class="do">##  [6] ""                                                                                </span></span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a><span class="do">##  [7] ""                                                                                </span></span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a><span class="do">##  [8] "3,6,9,12,15,18,21,24,27,30,33,36,48,51,63,66"                                    </span></span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a><span class="do">##  [9] "3,6,9,12,15,18,21,24,27,30,42,45,57,60"                                          </span></span>
<span id="cb141-11"><a href="#cb141-11" tabindex="-1"></a><span class="do">## [10] ""                                                                                </span></span>
<span id="cb141-12"><a href="#cb141-12" tabindex="-1"></a><span class="do">## [11] ""                                                                                </span></span>
<span id="cb141-13"><a href="#cb141-13" tabindex="-1"></a><span class="do">## [12] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,72,81,84"                        </span></span>
<span id="cb141-14"><a href="#cb141-14" tabindex="-1"></a><span class="do">## [13] "3,6,9,12,15,18,21,24,27,36,39,42,51,54,57,66,69,78,81"                           </span></span>
<span id="cb141-15"><a href="#cb141-15" tabindex="-1"></a><span class="do">## [14] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,54,57,60,69,72,75,78"                  </span></span>
<span id="cb141-16"><a href="#cb141-16" tabindex="-1"></a><span class="do">## [15] ""                                                                                </span></span>
<span id="cb141-17"><a href="#cb141-17" tabindex="-1"></a><span class="do">## [16] ""                                                                                </span></span>
<span id="cb141-18"><a href="#cb141-18" tabindex="-1"></a><span class="do">## [17] ""                                                                                </span></span>
<span id="cb141-19"><a href="#cb141-19" tabindex="-1"></a><span class="do">## [18] ""                                                                                </span></span>
<span id="cb141-20"><a href="#cb141-20" tabindex="-1"></a><span class="do">## [19] ""                                                                                </span></span>
<span id="cb141-21"><a href="#cb141-21" tabindex="-1"></a><span class="do">## [20] ""                                                                                </span></span>
<span id="cb141-22"><a href="#cb141-22" tabindex="-1"></a><span class="do">## [21] ""                                                                                </span></span>
<span id="cb141-23"><a href="#cb141-23" tabindex="-1"></a><span class="do">## [22] ""                                                                                </span></span>
<span id="cb141-24"><a href="#cb141-24" tabindex="-1"></a><span class="do">## [23] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,87,90"</span></span>
<span id="cb141-25"><a href="#cb141-25" tabindex="-1"></a><span class="do">## [24] ""                                                                                </span></span>
<span id="cb141-26"><a href="#cb141-26" tabindex="-1"></a><span class="do">## [25] ""                                                                                </span></span>
<span id="cb141-27"><a href="#cb141-27" tabindex="-1"></a><span class="do">## [26] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,84,87"   </span></span>
<span id="cb141-28"><a href="#cb141-28" tabindex="-1"></a><span class="do">## [27] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,81,84"      </span></span>
<span id="cb141-29"><a href="#cb141-29" tabindex="-1"></a><span class="do">## [28] "3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,78,81"         </span></span>
<span id="cb141-30"><a href="#cb141-30" tabindex="-1"></a><span class="do">## [29] ""                                                                                </span></span>
<span id="cb141-31"><a href="#cb141-31" tabindex="-1"></a><span class="do">## [30] ""                                                                                </span></span>
<span id="cb141-32"><a href="#cb141-32" tabindex="-1"></a><span class="do">## [31] ""                                                                                </span></span>
<span id="cb141-33"><a href="#cb141-33" tabindex="-1"></a><span class="do">## [32] ""                                                                                </span></span>
<span id="cb141-34"><a href="#cb141-34" tabindex="-1"></a><span class="do">## [33] ""                                                                                </span></span>
<span id="cb141-35"><a href="#cb141-35" tabindex="-1"></a><span class="do">## [34] ""                                                                                </span></span>
<span id="cb141-36"><a href="#cb141-36" tabindex="-1"></a><span class="do">## [35] ""                                                                                </span></span>
<span id="cb141-37"><a href="#cb141-37" tabindex="-1"></a><span class="do">## [36] ""                                                                                </span></span>
<span id="cb141-38"><a href="#cb141-38" tabindex="-1"></a><span class="do">## [37] "3,6,9,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                                 </span></span>
<span id="cb141-39"><a href="#cb141-39" tabindex="-1"></a><span class="do">## [38] "3,6,9,12,15,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                           </span></span>
<span id="cb141-40"><a href="#cb141-40" tabindex="-1"></a><span class="do">## [39] ""                                                                                </span></span>
<span id="cb141-41"><a href="#cb141-41" tabindex="-1"></a><span class="do">## [40] ""                                                                                </span></span>
<span id="cb141-42"><a href="#cb141-42" tabindex="-1"></a><span class="do">## [41] "3,6,9,12,15,18,27,30,39,42,51,54,63,66,75,78,87,90"                              </span></span>
<span id="cb141-43"><a href="#cb141-43" tabindex="-1"></a><span class="do">## [42] "3,6,9,12,15,18,27,30,39,42,51,54,63,66,75,78,87"                                 </span></span>
<span id="cb141-44"><a href="#cb141-44" tabindex="-1"></a><span class="do">## [43] "3,6,9,12,15,18,21,24,27,30,39,42,51,54,63,66,75,78,81,84"                        </span></span>
<span id="cb141-45"><a href="#cb141-45" tabindex="-1"></a><span class="do">## [44] ""                                                                                </span></span>
<span id="cb141-46"><a href="#cb141-46" tabindex="-1"></a><span class="do">## [45] ""                                                                                </span></span>
<span id="cb141-47"><a href="#cb141-47" tabindex="-1"></a><span class="do">## [46] "3,6,9,12,15,18,21,30,33,42,45,54,57,66,69,78,81,90,93"                           </span></span>
<span id="cb141-48"><a href="#cb141-48" tabindex="-1"></a><span class="do">## [47] ""                                                                                </span></span>
<span id="cb141-49"><a href="#cb141-49" tabindex="-1"></a><span class="do">## [48] ""                                                                                </span></span>
<span id="cb141-50"><a href="#cb141-50" tabindex="-1"></a><span class="do">## [49] "3,6,9,12,15,18,21,24,27,30,33,42,45,54,57,66,69,78,81,90,93"                     </span></span>
<span id="cb141-51"><a href="#cb141-51" tabindex="-1"></a><span class="do">## [50] "3,6,9,12,15,18,21,24,33,36,45,48,57,60,69,72,81,84,87"                           </span></span>
<span id="cb141-52"><a href="#cb141-52" tabindex="-1"></a><span class="do">## [51] "3,6,9,12,15,18,21,24,27,30,33,36,45,48,57,60,69,72,75,78"                        </span></span>
<span id="cb141-53"><a href="#cb141-53" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb141-54"><a href="#cb141-54" tabindex="-1"></a><span class="do">## $probabilities</span></span>
<span id="cb141-55"><a href="#cb141-55" tabindex="-1"></a><span class="do">##  [1] "26,60,61,60,30,59,2,46,57,64,54,63,52,18,53,34,52,50,39,46,55,54,34"                </span></span>
<span id="cb141-56"><a href="#cb141-56" tabindex="-1"></a><span class="do">##  [2] "57,18,64,31,63,40,23,61,55,34,23,35,23,30,29,24,64,53,7,54"                         </span></span>
<span id="cb141-57"><a href="#cb141-57" tabindex="-1"></a><span class="do">##  [3] "40,63,58,55,60,56,64,56,64,47,46,17,55,52,64,33,63,64,47,37"                        </span></span>
<span id="cb141-58"><a href="#cb141-58" tabindex="-1"></a><span class="do">##  [4] "33,29,10,55,3,46,53,54,64,12,63,27,24,4,43,21,64,60,17,55"                          </span></span>
<span id="cb141-59"><a href="#cb141-59" tabindex="-1"></a><span class="do">##  [5] "10,44,39,64,20,36,11,63,50,54,64,38,46,41,49,2"                                     </span></span>
<span id="cb141-60"><a href="#cb141-60" tabindex="-1"></a><span class="do">##  [6] ""                                                                                   </span></span>
<span id="cb141-61"><a href="#cb141-61" tabindex="-1"></a><span class="do">##  [7] ""                                                                                   </span></span>
<span id="cb141-62"><a href="#cb141-62" tabindex="-1"></a><span class="do">##  [8] "27,44,20,13,51,28,41,48,19,1,14,64,52,48,64,64"                                     </span></span>
<span id="cb141-63"><a href="#cb141-63" tabindex="-1"></a><span class="do">##  [9] "49,9,63,52,41,30,56,33,29,63,9,52,23,12"                                            </span></span>
<span id="cb141-64"><a href="#cb141-64" tabindex="-1"></a><span class="do">## [10] ""                                                                                   </span></span>
<span id="cb141-65"><a href="#cb141-65" tabindex="-1"></a><span class="do">## [11] ""                                                                                   </span></span>
<span id="cb141-66"><a href="#cb141-66" tabindex="-1"></a><span class="do">## [12] "55,10,59,28,62,20,64,21,62,59,29,64,4,56,64,59,60,49,63,5"                          </span></span>
<span id="cb141-67"><a href="#cb141-67" tabindex="-1"></a><span class="do">## [13] "80,43,103,71,21,112,47,126,21,40,80,35,142,1,238,1,79,111,20"                       </span></span>
<span id="cb141-68"><a href="#cb141-68" tabindex="-1"></a><span class="do">## [14] "62,63,45,19,32,46,3,61,0,159,42,80,46,84,86,52,8,92,102,4,138,20"                   </span></span>
<span id="cb141-69"><a href="#cb141-69" tabindex="-1"></a><span class="do">## [15] ""                                                                                   </span></span>
<span id="cb141-70"><a href="#cb141-70" tabindex="-1"></a><span class="do">## [16] ""                                                                                   </span></span>
<span id="cb141-71"><a href="#cb141-71" tabindex="-1"></a><span class="do">## [17] ""                                                                                   </span></span>
<span id="cb141-72"><a href="#cb141-72" tabindex="-1"></a><span class="do">## [18] ""                                                                                   </span></span>
<span id="cb141-73"><a href="#cb141-73" tabindex="-1"></a><span class="do">## [19] ""                                                                                   </span></span>
<span id="cb141-74"><a href="#cb141-74" tabindex="-1"></a><span class="do">## [20] ""                                                                                   </span></span>
<span id="cb141-75"><a href="#cb141-75" tabindex="-1"></a><span class="do">## [21] ""                                                                                   </span></span>
<span id="cb141-76"><a href="#cb141-76" tabindex="-1"></a><span class="do">## [22] ""                                                                                   </span></span>
<span id="cb141-77"><a href="#cb141-77" tabindex="-1"></a><span class="do">## [23] "68,1,220,4,42,36,35,57,3,90,56,79,92,19,93,36,130,47,82,1,109,104,58,11,83,10,86,49"</span></span>
<span id="cb141-78"><a href="#cb141-78" tabindex="-1"></a><span class="do">## [24] ""                                                                                   </span></span>
<span id="cb141-79"><a href="#cb141-79" tabindex="-1"></a><span class="do">## [25] ""                                                                                   </span></span>
<span id="cb141-80"><a href="#cb141-80" tabindex="-1"></a><span class="do">## [26] "3,123,22,121,19,198,3,23,95,102,45,55,54,9,51,53,135,39,83,22,32,72,98,5,184,24,38" </span></span>
<span id="cb141-81"><a href="#cb141-81" tabindex="-1"></a><span class="do">## [27] "17,3,130,28,84,5,50,95,55,112,49,67,7,106,67,0,72,21,209,3,112,60,28,6,188,4"       </span></span>
<span id="cb141-82"><a href="#cb141-82" tabindex="-1"></a><span class="do">## [28] "93,18,125,104,6,44,74,17,25,136,42,66,26,88,129,5,89,114,14,133,40,1,145,82,49"     </span></span>
<span id="cb141-83"><a href="#cb141-83" tabindex="-1"></a><span class="do">## [29] ""                                                                                   </span></span>
<span id="cb141-84"><a href="#cb141-84" tabindex="-1"></a><span class="do">## [30] ""                                                                                   </span></span>
<span id="cb141-85"><a href="#cb141-85" tabindex="-1"></a><span class="do">## [31] ""                                                                                   </span></span>
<span id="cb141-86"><a href="#cb141-86" tabindex="-1"></a><span class="do">## [32] ""                                                                                   </span></span>
<span id="cb141-87"><a href="#cb141-87" tabindex="-1"></a><span class="do">## [33] ""                                                                                   </span></span>
<span id="cb141-88"><a href="#cb141-88" tabindex="-1"></a><span class="do">## [34] ""                                                                                   </span></span>
<span id="cb141-89"><a href="#cb141-89" tabindex="-1"></a><span class="do">## [35] ""                                                                                   </span></span>
<span id="cb141-90"><a href="#cb141-90" tabindex="-1"></a><span class="do">## [36] ""                                                                                   </span></span>
<span id="cb141-91"><a href="#cb141-91" tabindex="-1"></a><span class="do">## [37] "59,157,11,112,51,2,116,77,6,133,93,0,114,32,17,74,103"                              </span></span>
<span id="cb141-92"><a href="#cb141-92" tabindex="-1"></a><span class="do">## [38] "61,89,30,41,29,68,15,170,7,133,86,26,55,54,88,16,13,63,22"                          </span></span>
<span id="cb141-93"><a href="#cb141-93" tabindex="-1"></a><span class="do">## [39] ""                                                                                   </span></span>
<span id="cb141-94"><a href="#cb141-94" tabindex="-1"></a><span class="do">## [40] ""                                                                                   </span></span>
<span id="cb141-95"><a href="#cb141-95" tabindex="-1"></a><span class="do">## [41] "11,195,26,74,62,93,1,139,5,178,33,3,158,65,76,3,13,225"                             </span></span>
<span id="cb141-96"><a href="#cb141-96" tabindex="-1"></a><span class="do">## [42] "9,13,165,10,0,10,104,65,78,43,124,87,0,95,19,2,73"                                  </span></span>
<span id="cb141-97"><a href="#cb141-97" tabindex="-1"></a><span class="do">## [43] "191,30,16,5,136,30,35,156,75,19,90,112,9,76,133,75,47,0,24,17"                      </span></span>
<span id="cb141-98"><a href="#cb141-98" tabindex="-1"></a><span class="do">## [44] ""                                                                                   </span></span>
<span id="cb141-99"><a href="#cb141-99" tabindex="-1"></a><span class="do">## [45] ""                                                                                   </span></span>
<span id="cb141-100"><a href="#cb141-100" tabindex="-1"></a><span class="do">## [46] "24,3,3,78,63,47,66,155,13,19,109,141,87,2,55,43,24,83,161"                          </span></span>
<span id="cb141-101"><a href="#cb141-101" tabindex="-1"></a><span class="do">## [47] ""                                                                                   </span></span>
<span id="cb141-102"><a href="#cb141-102" tabindex="-1"></a><span class="do">## [48] ""                                                                                   </span></span>
<span id="cb141-103"><a href="#cb141-103" tabindex="-1"></a><span class="do">## [49] "36,44,73,14,35,20,6,162,33,32,108,24,113,116,11,10,111,207,6,21,225"                </span></span>
<span id="cb141-104"><a href="#cb141-104" tabindex="-1"></a><span class="do">## [50] "52,87,155,117,2,0,3,50,81,184,75,74,60,97,15,8,46,188,81"                           </span></span>
<span id="cb141-105"><a href="#cb141-105" tabindex="-1"></a><span class="do">## [51] "29,9,79,29,15,95,14,82,81,43,11,25,98,35,18,53,112,2,57,31"                         </span></span>
<span id="cb141-106"><a href="#cb141-106" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb141-107"><a href="#cb141-107" tabindex="-1"></a><span class="do">## $sequences</span></span>
<span id="cb141-108"><a href="#cb141-108" tabindex="-1"></a><span class="do">##  [1] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"</span></span>
<span id="cb141-109"><a href="#cb141-109" tabindex="-1"></a><span class="do">##  [2] "GGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb141-110"><a href="#cb141-110" tabindex="-1"></a><span class="do">##  [3] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb141-111"><a href="#cb141-111" tabindex="-1"></a><span class="do">##  [4] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                     </span></span>
<span id="cb141-112"><a href="#cb141-112" tabindex="-1"></a><span class="do">##  [5] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb141-113"><a href="#cb141-113" tabindex="-1"></a><span class="do">##  [6] ""                                                                                                      </span></span>
<span id="cb141-114"><a href="#cb141-114" tabindex="-1"></a><span class="do">##  [7] ""                                                                                                      </span></span>
<span id="cb141-115"><a href="#cb141-115" tabindex="-1"></a><span class="do">##  [8] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                 </span></span>
<span id="cb141-116"><a href="#cb141-116" tabindex="-1"></a><span class="do">##  [9] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGAGGCGGCGGAGGAGGAGGCGGCGGA"                                       </span></span>
<span id="cb141-117"><a href="#cb141-117" tabindex="-1"></a><span class="do">## [10] ""                                                                                                      </span></span>
<span id="cb141-118"><a href="#cb141-118" tabindex="-1"></a><span class="do">## [11] ""                                                                                                      </span></span>
<span id="cb141-119"><a href="#cb141-119" tabindex="-1"></a><span class="do">## [12] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb141-120"><a href="#cb141-120" tabindex="-1"></a><span class="do">## [13] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb141-121"><a href="#cb141-121" tabindex="-1"></a><span class="do">## [14] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGCGGAGGAGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb141-122"><a href="#cb141-122" tabindex="-1"></a><span class="do">## [15] ""                                                                                                      </span></span>
<span id="cb141-123"><a href="#cb141-123" tabindex="-1"></a><span class="do">## [16] ""                                                                                                      </span></span>
<span id="cb141-124"><a href="#cb141-124" tabindex="-1"></a><span class="do">## [17] ""                                                                                                      </span></span>
<span id="cb141-125"><a href="#cb141-125" tabindex="-1"></a><span class="do">## [18] ""                                                                                                      </span></span>
<span id="cb141-126"><a href="#cb141-126" tabindex="-1"></a><span class="do">## [19] ""                                                                                                      </span></span>
<span id="cb141-127"><a href="#cb141-127" tabindex="-1"></a><span class="do">## [20] ""                                                                                                      </span></span>
<span id="cb141-128"><a href="#cb141-128" tabindex="-1"></a><span class="do">## [21] ""                                                                                                      </span></span>
<span id="cb141-129"><a href="#cb141-129" tabindex="-1"></a><span class="do">## [22] ""                                                                                                      </span></span>
<span id="cb141-130"><a href="#cb141-130" tabindex="-1"></a><span class="do">## [23] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"         </span></span>
<span id="cb141-131"><a href="#cb141-131" tabindex="-1"></a><span class="do">## [24] ""                                                                                                      </span></span>
<span id="cb141-132"><a href="#cb141-132" tabindex="-1"></a><span class="do">## [25] ""                                                                                                      </span></span>
<span id="cb141-133"><a href="#cb141-133" tabindex="-1"></a><span class="do">## [26] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"            </span></span>
<span id="cb141-134"><a href="#cb141-134" tabindex="-1"></a><span class="do">## [27] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"               </span></span>
<span id="cb141-135"><a href="#cb141-135" tabindex="-1"></a><span class="do">## [28] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGA"                  </span></span>
<span id="cb141-136"><a href="#cb141-136" tabindex="-1"></a><span class="do">## [29] ""                                                                                                      </span></span>
<span id="cb141-137"><a href="#cb141-137" tabindex="-1"></a><span class="do">## [30] ""                                                                                                      </span></span>
<span id="cb141-138"><a href="#cb141-138" tabindex="-1"></a><span class="do">## [31] ""                                                                                                      </span></span>
<span id="cb141-139"><a href="#cb141-139" tabindex="-1"></a><span class="do">## [32] ""                                                                                                      </span></span>
<span id="cb141-140"><a href="#cb141-140" tabindex="-1"></a><span class="do">## [33] ""                                                                                                      </span></span>
<span id="cb141-141"><a href="#cb141-141" tabindex="-1"></a><span class="do">## [34] ""                                                                                                      </span></span>
<span id="cb141-142"><a href="#cb141-142" tabindex="-1"></a><span class="do">## [35] ""                                                                                                      </span></span>
<span id="cb141-143"><a href="#cb141-143" tabindex="-1"></a><span class="do">## [36] ""                                                                                                      </span></span>
<span id="cb141-144"><a href="#cb141-144" tabindex="-1"></a><span class="do">## [37] "GGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb141-145"><a href="#cb141-145" tabindex="-1"></a><span class="do">## [38] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb141-146"><a href="#cb141-146" tabindex="-1"></a><span class="do">## [39] ""                                                                                                      </span></span>
<span id="cb141-147"><a href="#cb141-147" tabindex="-1"></a><span class="do">## [40] ""                                                                                                      </span></span>
<span id="cb141-148"><a href="#cb141-148" tabindex="-1"></a><span class="do">## [41] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"         </span></span>
<span id="cb141-149"><a href="#cb141-149" tabindex="-1"></a><span class="do">## [42] "GGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGA"            </span></span>
<span id="cb141-150"><a href="#cb141-150" tabindex="-1"></a><span class="do">## [43] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGCGGA"               </span></span>
<span id="cb141-151"><a href="#cb141-151" tabindex="-1"></a><span class="do">## [44] ""                                                                                                      </span></span>
<span id="cb141-152"><a href="#cb141-152" tabindex="-1"></a><span class="do">## [45] ""                                                                                                      </span></span>
<span id="cb141-153"><a href="#cb141-153" tabindex="-1"></a><span class="do">## [46] "GGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb141-154"><a href="#cb141-154" tabindex="-1"></a><span class="do">## [47] ""                                                                                                      </span></span>
<span id="cb141-155"><a href="#cb141-155" tabindex="-1"></a><span class="do">## [48] ""                                                                                                      </span></span>
<span id="cb141-156"><a href="#cb141-156" tabindex="-1"></a><span class="do">## [49] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGA"      </span></span>
<span id="cb141-157"><a href="#cb141-157" tabindex="-1"></a><span class="do">## [50] "GGCGGCGGCGGCGGCGGCGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGAGGAGGCGGCGGCGGA"            </span></span>
<span id="cb141-158"><a href="#cb141-158" tabindex="-1"></a><span class="do">## [51] "GGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGTGGTGGCGGCGGCGGCGGA"                     </span></span>
<span id="cb141-159"><a href="#cb141-159" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb141-160"><a href="#cb141-160" tabindex="-1"></a><span class="do">## $lengths</span></span>
<span id="cb141-161"><a href="#cb141-161" tabindex="-1"></a><span class="do">##  [1] 102  93  87  81  63   0   0  69  63   0   0  87  84  81   0   0   0   0   0</span></span>
<span id="cb141-162"><a href="#cb141-162" tabindex="-1"></a><span class="do">## [20]   0   0   0  93   0   0  90  87  84   0   0   0   0   0   0   0   0  96  96</span></span>
<span id="cb141-163"><a href="#cb141-163" tabindex="-1"></a><span class="do">## [39]   0   0  93  90  87   0   0  96   0   0  96  90  81</span></span></code></pre></div>
<p>The hydroxymethylation locations are the same as the methylation locations (as they have both been assessed at all CpG sites), but the probabilities are different. This should work for any modification type in the MM and ML tags, though it has only been tested for <code>C+m?</code> CG methylation and <code>C+h?</code> CG hydroxymethylation.</p>
<p>This list of locations, probabilities, and sequences can then be used as input for <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code>. (Note: pre-v1.0.0 versions of <code>ggDNAvis</code> used sequence lengths instead of sequences as the third argument, but this has been changed as inputting sequences allows calculation of sequence lengths, while also enabling sequence visualisation).</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_01.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_01.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_01.png"><!-- --></p>
<p>Here all the modification-assessed bases (Cs of CG dinucleotides) are coloured blue for low methylation probability and red for high methylation probability and linearly interpolated for intermediate probabilities. Non-modification-assessed bases are coloured grey, and the background is white.</p>
<p><code>ggDNAvis</code> also contains a function for making a scalebar for the methylation probabilities: <code><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale()</a></code>. Unlike the main <code>visualise_</code> functions, this one will work at any scale and aspect resolution, so it always returns a ggplot object that can be exported manually via <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_location <span class="op">=</span> <span class="st">"bottom"</span>, </span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_01_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_01_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_01_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>(Note that sometimes vertical white lines can appear in the scalebar, depending on the exact gradient precision, export dimensions, and dpi. If this happens, changing the <code>precision</code> argument very slightly usually fixes it.)</p>
</div>
<div class="section level2">
<h2 id="id_62-sequence-arrangement-customisation">6.2 Sequence arrangement customisation<a class="anchor" aria-label="anchor" href="#id_62-sequence-arrangement-customisation"></a>
</h2>
<p><code><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation()</a></code> is customisable in all the same ways as <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code>, as discussed in detail in the <a href="#id_52-sequence-arrangement-customisation">many sequences arrangement customisation</a> section. This section will provide a brief reminder, but follow that link for a full explanation.</p>
<p><code><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation()</a></code> arguments:</p>
<ul>
<li>
<code>modification_data</code>: The data to be processed</li>
<li>
<code>locations_colname</code>: The column locations should be extracted from.</li>
<li>
<code>probabilities_colname</code>: The column probabilities should be extracted from.</li>
<li>
<code>sequences_colname</code>: The column sequences should be extracted from.</li>
<li>
<code>lengths_colname</code>: The column sequence lengths should be extracted from. All four of these just call <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code> to extract these columns, so they can technically be used to extract any three columns regardless of what they contain. However, if you are trying to extract and sort a non-DNA-information column, it would probably be more sensible to do that directly via <code><a href="reference/extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code>.</li>
<li>
<code>grouping_levels</code>: How the data should be grouped. This is a named numerical vector stating which variables/columns should be used to group the data, and how many lines should be left between groups at each level. For example, the default <code>c("family" = 8, "individual" = 2)</code> means the top-level grouping is done by categories in the <code>"family"</code> column and there are 8 blank lines between each family, and the second-level gropuing is done by the <code>"individual"</code> column and there are 2 blank lines between individuals within the same family. This is implemented recursively, so any number of grouping variables can be used (or this can be set to <code>NA</code> to turn off grouping entirely).</li>
<li>
<code>sort_by</code>: The name of the column used to sort sequences within the lowest-level groups. This is generally the sequence length (but doesn’t have to be).</li>
<li>
<code>desc_sort</code>: Whether the sequences should be sorted by the <code>sort_by</code> variable descending (<code>desc_sort = TRUE</code>) or (<code>desc_sort = FALSE</code>).</li>
</ul>
<p>A single example of how the arrangement might be customised:</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"individual"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_02.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_02.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_02.png"><!-- --></p>
<p>Here there is no grouping by family, 3 blank lines between each participant, and sequences are sorted in ascending length order within each participant.</p>
</div>
<div class="section level2">
<h2 id="id_63-index-annotation-customisation">6.3 Index annotation customisation<a class="anchor" aria-label="anchor" href="#id_63-index-annotation-customisation"></a>
</h2>
<p>Index annotations for <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> work identically to <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>, as explained in <a href="#id_53-index-annotation-customisation">index annotation customisation for <code>visualise_many_sequences()</code></a>.</p>
<p>Briefly:</p>
<ul>
<li>
<code>index_annotation_lines</code> controls which lines receive annotations</li>
<li>
<code>index_annotation_interval</code> controls how frequently along each line index annotations are drawn</li>
<li>
<code>index_annotation_full_line</code> controls whether annotations go to the end of the image or the end of each sequence</li>
<li>
<code>index_annotations_above</code> controls whether annotations (and the blank lines they are drawn in) go above or below each annotated line</li>
<li>
<code>index_annotation_vertical_position</code> controls how far above each annotated line numbers are drawn</li>
<li>
<code>index_annotation_colour</code> controls the colour of the numbers</li>
<li>
<code>index_annotation_size</code> controls the size of the numbers</li>
<li>
<code>index_annotation_always_first_base</code> and <code>index_annotation_always_last_base</code> control whether the first and last bases are always annotated even if they fall outside the annotation interval.</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors using all default settings</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_03.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">28</span>, <span class="fl">51</span><span class="op">)</span>,</span>
<span>    index_annotations_above <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>    index_annotation_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    index_annotation_vertical_position <span class="op">=</span> <span class="fl">0.45</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_03.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_03.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_64-sequence-text-customisation">6.4 Sequence text customisation<a class="anchor" aria-label="anchor" href="#id_64-sequence-text-customisation"></a>
</h2>
<p><code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> is unique in that it has several different options for the text that can be drawn inside the boxes. Like <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> and <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>, the letter for each base can be drawn inside each corresponding box. However, there is also an option for drawing the probability of modification inside each assessed base. Probabilities can be scaled to any desired range - however, the most common options would be leaving them as 8-bit integers from 0-255 or transforming to probabilities between 0 and 1.</p>
<p>In all cases, the appearance of the text can be controlled via <code>sequence_text_colour</code> and <code>sequence_text_size</code>.</p>
<p>The arguments that control the sequence text are:</p>
<ul>
<li>
<code>sequence_text_type</code>: Either <code>"none"</code> (default) to draw the boxes only with no text, <code>"sequence"</code> to draw the base sequence inside the boxes similarly to <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>, or <code>"probability"</code> to draw the probability of modification inside each assessed base. Note: if set to <code>"none"</code>, all other <code>sequence_text_</code> arguments do nothing. If set to <code>"sequence"</code>, then <code>sequence_text_scaling</code> and <code>sequence_text_rounding</code> do nothing.</li>
<li>
<code>sequence_text_scaling</code>: The transformation to be applied to the probabilities, as a length-2 numeric vector of <code>c(min, max)</code>. Probabilities will be scaled via <span class="math inline">\frac{p-min}{max}</span> before drawing. Setting this to <code>c(0, 1)</code> means no scaling is applied (subtract zero then divide by one) so the original probabilities are drawn i.e. the 8-bit integers. Setting to <code>c(-0.5, 256)</code> (default) applies <span class="math inline">\frac{p+0.5}{256}</span> to find the centre of the probability space from <span class="math inline">\frac{p}{256}</span> to <span class="math inline">\frac{p+1}{256}</span> represented by each integer <span class="math inline">p</span>, in order to convert each integer to the corresponding probability. Setting to <code>c(0, 255)</code> is therefore <strong>not an accurate transformation</strong> to 0-1 probability space and should not be used.</li>
<li>
<code>sequence_text_rounding</code>: The number of decimal places that should be drawn. Defaults to <code>2</code>. If setting <code>sequence_text_scaling = c(0, 1)</code> to draw original integers, this should probably be set to <code>0</code> otherwise it will result in e.g. <code>"128.00"</code>.</li>
<li>
<code>sequence_text_colour</code>: The colour of the sequence/probability text.</li>
<li>
<code>sequence_text_size</code>: The size of the sequence/probability text.</li>
</ul>
<p>An example drawing the sequences is:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors using all default settings</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_04.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"sequence"</span></span>
<span><span class="op">)</span></span>
<span>                      </span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_04.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_04.png"><!-- --></p>
<p>The default text size is 16, which is appropriate for sequence (1 character per box) but is generally too large for probabilities (often 3-4 characters per box):</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Default sequence_text_scaling is c(-0.5, 256) to scale integers to 0-1.</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_05.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="do">## Warning: The default sequence_text_size of 16 is likely to be too large for displaying probabilities.</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="do">## Consider setting sequence_text_size to a smaller value e.g. 10.</span></span></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_05.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_05.png"><!-- --></p>
<p>A more sensible version with integers scaled to 0-1 (which is the default, but we will write the arguments explicitly for clarity) would be:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_06.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span>
<span>    sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">256</span><span class="op">)</span>,</span>
<span>    sequence_text_rounding <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span>                      </span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_06.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_06.png"><!-- --></p>
<p>If we instead wanted to see the integer scores from the original data we would turn off scaling and rounding:</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_07.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span>
<span>    sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sequence_text_rounding <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span>
<span>                      </span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_07.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_07.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_65-colour-and-layout-customisation">6.5 Colour and layout customisation<a class="anchor" aria-label="anchor" href="#id_65-colour-and-layout-customisation"></a>
</h2>
<p>Colours in <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> are controlled by setting the low and high end points of the modification colour mapping scale, as well as the colour to use for non-modification-assessed bases and the background. As before, margin and resolution are customisable.</p>
<p>One important feature to note is that the box outlines can be controlled separately for modification-assessed (e.g. C of CpG) and non-modification assessed bases. The same global <code>outline_colour</code>, <code>outline_linewidth</code>, and <code>outline_join</code> parameters are available as for <code><a href="reference/visualise_single_sequence.html">visualise_single_sequence()</a></code> and <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code>. However, there are also <code>modified_bases_outline_&lt;parameter&gt;</code> and <code>other_bases_outline_&lt;parameter&gt;</code> arguments that can be used to override the global setting, or set to <code>NA</code> to inherit the global setting.</p>
<p>One use of this might be to draw outlines only for modification-assessed bases (using the default black/3/mitre settings). This could be accomplished by setting <code>other_bases_outline_linewidth = 0</code> to disable outlines for non-modification-assessed bases, while allowing modification-assessed bases to inherit the global default outlines.</p>
<p>Colour-related arguments:</p>
<ul>
<li>
<code>low_colour</code>: The colour to use at the bottom end of the modification probability scale. Defaults to blue (<code>#0000FF</code>).</li>
<li>
<code>high_colour</code>: The colour to use at the top end of the modification probability scale. Defaults to red (<code>#FF0000</code>).</li>
<li>
<code>other_bases_colour</code>: The colour to use for non-modification-assessed bases. Defaults to grey and generally should be fairly neutral (though this is not enforced in any way).</li>
<li>
<code>background_colour</code>: The colour to use for the background. Defaults to white.</li>
<li>
<code>index_annotation_colour</code>: The colour to use for index annotations. Defaults to dark red.</li>
<li>
<code>sequence_text_colour</code>: The colour to use for sequence/probability text. Defaults to black.</li>
<li>
<code>outline_colour</code>: The colour to use for the box outlines. Defaults to white.</li>
<li>
<code>modified_bases_outline_colour</code>: The colour to use for the box outlines of modification-assessed bases specifically. Can be set to <code>NA</code> (default), in which case the value from <code>outline_colour</code> is used. If <code>outline_colour</code> and <code>modified_bases_outline_colour</code> are set to different values, the value from <code>modified_bases_outline_colour</code> is prioritised.</li>
<li>
<code>other_bases_outline_colour</code>: The colour to use for the box outlines of non-modification-assessed bases specifically. Can be set to <code>NA</code> (default), in which case the value from <code>outline_colour</code> is used. If <code>outline_colour</code> and <code>other_bases_outline_colour</code> are set to different values, the value from <code>other_bases_outline_colour</code> is prioritised.</li>
</ul>
<p>Layout-related arguments:</p>
<ul>
<li>
<code>margin</code>: The margin around the image in terms of the size of base boxes (e.g. the default value of <code>0.5</code> adds a margin half the size of the base boxes, which is 50 px with the default <code>pixels_per_base = 100</code>).</li>
<li>
<code>outline_linewidth</code>: The thickness of the box outlines. Can be set to <code>0</code> to disable box outlines. Defaults to <code>3</code>.</li>
<li>
<code>modified_bases_outline_linewidth</code>: The thickness of the box outlines for modification-assessed bases specifically. Can be set to <code>NA</code> (default) to inherit the value from <code>outline_linewidth</code>, or <code>0</code> to disable box outlines specifically for modification-assessed bases. If <code>outline_linewidth</code> and <code>modified_bases_outline_linewidth</code> are set to different values, the value from <code>modified_bases_outline_linewidth</code> is prioritised.</li>
<li>
<code>other_bases_outline_linewidth</code>: The thickness of the box outlines for non-modification-assessed bases specifically. Can be set to <code>NA</code> (default) to inherit the value from <code>outline_linewidth</code>, or <code>0</code> to disable box outlines specifically for non-modification-assessed bases. If <code>outline_linewidth</code> and <code>other_bases_outline_linewidth</code> are set to different values, the value from <code>other_bases_outline_linewidth</code> is prioritised.</li>
<li>
<code>outline_join</code>: Changes how the corners of the box outlines are handled. Must be one of <code>"mitre"</code>, <code>"bevel"</code>, or <code>"round"</code>. Defaults to <code>"mitre"</code>. It is unlikely that you would ever need to change this.</li>
<li>
<code>modified_bases_outline_join</code>: How corners are handled for modification-assessed bases only. Can be set to <code>NA</code> (default) to inherit from <code>outline_join</code>, otherwise overrides <code>outline_join</code>.</li>
<li>
<code>other_bases_outline_join</code>: How corners are handled for non-modification-assessed bases only. Can be set to <code>NA</code> (default) to inherit from <code>outline_join</code>, otherwise overrides <code>outline_join</code>.</li>
<li>
<code>pixels_per_base</code>: Resolution, as determined by number of pixels in the side length of one DNA base square. Everything else is scaled proportionally. Defaults to <code>100</code>.</li>
<li>
<code>render_device</code>: The device <code>ggsave</code> should use to render the plot. Defaults to <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png</a></code>, not recommended to change. Can be set to <code>NULL</code> to infer device based on <code>filename</code> extension.</li>
</ul>
<p>All colour-type arguments should accept <code>colour</code>, <code>color</code>, or <code>col</code> for the argument name.</p>
<p>Here is an example with wild colours:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_08.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">4</span>, </span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    sequence_text_colour <span class="op">=</span> <span class="st">"magenta"</span>,</span>
<span>    index_annotation_colour <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"#00FF00"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    modified_bases_outline_colour <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"red"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_08.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_08.png"><!-- --></p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="co">## Text colour doesn't have an argument within the function</span></span>
<span><span class="co">## but can be modified by adding to the ggplot object like normal</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"#0000FF"</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"#FF0000"</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>          axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_08_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_08_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_08_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>One way this might be used in practice is for making a graphic in the “lollipop” style where methylated/modified CGs are black and unmodified CGs are white:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_09.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"lightblue1"</span>,</span>
<span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a><span class="do">## Warning: If margin is small and outlines are on (outline_linewidth &gt; 0), outlines may be cut off at the edges of the plot. Check if this is happening and consider using a bigger margin.</span></span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a><span class="do">## Current margin: 0.1</span></span></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_09.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_09.png"><!-- --></p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"lightblue1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_09_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_09_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_09_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="id_66-colour-mapping-customisation">6.6 Colour mapping customisation<a class="anchor" aria-label="anchor" href="#id_66-colour-mapping-customisation"></a>
</h2>
<p>A very useful feature in <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> is the ability to “clamp” the scale. This means all probabilities below the <code>low_clamp</code> value will be set to the low colour, all probabilities above the <code>high_clamp</code> value will be set to the high colour, and linear colour interpolation will occur only in between the clamp values.</p>
<p>Clamping arguments:</p>
<ul>
<li>
<code>low_clamp</code>: The probability score at and below which all values will be represented as <code>low_colour</code>.</li>
<li>
<code>high_clamp</code>: The probability score at and above which all values will be represented as <code>high_colour</code>.</li>
</ul>
<p>The clamp values need to be on the same scale as the probability input i.e. 0-255 for standard MM/ML tags from Dorado/Guppy modified basecalling. It would be possible to input decimal probabilities e.g. <code>"0.1,0.5,0.9,0.23"</code>, in which case the default high clamp of 255 will not be appropriate and must be set to a sensible value ≤ 1.</p>
<p>Here is the lollipop scale but with <code>low_clamp = 127</code> and <code>high_clamp = 128</code> to make all values binary white/black depending on whether they are below or above the equivalent of 0.5 methylation probability:</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_10.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    margin <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">127</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">128</span>,</span>
<span>    other_bases_colour <span class="op">=</span> <span class="st">"lightblue1"</span>,</span>
<span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="do">## Warning: If margin is small and outlines are on (outline_linewidth &gt; 0), outlines may be cut off at the edges of the plot. Check if this is happening and consider using a bigger margin.</span></span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a><span class="do">## Current margin: 0.1</span></span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_10.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_10.png"><!-- --></p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">127</span>,</span>
<span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">128</span>,</span>
<span>    background_colour <span class="op">=</span> <span class="st">"lightblue1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_10_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_10_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_10_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>The clamping arguments do not have to be integers. Clamping is implemented with <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin()</a></code> and <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax()</a></code> and relies on their default behaviour for <code>pm&lt;in/ax&gt;(vector, clamping_value)</code>, which is to clamp to a fraction when the clamping value is fractional. For example, <code>pmin(c(1,2,3,4,5), 3.5)</code> produces <code>c(1.0, 2.0, 3.0, 3.5, 3.5)</code> i.e. the values above <code>3.5</code> were clamped down to <code>3.5</code>. Therefore, clamping with fractional values will clamp extreme probabilities to said fractional value, but this is not visible and does not interfere with plotting logic.</p>
<p>This means one approach is to define clamping values as <code>proportion*255</code>, as that can be easier than working out which integer to use. Using the standard blue/red colour scheme with the hydroxymethylation data but clamping at 30% and 70% probability gives the following:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">methylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">methylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_11.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_11.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_11.png"><!-- --></p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_11_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_11_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_11_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>The clamping does not need to be symmetrical. One use for this is if the data is skewed. For example, the methylation scores were randomly generated from <code>0</code> to <code>255</code> for each CpG in <code>example_many_sequences</code>, but the hydroxymethylation scores were generated from <code>0</code> to <code>(255 - methylation score)</code> for each CpG to avoid &gt;100% total modification probability, so they tend to be lower. Here is the hydroxymethylation data visualised with clamping at 10% and 50%:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract information to list of character vectors</span></span>
<span><span class="va">hydroxymethylation_data_for_visualisation</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">example_many_sequences</span>,</span>
<span>    locations_colname <span class="op">=</span> <span class="st">"hydroxymethylation_locations"</span>,</span>
<span>    probabilities_colname <span class="op">=</span> <span class="st">"hydroxymethylation_probabilities"</span>,</span>
<span>    sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                        <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>    desc_sort <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use saved methylation data for visualisation to make image</span></span>
<span><span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    modification_locations     <span class="op">=</span> <span class="va">hydroxymethylation_data_for_visualisation</span><span class="op">$</span><span class="va">locations</span>,</span>
<span>    modification_probabilities <span class="op">=</span> <span class="va">hydroxymethylation_data_for_visualisation</span><span class="op">$</span><span class="va">probabilities</span>,</span>
<span>    sequences                  <span class="op">=</span> <span class="va">hydroxymethylation_data_for_visualisation</span><span class="op">$</span><span class="va">sequences</span>,</span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_12.png"</span><span class="op">)</span>,</span>
<span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_12.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_12.png"><!-- --></p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"Hydroxymethylation probability"</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">255</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_12_scalebar.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_12_scalebar.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_12_scalebar.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p><em><strong>IMPORTANT:</strong> make sure that you provide the scalebar when presenting data, especially if clamping is used, otherwise the colours could be misleading or academically dishonest.</em></p>
</div>
<div class="section level2">
<h2 id="id_67-scalebar-customisation">6.7 Scalebar customisation<a class="anchor" aria-label="anchor" href="#id_67-scalebar-customisation"></a>
</h2>
<p>The scalebar produced by <code><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale()</a></code> is, like the rest of the visualisations, highly customisable. The colours, clamping, precision, and presence of various plot elements are all customisable via the following arguments:</p>
<p>Colour arguments:</p>
<ul>
<li>
<code>low_colour</code>: The colour to use at the bottom end of the modification probability scale. Defaults to blue (<code>#0000FF</code>).</li>
<li>
<code>high_colour</code>: The colour to use at the top end of the modification probability scale. Defaults to red (<code>#FF0000</code>).</li>
<li>
<code>background_colour</code>: The colour to use for the background. Defaults to white.</li>
<li>
<code>outline_colour</code>: The colour of the outline around the whole scalebar. Defaults to black.</li>
</ul>
<p>Clamping arguments:</p>
<ul>
<li>
<code>low_clamp</code>: The probability score at and below which all values will be represented as <code>low_colour</code>. Defaults to <code>0</code>.</li>
<li>
<code>high_clamp</code>: The probability score at and above which all values will be represented as <code>high_colour</code>. Defaults to <code>255</code>.</li>
<li>
<code>full_range</code>: Length-2 numeric vector specifying the range of possible probability values. Defaults to <code>c(0, 255)</code> but <code>c(0, 1)</code> would also be sensible depending on the data.</li>
<li>
<code>precision</code>: How many different shades should be rendered. Larger values give a smoother gradient. Defaults to <code>10^3</code> i.e. <code>1000</code>, which looks smooth to my eyes and isn’t too intensive to calculate. Note that if white lines appear in the output image, this is because of issues aligning the very thin rectangles with the pixel grid and can generally be fixed by very slightly changing <code>precision</code>.</li>
</ul>
<p>Layout arguments:</p>
<ul>
<li>
<code>axis_location</code>: Which edge should be labelled. The gradient will always be along this axis (i.e. horizontal gradient for <code>"top"</code> or <code>"bottom"</code>, vertical gradient for <code>"left"</code> or <code>"right"</code>). Accepts <code>"top"</code> / <code>"north"</code>, <code>"bottom"</code> / <code>"south"</code>, <code>"left"</code> / <code>"west"</code>, and <code>"right"</code> / <code>"east"</code> (not case sensitive).</li>
<li>
<code>axis_title</code>: The desired axis title. Defaults to <code>NULL</code> (no title).</li>
<li>
<code>do_axis_ticks</code>: Boolean specifying whether ticks and number labels on the gradient axis should be enabled. Defaults to <code>TRUE</code>.</li>
<li>
<code>outline_linewidth</code>: The width of the outline around the whole scalebar. Can be set to 0 to remove outline. Defaults to 1.</li>
</ul>
<p>Using all defaults but with lower precision gives the following:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span>precision <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_scalebar_alone_01.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_scalebar_alone_01.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_scalebar_alone_01.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>Disabling axis ticks with intermediate precision gives the following:</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    precision <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    do_axis_ticks <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_scalebar_alone_02.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">1.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_scalebar_alone_02.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_scalebar_alone_02.png" alt="" width="60%" style="display: block; margin: auto;"></p>
<p>If ticks are left on, they can be customised with <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code> as per usual for a ggplot. Here is an example of the left side being the gradient axis i.e. a vertical plot, with ticks every 0.1 instead of every 0.25.</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    high_colour <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>    low_colour <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    full_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>    precision <span class="op">=</span> <span class="fl">101</span>,</span>
<span>    axis_location <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    do_axis_ticks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    axis_title <span class="op">=</span> <span class="st">"some kind of title"</span>,</span>
<span>    outline_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_scalebar_alone_03.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">5.25</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_scalebar_alone_03.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_scalebar_alone_03.png" alt="" width="20%" style="display: block; margin: auto;"></p>
<p>And here is an example of a more sensible scalebar with top text:</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create scalebar and save to object</span></span>
<span><span class="va">scalebar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation_colour_scale.html">visualise_methylation_colour_scale</a></span><span class="op">(</span></span>
<span>    low_clamp <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    high_clamp  <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span><span class="fl">255</span>,</span>
<span>    axis_location <span class="op">=</span> <span class="st">"north"</span>,</span>
<span>    axis_title <span class="op">=</span> <span class="st">"Methylation probability"</span>,</span>
<span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write png from object</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_scalebar_alone_04.png"</span><span class="op">)</span>, <span class="va">scalebar</span>, dpi <span class="op">=</span> <span class="fl">300</span>, width <span class="op">=</span> <span class="fl">5.25</span>, height <span class="op">=</span> <span class="fl">2</span>, device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View image</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_scalebar_alone_04.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_scalebar_alone_04.png" alt="" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="id_68-think-about-the-offset">6.8 Think about the offset!<a class="anchor" aria-label="anchor" href="#id_68-think-about-the-offset"></a>
</h2>
<p>When merging modification data read from FASTQ, the positional offset when reversing can be changed (as discussed in detail in the <a href="#id_332-modified-fastq-eg-methylation">reading from modified FASTQ</a> section).</p>
<p>A summary of the sensible offset options (i.e. 0 or 1) copied from that section is as follows:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="do">## Here the stars represent the true biochemical modifications on the reverse strand:</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="do">## (occurring at the Cs of CGs in the 5'-3' direction)</span></span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb170-6"><a href="#cb170-6" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb170-7"><a href="#cb170-7" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span>
<span id="cb170-8"><a href="#cb170-8" tabindex="-1"></a></span>
<span id="cb170-9"><a href="#cb170-9" tabindex="-1"></a><span class="do">## If we take the complementary locations on the forward strand,</span></span>
<span id="cb170-10"><a href="#cb170-10" tabindex="-1"></a><span class="do">## the modification locations correspond to Gs rather than Cs,</span></span>
<span id="cb170-11"><a href="#cb170-11" tabindex="-1"></a><span class="do">## but are in the exact same locations:</span></span>
<span id="cb170-12"><a href="#cb170-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb170-13"><a href="#cb170-13" tabindex="-1"></a><span class="do">##        o  o  o  o  o      </span></span>
<span id="cb170-14"><a href="#cb170-14" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb170-15"><a href="#cb170-15" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb170-16"><a href="#cb170-16" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span>
<span id="cb170-17"><a href="#cb170-17" tabindex="-1"></a></span>
<span id="cb170-18"><a href="#cb170-18" tabindex="-1"></a><span class="do">## If we offset the locations by 1 on the forward strand,</span></span>
<span id="cb170-19"><a href="#cb170-19" tabindex="-1"></a><span class="do">## the modifications are always associated with the C of a CG,</span></span>
<span id="cb170-20"><a href="#cb170-20" tabindex="-1"></a><span class="do">## but the locations are moved slightly:</span></span>
<span id="cb170-21"><a href="#cb170-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb170-22"><a href="#cb170-22" tabindex="-1"></a><span class="do">##       o  o  o  o  o       </span></span>
<span id="cb170-23"><a href="#cb170-23" tabindex="-1"></a><span class="do">## 5'  GGCGGCGGCGGCGGCGGA  3'</span></span>
<span id="cb170-24"><a href="#cb170-24" tabindex="-1"></a><span class="do">## 3'  CCGCCGCCGCCGCCGCCT  5'</span></span>
<span id="cb170-25"><a href="#cb170-25" tabindex="-1"></a><span class="do">##        *  *  *  *  *</span></span></code></pre></div>
<p>The visualisations thus far in this section have all used <code>offset = 1</code> so that methylated Cs in CGs on the reverse strand are mapped to Cs of CGs in the forward strand when reverse complemented, ensuring consistency with reads that were forward to begin with.</p>
<p>However, there are actually four ways reverse read may be displayed: - All reads 5’-3’, with reverse reads running the opposite direction to forward reads (accomplished by <em>not</em> using the <code>forward_&lt;sequence/locations/probabilities&gt;</code> columns in <code><a href="reference/extract_and_sort_methylation.html">extract_and_sort_methylation()</a></code>, so that the raw unreversed reads are shown). - Reverse reads flipped to 3’-5’ so that they are complementary to the forward reads (accomplished by setting <code>reverse_complement_mode = "reverse_only"</code> and <code>offset = 0</code> in <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>) - Reverse reads reverse-complemented to the corresponding 5’-3’ so that they match the forward reads, but leaving modifications in the original locations i.e. G of the reversed CG dinucleotides (accomplished by setting <code>reverse_complement_mode = "DNA"</code> and <code>offset = 0</code> in <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>). - Reverse reads reverse-complemented to the corresponding 5’-3’ so that they match the forward reads, and offsetting the modification locations by 1 to always be on the C of CG dinucleotides even after reverse-complementing (accomplished by setting <code>reverse_complement_mode = "DNA"</code> and <code>offset = 1</code> in <code><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata()</a></code>).</p>
<p>To illustrate this, we will create a dataset of two reads over the same region but in opposite directions, and apply each of these four extraction options. This will also serve to illustrate how <code>ggDNAvis</code> visualisations can be returned as <code>ggplot</code> objects and further modified:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create random methylation probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">random_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">255</span>, size <span class="op">=</span> <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Set up original dataframe with reads always 5'-3'</span></span>
<span><span class="va">location_reversing_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    read <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"example_f"</span>, <span class="st">"example_r"</span><span class="op">)</span>,</span>
<span>    sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GGCGGCGGCGGCGGAGGAGGCGGCGGAGGAA"</span>, <span class="st">"TTCCTCCGCCGCCTCCTCCGCCGCCGCCGCC"</span><span class="op">)</span>,</span>
<span>    quality  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    sequence_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">31</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    modification_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"methylation"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    methylation_locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3,6,9,12,21,24"</span>, <span class="st">"7,10,19,22,25,28"</span><span class="op">)</span>,</span>
<span>    methylation_probabilities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="reference/vector_to_string.html">vector_to_string</a></span><span class="op">(</span><span class="va">random_probabilities</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="reference/vector_to_string.html">vector_to_string</a></span><span class="op">(</span><span class="va">random_probabilities</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Set up metadata</span></span>
<span><span class="va">location_reversing_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    read <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"example_f"</span>, <span class="st">"example_r"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forward"</span>, <span class="st">"reverse"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create new dataframes with various reversal settings and save all to list</span></span>
<span><span class="co">## Use c(list(original_dataframe), new_list) to make list of original then the three new ones</span></span>
<span><span class="va">offsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">modes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reverse_only"</span>, <span class="st">"DNA"</span>, <span class="st">"DNA"</span><span class="op">)</span></span>
<span><span class="va">dataframes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">location_reversing_example</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">offsets</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">reversed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_methylation_with_metadata.html">merge_methylation_with_metadata</a></span><span class="op">(</span></span>
<span>        <span class="va">location_reversing_example</span>,</span>
<span>        <span class="va">location_reversing_metadata</span>,</span>
<span>        reversed_location_offset <span class="op">=</span> <span class="va">offsets</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>        reverse_complement_mode <span class="op">=</span> <span class="va">modes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co">## Overwrite "sequence" with "forward_sequence" etc in the returned dataframe</span></span>
<span>    <span class="co">## This means "sequence" will hold the original sequences for the original dataframe,</span></span>
<span>    <span class="co">## but hold the reversed/forwardified sequences for the following three dataframes</span></span>
<span>    <span class="va">reversed_data</span><span class="op">$</span><span class="va">sequence</span> <span class="op">=</span> <span class="va">reversed_data</span><span class="op">$</span><span class="va">forward_sequence</span></span>
<span>    <span class="va">reversed_data</span><span class="op">$</span><span class="va">methylation_locations</span> <span class="op">=</span> <span class="va">reversed_data</span><span class="op">$</span><span class="va">forward_methylation_locations</span></span>
<span>    <span class="va">reversed_data</span><span class="op">$</span><span class="va">methylation_probabilities</span> <span class="op">=</span> <span class="va">reversed_data</span><span class="op">$</span><span class="va">forward_methylation_probabilities</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">reversed_data</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract locations/probabilities/sequences vectors from each dataframe</span></span>
<span><span class="co">## Because of the overwriting at the previous step, "sequence", "modification_locations" etc</span></span>
<span><span class="co">## hold the original values for the first (unmodified) dataset, but the forward-ified versions</span></span>
<span><span class="co">## for the three later datasets</span></span>
<span><span class="va">vectors_for_plotting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dataframes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="reference/extract_and_sort_methylation.html">extract_methylation_from_dataframe</a></span><span class="op">(</span></span>
<span>        <span class="va">x</span>,</span>
<span>        locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>        probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>        sequences_colname <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>        lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>        grouping_levels <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        sort_by <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Merge vectors across dataframes, with padding in between to visually separate the examples</span></span>
<span><span class="va">blanks</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"locations"</span>, <span class="st">"probabilities"</span>, <span class="st">"sequences"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">vectors_for_plotting</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">blanks</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="va">blanks</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## Calculate the tile width and height that we will end up with</span></span>
<span><span class="va">lines_to_annotate</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="va">blanks</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">*</span><span class="fl">2</span></span>
<span><span class="va">margin</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">input</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lines_to_annotate</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create dataframe for titles</span></span>
<span><span class="va">titles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(a) Original sequences, both 5'-3' (e.g. original reads):"</span>,</span>
<span>             <span class="st">"(b) Reversed to be 3'-5', offset 0:"</span>,</span>
<span>             <span class="st">"(c) Reverse-complemented to 5'-3' of other strand, offset 0:"</span>,</span>
<span>             <span class="st">"(d) Reverse-complemented to 5'-3' of other strand, offset 1:"</span><span class="op">)</span>,</span>
<span>    lines <span class="op">=</span> <span class="va">lines_to_annotate</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">titles</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">titles</span><span class="op">$</span><span class="va">lines</span> <span class="op">-</span> <span class="fl">0.66</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create dataframe for 1 extra tile on each edge</span></span>
<span><span class="co">## and for 5' and 3' direction indicators</span></span>
<span><span class="va">lines_for_tiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lines_to_annotate</span><span class="op">)</span> <span class="op">+</span> <span class="va">lines_to_annotate</span> <span class="op">-</span> <span class="fl">2</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lines_to_annotate</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    decreasing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="va">k</span><span class="op">+</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="va">k</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lines_for_tiles</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">(</span><span class="va">lines_for_tiles</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">)</span> <span class="op">/</span> <span class="va">n</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">k</span>,</span>
<span>    height <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">n</span>,</span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"5'"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"5'"</span>, <span class="st">"3'"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"5'"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3'"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"3'"</span>, <span class="st">"5'"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3'"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create visualisation</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/visualise_methylation.html">visualise_methylation</a></span><span class="op">(</span></span>
<span>    <span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="va">input</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="va">input</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    index_annotation_lines <span class="op">=</span> <span class="va">lines_to_annotate</span>,</span>
<span>    index_annotation_interval <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"darkgrey"</span>,</span>
<span>    sequence_text_type <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    low_clamp <span class="op">=</span> <span class="fl">255</span><span class="op">*</span><span class="fl">0.4</span>,</span>
<span>    high_clamp <span class="op">=</span> <span class="fl">255</span><span class="op">*</span><span class="fl">0.6</span>,</span>
<span>    margin <span class="op">=</span> <span class="va">margin</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## Add titles and 5'/3' directions</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">directions</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, width <span class="op">=</span> <span class="va">width</span>, height <span class="op">=</span> <span class="va">height</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">0</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">directions</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"darkred"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">titles</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Save visualisation</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">output_location</span>, <span class="st">"modification_reversing_example.png"</span><span class="op">)</span>,</span>
<span>    plot <span class="op">=</span> <span class="va">output</span>,</span>
<span>    dpi <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    <span class="co">## k is the width in bases of the original visualisation</span></span>
<span>    <span class="co">## We added 2 new squares, and need to account for the margin</span></span>
<span>    width <span class="op">=</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">margin</span>,</span>
<span>    <span class="co">## n is the height in bases of the original visualisation</span></span>
<span>    <span class="co">## We didn't add any new lines, but still need to account for the margin</span></span>
<span>    height <span class="op">=</span> <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">margin</span>,</span>
<span>    device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## View visualisation</span></span>
<span><span class="fu">view_image</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">display_location</span>, <span class="st">"modification_reversing_example.png"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/ejade42/ggDNAvis/main/README_files/output/modification_reversing_example.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="id_69-performance">6.9 Performance<a class="anchor" aria-label="anchor" href="#id_69-performance"></a>
</h2>
<p><code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code> is identical to <code><a href="reference/visualise_many_sequences.html">visualise_many_sequences()</a></code> with respect to <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> versus <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile()</a></code>, so read <a href="#id_55-performance"><code>visualise_many_sequences()</code> performance</a>.</p>
<p>For <code><a href="reference/visualise_methylation.html">visualise_methylation()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> is automatically used if:</p>
<ul>
<li>
<code>sequence_text_type</code> is <code>"none"</code> or <code>sequence_text_size</code> is <code>0</code>,</li>
<li>
<code>index_annotation_lines</code> is <code>NA</code> or <code>numeric(0)</code>, or <code>index_annotation_interval</code> is <code>0</code>, or <code>index_annotation_size</code> is <code>0</code>, and</li>
<li>either:
<ul>
<li>
<code>outline_linewidth</code> is <code>0</code>, <code>modified_bases_outline_linewidth</code> is <code>NA</code>, and <code>other_bases_outline_linewidth</code> is <code>NA</code>, or</li>
<li>
<code>modified_bases_outline_linewidth</code> is <code>0</code> and <code>other_bases_outline_linewidth</code> is <code>0</code>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level1">
<h1 id="id_7-advanced-usage">7 Advanced usage<a class="anchor" aria-label="anchor" href="#id_7-advanced-usage"></a>
</h1>
<p>As ggDNAvis visualisations can be returned as ggplots by setting <code>return = TRUE</code>, they can be added to and further modified using standard ggplot processing (e.g. adding new geoms). The modification reversing example just above is one example of this, but more are shown in the <a href="https://doi.org/10.1101/XXXXXX" class="external-link">ggDNAvis manuscript</a> - not reproduced here for copyright safety. The code to generate all these advanced, composite visualisations is available in the <a href="https://github.com/ejade42/ggDNAvis/blob/main/manuscript" class="external-link">manuscript/ directory</a> of the source code repo.</p>
<p>The general principles of advanced usage are:</p>
<ul>
<li><p>Visualisations can be returned using <code>return = TRUE</code> rather than being directly exported via <code>filename = "myfile.png"</code>.</p></li>
<li><p>Additional layers such as text markup can be added in typical ggplot fashion, e.g. by making a new dataframe with text labels and locations (bearing in mind that ggDNAvis visualisations occupy a square from cartesian coordinates 0,0 to 1,1).</p></li>
<li><p>To export the images with the correct aspect ratio, you will need to calculate the appropriate dimensions. My approach is generally to count the width and height in bases (e.g. <code>width = max(nchar(sequences))</code> and <code>height = length(sequences)</code>, though bear in mind that index annotations add additional lines e.g. might need <code>height = length(sequences) + length(index_annotation_lines)</code>), then set those as the width and height in inches in <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code> while setting <code>dpi = pixels_per_base</code>.</p></li>
<li><p>Composite/multi-panel visualisations can be made by merging ggplot objects using <code>patchwork</code> or <code>cowplot</code> packages, or by overlaying exported PNGs using the <code>magick</code> package.</p></li>
</ul>
</div>
<div class="section level1">
<h1 id="id_8-references">8 References<a class="anchor" aria-label="anchor" href="#id_8-references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-harrowerColorBrewerorgOnlineTool2003" class="csl-entry">
Harrower, M., &amp; Brewer, C. A. (2003). ColorBrewer.org: An Online Tool for Selecting Colour Schemes for Maps. <em>The Cartographic Journal</em>, <em>40</em>(1), 27–37. <a href="https://doi.org/10.1179/000870403235002042" class="external-link uri">https://doi.org/10.1179/000870403235002042</a>
</div>
<div id="ref-sone_long-read_2019" class="csl-entry">
Sone, J., Mitsuhashi, S., Fujita, A., Mizuguchi, T., Hamanaka, K., Mori, K., Koike, H., Hashiguchi, A., Takashima, H., Sugiyama, H., Kohno, Y., Takiyama, Y., Maeda, K., Doi, H., Koyano, S., Takeuchi, H., Kawamoto, M., Kohara, N., Ando, T., … Sobue, G. (2019). Long-read sequencing identifies GGC repeat expansions in <em>NOTCH2NLC</em> associated with neuronal intranuclear inclusion disease. <em>Nature Genetics</em>, <em>51</em>(8), 1215–1221. <a href="https://doi.org/10.1038/s41588-019-0459-y" class="external-link uri">https://doi.org/10.1038/s41588-019-0459-y</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggDNAvis" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ejade42/ggDNAvis/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ejade42/ggDNAvis/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggDNAvis</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Evelyn Jade <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0003-7761-5425" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ejade42/ggDNAvis/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ejade42/ggDNAvis/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check (latest dev)"></a></li>
<li><a href="https://CRAN.R-project.org/package=ggDNAvis" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggDNAvis" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=ggDNAvis" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/ggDNAvis" alt="CRAN monthly downloads"></a></li>
<li><a href="https://cran.r-project.org/package=ggDNAvis" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ggDNAvis" alt="CRAN total downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evelyn Jade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

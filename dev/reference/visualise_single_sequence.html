<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualise a single DNA/RNA sequence — visualise_single_sequence • ggDNAvis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Visualise a single DNA/RNA sequence — visualise_single_sequence"><meta name="description" content="This function takes a DNA/RNA sequence and returns a ggplot
visualising it, with the option to directly export a png image
with appropriate dimensions. Colours, line wrapping, index annotation
interval, and pixels per square when exported are configurable."><meta property="og:description" content="This function takes a DNA/RNA sequence and returns a ggplot
visualising it, with the option to directly export a png image
with appropriate dimensions. Colours, line wrapping, index annotation
interval, and pixels per square when exported are configurable."><meta property="og:image" content="https://ejade42.github.io/ggDNAvis/logo.png"></head><body><p>









  pkgdown/google0acd00d8574ec2df.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggDNAvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-version" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Version</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-version"><li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/">Latest release</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/dev/">Latest dev</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.1/">v0.3.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.0/">v0.3.0</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.1/">v0.2.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.0/">v0.2.0</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ejade42/ggDNAvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visualise a single DNA/RNA sequence</h1>
      <small class="dont-index">Source: <a href="https://github.com/ejade42/ggDNAvis/blob/main/R/visualise_single_sequence.R" class="external-link"><code>R/visualise_single_sequence.R</code></a></small>
      <div class="d-none name"><code>visualise_single_sequence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a DNA/RNA sequence and returns a ggplot
visualising it, with the option to directly export a png image
with appropriate dimensions. Colours, line wrapping, index annotation
interval, and pixels per square when exported are configurable.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">visualise_single_sequence</span><span class="op">(</span></span>
<span>  <span class="va">sequence</span>,</span>
<span>  sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">ggplot_style</span>,</span>
<span>  background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  line_wrapping <span class="op">=</span> <span class="fl">75</span>,</span>
<span>  spacing <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sequence_text_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>  index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>  index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>  return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>  pixels_per_base <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sequence">sequence<a class="anchor" aria-label="anchor" href="#arg-sequence"></a></dt>
<dd><p><code>character</code>. A DNA or RNA sequence to visualise e.g. <code>"AAATGCTGC"</code>.</p></dd>


<dt id="arg-sequence-colours">sequence_colours<a class="anchor" aria-label="anchor" href="#arg-sequence-colours"></a></dt>
<dd><p><code>character vector</code>, length 4. A vector indicating which colours should be used for each base. In order: <code>c(A_colour, C_colour, G_colour, T/U_colour)</code>.<br><br> Defaults to red, green, blue, purple in the default shades produced by ggplot with 4 colours, i.e. <code>c("#F8766D", "#7CAE00", "#00BFC4", "#C77CFF")</code>, accessed via <code><a href="sequence_colour_palettes.html">sequence_colour_palettes</a></code><code>$ggplot_style</code>.</p></dd>


<dt id="arg-background-colour">background_colour<a class="anchor" aria-label="anchor" href="#arg-background-colour"></a></dt>
<dd><p><code>character</code>. The colour of the background. Defaults to white.</p></dd>


<dt id="arg-line-wrapping">line_wrapping<a class="anchor" aria-label="anchor" href="#arg-line-wrapping"></a></dt>
<dd><p><code>integer</code>. The number of bases that should be on each line before wrapping. Defaults to <code>75</code>. Recommended to make this a multiple of the repeat unit size (e.g. 3<em>n</em> for a trinucleotide repeat) if visualising a repeat sequence.</p></dd>


<dt id="arg-spacing">spacing<a class="anchor" aria-label="anchor" href="#arg-spacing"></a></dt>
<dd><p><code>integer</code>. The number of blank lines between each line of sequence. Defaults to <code>1</code>.<br><br> Be careful when setting to <code>0</code> as this means annotations have no space so might render strangely. Recommended to set <code>index_annotation_interval = 0</code> if doing so to disable annotations entirely.</p></dd>


<dt id="arg-margin">margin<a class="anchor" aria-label="anchor" href="#arg-margin"></a></dt>
<dd><p><code>numeric</code>. The size of the margin relative to the size of each base square. Defaults to <code>0.5</code> (half the side length of each base square).<br><br> Note that if index annotations are on (i.e. <code>index_annotation_interval</code> is not <code>0</code>), the top/bottom margin (depending on <code>index_annotations_above</code>) will always be at least 1 to leave space for them.<br><br> Likewise, very small margins (\(\le\)0.25) may cause thick outlines to be cut off at the edges of the plot. Recommended to either use a wider margin or a smaller <code>outline_linewidth</code>.</p></dd>


<dt id="arg-sequence-text-colour">sequence_text_colour<a class="anchor" aria-label="anchor" href="#arg-sequence-text-colour"></a></dt>
<dd><p><code>character</code>. The colour of the text within the bases (e.g. colour of "A" letter within boxes representing adenosine bases). Defaults to black.</p></dd>


<dt id="arg-sequence-text-size">sequence_text_size<a class="anchor" aria-label="anchor" href="#arg-sequence-text-size"></a></dt>
<dd><p><code>numeric</code>. The size of the text within the bases (e.g. size of "A" letter within boxes representing adenosine bases). Defaults to <code>16</code>. Set to <code>0</code> to hide sequence text (show box colours only).</p></dd>


<dt id="arg-index-annotation-colour">index_annotation_colour<a class="anchor" aria-label="anchor" href="#arg-index-annotation-colour"></a></dt>
<dd><p><code>character</code>. The colour of the little numbers underneath indicating base index (e.g. colour "15" label under the 15th base). Defaults to dark red.</p></dd>


<dt id="arg-index-annotation-size">index_annotation_size<a class="anchor" aria-label="anchor" href="#arg-index-annotation-size"></a></dt>
<dd><p><code>numeric</code>. The size of the little number underneath indicating base index (e.g. size of "15" label under the 15th base). Defaults to <code>12.5</code>.<br><br> Can sometimes be set to <code>0</code> to turn off annotations, but it is better/more reliable to do this via <code>index_annotation_interval = 0</code>.</p></dd>


<dt id="arg-index-annotation-interval">index_annotation_interval<a class="anchor" aria-label="anchor" href="#arg-index-annotation-interval"></a></dt>
<dd><p><code>integer</code>. The frequency at which numbers should be placed underneath indicating base index, starting counting from the leftmost base in each row. Defaults to <code>15</code> (every 15 bases along each row).<br><br> Recommended to make this a factor/divisor of the line wrapping length (meaning the final base in each line is annotated), otherwise the numbering interval resetting at the beginning of each row will result in uneven intervals at each line break.<br><br> Set to <code>0</code> to turn off annotations (preferable over using <code>index_annotation_size = 0</code>).</p></dd>


<dt id="arg-index-annotations-above">index_annotations_above<a class="anchor" aria-label="anchor" href="#arg-index-annotations-above"></a></dt>
<dd><p><code>logical</code>. Whether index annotations should go above (<code>TRUE</code>, default) or below (<code>FALSE</code>) each line of sequence.</p></dd>


<dt id="arg-index-annotation-vertical-position">index_annotation_vertical_position<a class="anchor" aria-label="anchor" href="#arg-index-annotation-vertical-position"></a></dt>
<dd><p><code>numeric</code>. How far annotation numbers should be rendered above (if <code>index_annotations_above = TRUE</code>) or below (if <code>index_annotations_above = FALSE</code>) each base. Defaults to <code>1/3</code>.<br><br> Not recommended to change at all. Strongly discouraged to set below 0 or above 1.</p></dd>


<dt id="arg-outline-colour">outline_colour<a class="anchor" aria-label="anchor" href="#arg-outline-colour"></a></dt>
<dd><p><code>character</code>. The colour of the box outlines. Defaults to black.</p></dd>


<dt id="arg-outline-linewidth">outline_linewidth<a class="anchor" aria-label="anchor" href="#arg-outline-linewidth"></a></dt>
<dd><p><code>numeric</code>. The linewidth of the box outlines. Defaults to <code>3</code>. Set to <code>0</code> to disable box outlines.</p></dd>


<dt id="arg-outline-join">outline_join<a class="anchor" aria-label="anchor" href="#arg-outline-join"></a></dt>
<dd><p><code>character</code>. One of <code>"mitre"</code>, <code>"round"</code>, or <code>"bevel"</code> specifying how outlines should be joined at the corners of boxes. Defaults to <code>"mitre"</code>. It would be unusual to need to change this.</p></dd>


<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p><code>logical</code>. Boolean specifying whether this function should return the ggplot object, otherwise it will return <code>invisible(NULL)</code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p><code>character</code>. Filename to which output should be saved. If set to <code>NA</code> (default), no file will be saved. Recommended to end with <code>".png"</code>, but can change if render device is changed.</p></dd>


<dt id="arg-render-device">render_device<a class="anchor" aria-label="anchor" href="#arg-render-device"></a></dt>
<dd><p><code>function/character</code>. Device to use when rendering. See <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code> documentation for options. Defaults to <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png</a></code>. Can be set to <code>NULL</code> to infer from file extension, but results may vary between systems.</p></dd>


<dt id="arg-pixels-per-base">pixels_per_base<a class="anchor" aria-label="anchor" href="#arg-pixels-per-base"></a></dt>
<dd><p><code>integer</code>. How large each box should be in pixels, if file output is turned on via setting <code>filename</code>. Corresponds to dpi of the exported image. Large values recommended because text needs to be legible when rendered significantly smaller than a box. Defaults to <code>100</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object containing the full visualisation, or <code>invisible(NULL)</code> if <code>return = FALSE</code>. It is often more useful to use <code>filename = "myfilename.png"</code>, because then the visualisation is exported at the correct aspect ratio.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Create sequence to visualise</span></span></span>
<span class="r-in"><span><span class="va">sequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GGC"</span>, <span class="fl">72</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GGAGGAGGCGGC"</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualise with all defaults</span></span></span>
<span class="r-in"><span><span class="co">## This looks ugly because it isn't at the right scale/aspect ratio</span></span></span>
<span class="r-in"><span><span class="fu">visualise_single_sequence</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_single_sequence-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with all defaults rather than returning</span></span></span>
<span class="r-in"><span><span class="fu">visualise_single_sequence</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">sequence</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vss_01.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vss_01.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vss_01.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_single_sequence-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export while customising appearance</span></span></span>
<span class="r-in"><span><span class="fu">visualise_single_sequence</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">sequence</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vss_02.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    sequence_colours <span class="op">=</span> <span class="va">sequence_colour_palettes</span><span class="op">$</span><span class="va">bright_pale</span>,</span></span>
<span class="r-in"><span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>    background_colour <span class="op">=</span> <span class="st">"lightgrey"</span>,</span></span>
<span class="r-in"><span>    line_wrapping <span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>    spacing <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    outline_linewidth <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    index_annotations_above <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    margin <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vss_02.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vss_02.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_single_sequence-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evelyn Jade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  
</body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualise methylation probabilities for many DNA sequences — visualise_methylation • ggDNAvis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Visualise methylation probabilities for many DNA sequences — visualise_methylation"><meta name="description" content="visualize_methylation() is an alias for visualise_methylation() - see aliases.
This function takes vectors of modifications locations, modification probabilities,
and sequence lengths (e.g. created by extract_and_sort_methylation()) and
visualises the probability of methylation (or other modification) across each read.
Assumes that the three main input vectors are of equal length \(n\) and represent \(n\) sequences
(e.g. Nanopore reads), where locations are the indices along each read at which modification
was assessed, probabilities are the probability of modification at each assessed site, and
lengths are the lengths of each sequence.
For each sequence, renders non-assessed (e.g. non-CpG) bases as other_bases_colour, renders
background (including after the end of the sequence) as background_colour, and renders assessed
bases on a linear scale from low_colour to high_colour.
Clamping means that the endpoints of the colour gradient can be set some distance into the probability
space e.g. with Nanopore &amp;gt; SAM probability values from 0-255, the default is to render 0 as fully blue
(#0000FF), 255 as fully red (#FF0000), and values in between linearly interpolated. However, clamping with
low_clamp = 100 and high_clamp = 200 would set all probabilities up to 100 as fully blue,
all probabilities 200 and above as fully red, and linearly interpolate only over the 100-200 range.
A separate scalebar plot showing the colours corresponding to each probability, with any/no clamping values,
can be produced via visualise_methylation_colour_scale()."><meta property="og:description" content="visualize_methylation() is an alias for visualise_methylation() - see aliases.
This function takes vectors of modifications locations, modification probabilities,
and sequence lengths (e.g. created by extract_and_sort_methylation()) and
visualises the probability of methylation (or other modification) across each read.
Assumes that the three main input vectors are of equal length \(n\) and represent \(n\) sequences
(e.g. Nanopore reads), where locations are the indices along each read at which modification
was assessed, probabilities are the probability of modification at each assessed site, and
lengths are the lengths of each sequence.
For each sequence, renders non-assessed (e.g. non-CpG) bases as other_bases_colour, renders
background (including after the end of the sequence) as background_colour, and renders assessed
bases on a linear scale from low_colour to high_colour.
Clamping means that the endpoints of the colour gradient can be set some distance into the probability
space e.g. with Nanopore &amp;gt; SAM probability values from 0-255, the default is to render 0 as fully blue
(#0000FF), 255 as fully red (#FF0000), and values in between linearly interpolated. However, clamping with
low_clamp = 100 and high_clamp = 200 would set all probabilities up to 100 as fully blue,
all probabilities 200 and above as fully red, and linearly interpolate only over the 100-200 range.
A separate scalebar plot showing the colours corresponding to each probability, with any/no clamping values,
can be produced via visualise_methylation_colour_scale()."><meta property="og:image" content="https://ejade42.github.io/ggDNAvis/logo.png"><link rel="stylesheet" href="extra.css"><script src="extra.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggDNAvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2.9035</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-interactive-app" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Interactive App</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-interactive-app"><li><a class="dropdown-item" href="../articles/interactive_app.html">Embedded</a></li>
    <li><a class="external-link dropdown-item" href="https://ejade42-ggdnavis.share.connect.posit.cloud/" target="_blank">Fullscreen</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-version" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Version</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-version"><li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/">Latest release</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/dev/">Latest dev</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.2/">v0.3.2</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.1/">v0.3.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.0/">v0.3.0</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.1/">v0.2.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.0/">v0.2.0</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ejade42/ggDNAvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visualise methylation probabilities for many DNA sequences</h1>
      <small class="dont-index">Source: <a href="https://github.com/ejade42/ggDNAvis/blob/main/R/visualise_methylation.R" class="external-link"><code>R/visualise_methylation.R</code></a></small>
      <div class="d-none name"><code>visualise_methylation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>visualize_methylation()</code> is an alias for <code>visualise_methylation()</code> - see <a href="ggDNAvis_aliases.html">aliases</a>.</p>
<p>This function takes vectors of modifications locations, modification probabilities,
and sequence lengths (e.g. created by <code><a href="extract_and_sort_methylation.html">extract_and_sort_methylation()</a></code>) and
visualises the probability of methylation (or other modification) across each read.</p>
<p>Assumes that the three main input vectors are of equal length \(n\) and represent \(n\) sequences
(e.g. Nanopore reads), where <code>locations</code> are the indices along each read at which modification
was assessed, <code>probabilities</code> are the probability of modification at each assessed site, and
<code>lengths</code> are the lengths of each sequence.</p>
<p>For each sequence, renders non-assessed (e.g. non-CpG) bases as <code>other_bases_colour</code>, renders
background (including after the end of the sequence) as <code>background_colour</code>, and renders assessed
bases on a linear scale from <code>low_colour</code> to <code>high_colour</code>.</p>
<p>Clamping means that the endpoints of the colour gradient can be set some distance into the probability
space e.g. with Nanopore &gt; SAM probability values from 0-255, the default is to render 0 as fully blue
(<code>#0000FF</code>), 255 as fully red (<code>#FF0000</code>), and values in between linearly interpolated. However, clamping with
<code>low_clamp = 100</code> and <code>high_clamp = 200</code> would set <em>all probabilities up to 100</em> as fully blue,
<em>all probabilities 200 and above</em> as fully red, and linearly interpolate only over the <code>100-200</code> range.</p>
<p>A separate scalebar plot showing the colours corresponding to each probability, with any/no clamping values,
can be produced via <code><a href="visualise_methylation_colour_scale.html">visualise_methylation_colour_scale()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">visualise_methylation</span><span class="op">(</span></span>
<span>  <span class="va">modification_locations</span>,</span>
<span>  <span class="va">modification_probabilities</span>,</span>
<span>  <span class="va">sequences</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  high_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  low_clamp <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  high_clamp <span class="op">=</span> <span class="fl">255</span>,</span>
<span>  background_colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  other_bases_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  sequence_text_type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">256</span><span class="op">)</span>,</span>
<span>  sequence_text_rounding <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sequence_text_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  sequence_text_size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  index_annotation_colour <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>  index_annotation_size <span class="op">=</span> <span class="fl">12.5</span>,</span>
<span>  index_annotation_interval <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  index_annotations_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index_annotation_vertical_position <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  index_annotation_full_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  outline_join <span class="op">=</span> <span class="st">"mitre"</span>,</span>
<span>  modified_bases_outline_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  modified_bases_outline_linewidth <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  modified_bases_outline_join <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  other_bases_outline_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  other_bases_outline_linewidth <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  other_bases_outline_join <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  force_raster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  render_device <span class="op">=</span> <span class="fu">ragg</span><span class="fu">::</span><span class="va"><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">agg_png</a></span>,</span>
<span>  pixels_per_base <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  monitor_performance <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-modification-locations">modification_locations<a class="anchor" aria-label="anchor" href="#arg-modification-locations"></a></dt>
<dd><p><code>character vector</code>. One character value for each sequence, storing a condensed string (e.g. <code>"3,6,9,12"</code>, produced via <code><a href="vector_to_string.html">vector_to_string()</a></code>) of the indices along the read at which modification was assessed. Indexing starts at 1.</p></dd>


<dt id="arg-modification-probabilities">modification_probabilities<a class="anchor" aria-label="anchor" href="#arg-modification-probabilities"></a></dt>
<dd><p><code>character vector</code>. One character value for each sequence, storing a condensed string (e.g. <code>"0,128,255,15"</code>, produced via <code><a href="vector_to_string.html">vector_to_string()</a></code>) of the probability of methylation/modification at each assessed base.<br><br> Assumed to be Nanopore &gt; SAM style modification stored as an 8-bit integer from 0 to 255, but changing other arguments could make this work on other scales.</p></dd>


<dt id="arg-sequences">sequences<a class="anchor" aria-label="anchor" href="#arg-sequences"></a></dt>
<dd><p><code>character vector</code>. One character value for each sequence, storing the actual DNA sequence.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Used to recognise aliases e.g. American spellings or common misspellings - see <a href="ggDNAvis_aliases.html">aliases</a>. If any American spellings do not work, please make a bug report at <a href="https://github.com/ejade42/ggDNAvis/issues" class="external-link">https://github.com/ejade42/ggDNAvis/issues</a>.</p></dd>


<dt id="arg-low-colour">low_colour<a class="anchor" aria-label="anchor" href="#arg-low-colour"></a></dt>
<dd><p><code>character</code>. The colour that should be used to represent minimum probability of methylation/modification (defaults to blue).</p></dd>


<dt id="arg-high-colour">high_colour<a class="anchor" aria-label="anchor" href="#arg-high-colour"></a></dt>
<dd><p><code>character</code>. The colour that should be used to represent maximum probability of methylation/modification (defaults to red).</p></dd>


<dt id="arg-low-clamp">low_clamp<a class="anchor" aria-label="anchor" href="#arg-low-clamp"></a></dt>
<dd><p><code>numeric</code>. The minimum probability below which all values are coloured <code>low_colour</code>. Defaults to <code>0</code> (i.e. no clamping). To specify a proportion probability in 8-bit form, multiply by 255 e.g. to low-clamp at 30% probability, set this to <code>0.3*255</code>.</p></dd>


<dt id="arg-high-clamp">high_clamp<a class="anchor" aria-label="anchor" href="#arg-high-clamp"></a></dt>
<dd><p><code>numeric</code>. The maximum probability above which all values are coloured <code>high_colour</code>. Defaults to <code>255</code> (i.e. no clamping, assuming Nanopore &gt; SAM style modification calling where probabilities are 8-bit integers from 0 to 255).</p></dd>


<dt id="arg-background-colour">background_colour<a class="anchor" aria-label="anchor" href="#arg-background-colour"></a></dt>
<dd><p><code>character</code>. The colour the background should be drawn (defaults to white).</p></dd>


<dt id="arg-other-bases-colour">other_bases_colour<a class="anchor" aria-label="anchor" href="#arg-other-bases-colour"></a></dt>
<dd><p><code>character</code>. The colour non-assessed (e.g. non-CpG) bases should be drawn (defaults to grey).</p></dd>


<dt id="arg-sequence-text-type">sequence_text_type<a class="anchor" aria-label="anchor" href="#arg-sequence-text-type"></a></dt>
<dd><p><code>character</code>. What type of text should be drawn in the boxes. One of <code>"sequence"</code> (to draw the base sequence in the boxes, similar to <code><a href="visualise_many_sequences.html">visualise_many_sequences()</a></code>), <code>"probability"</code> (to draw the numerical probability of methylation in each assessed box, optionally scaled via <code>sequence_text_scaling</code>), or <code>"none"</code> (default, to draw the boxes only with no text).</p></dd>


<dt id="arg-sequence-text-scaling">sequence_text_scaling<a class="anchor" aria-label="anchor" href="#arg-sequence-text-scaling"></a></dt>
<dd><p><code>numeric vector, length 2</code>. The min and max possible probability values, used to facilitate scaling of the text in each to 0-1. Scaling is implemented as \(\frac{p - min}{max}\), so custom scalings (e.g. scaled to 0-9 space) can be implemented by setting this values as required.<br><br> Set to <code>c(0, 1)</code> to not scale at all i.e. print the raw integer probability values. It is recommended to also set <code>sequence_text_rounding = 0</code> to print integers as the default value of <code>2</code> will result in e.g. <code>"128.00"</code>. <br><br> Set to <code>c(-0.5, 256)</code> (default, results in \(\frac{p+0.5}{256}\)) to scale to the centre of the probability spaces defined by the SAMtools spec, where integer \(p\) represents the probability space from \(\frac{p}{256}\) to \(\frac{p+1}{256}\). This is slightly better at representing the uncertainty compared to <code>c(0, 255)</code> as strictly speaking <code>0</code> represents the probability space from 0.000 to 0.004 and <code>255</code> represents the probability space from 0.996 to 1.000, so scaling them to 0.002 and 0.998 respectively is a more accurate representation of the probability space they each represent. Setting <code>c(0, 255)</code> would scale such that 0 is exactly 0.000 and 255 is exactly 1.000, which is not as accurate so it discouraged.</p></dd>


<dt id="arg-sequence-text-rounding">sequence_text_rounding<a class="anchor" aria-label="anchor" href="#arg-sequence-text-rounding"></a></dt>
<dd><p><code>integer</code>. How many decimal places the text drawn in the boxes should be rounded to (defaults to <code>2</code>). Ignored if <code>sequence_text_type</code> is <code>"sequence"</code> or <code>"none"</code>.</p></dd>


<dt id="arg-sequence-text-colour">sequence_text_colour<a class="anchor" aria-label="anchor" href="#arg-sequence-text-colour"></a></dt>
<dd><p><code>character</code>. The colour of the text within the bases (e.g. colour of "A" letter within boxes representing adenosine bases). Defaults to black.</p></dd>


<dt id="arg-sequence-text-size">sequence_text_size<a class="anchor" aria-label="anchor" href="#arg-sequence-text-size"></a></dt>
<dd><p><code>numeric</code>. The size of the text within the bases (e.g. size of "A" letter within boxes representing adenosine bases). Defaults to <code>16</code>. Set to <code>0</code> to hide sequence text (show box colours only).</p></dd>


<dt id="arg-index-annotation-lines">index_annotation_lines<a class="anchor" aria-label="anchor" href="#arg-index-annotation-lines"></a></dt>
<dd><p><code>integer vector</code>. The lines (i.e. elements of <code>sequences_vector</code>) that should have their base incides annotated. 1-indexed e.g. <code>c(1, 10)</code> would annotate the first and tenth elements of <code>sequences_vector</code>.<br><br> Extra lines are inserted above or below (depending on <code>index_annotations_above</code>) the selected lines - note that the line numbers come from <code>sequences_vector</code>, so are unaffected by these insertions.<br><br> Setting to <code>NA</code> disables index annotations (and prevents adding additional blank lines). Defaults to <code>c(1)</code> i.e. first sequence is annotated.<br><br> Note: <code>visualise_methylation()</code> and <code><a href="visualise_many_sequences.html">visualise_many_sequences()</a></code> accept <code>NA</code>, <code>NULL</code>, <code>numeric(0)</code>, <code>0</code>, and <code>FALSE</code> as meaning "annotations off".</p></dd>


<dt id="arg-index-annotation-colour">index_annotation_colour<a class="anchor" aria-label="anchor" href="#arg-index-annotation-colour"></a></dt>
<dd><p><code>character</code>. The colour of the little numbers underneath indicating base index (e.g. colour of "15" label under the 15th base). Defaults to dark red.</p></dd>


<dt id="arg-index-annotation-size">index_annotation_size<a class="anchor" aria-label="anchor" href="#arg-index-annotation-size"></a></dt>
<dd><p><code>numeric</code>. The size of the little number underneath indicating base index (e.g. size of "15" label under the 15th base). Defaults to <code>12.5</code>.<br><br> Setting to <code>0</code> disables index annotations (and prevents adding additional blank lines).</p></dd>


<dt id="arg-index-annotation-interval">index_annotation_interval<a class="anchor" aria-label="anchor" href="#arg-index-annotation-interval"></a></dt>
<dd><p><code>integer</code>. The frequency at which numbers should be placed underneath indicating base index, starting counting from the leftmost base. Defaults to <code>15</code> (every 15 bases along each row).<br><br> Setting to <code>0</code> disables index annotations (and prevents adding additional blank lines).</p></dd>


<dt id="arg-index-annotations-above">index_annotations_above<a class="anchor" aria-label="anchor" href="#arg-index-annotations-above"></a></dt>
<dd><p><code>logical</code>. Whether index annotations should go above (<code>TRUE</code>, default) or below (<code>FALSE</code>) each line of sequence.</p></dd>


<dt id="arg-index-annotation-vertical-position">index_annotation_vertical_position<a class="anchor" aria-label="anchor" href="#arg-index-annotation-vertical-position"></a></dt>
<dd><p><code>numeric</code>. How far annotation numbers should be rendered above (if <code>index_annotations_above = TRUE</code>) or below (if <code>index_annotations_above = FALSE</code>) each base. Defaults to <code>1/3</code>.<br><br> Not recommended to change at all. Strongly discouraged to set below 0 or above 1.</p></dd>


<dt id="arg-index-annotation-full-line">index_annotation_full_line<a class="anchor" aria-label="anchor" href="#arg-index-annotation-full-line"></a></dt>
<dd><p><code>logical</code>. Whether index annotations should continue to the end of the longest sequence (<code>TRUE</code>, default) or should only continue as far as each selected line does (<code>FALSE</code>).</p></dd>


<dt id="arg-index-annotation-always-first-base">index_annotation_always_first_base<a class="anchor" aria-label="anchor" href="#arg-index-annotation-always-first-base"></a></dt>
<dd><p><code>logical</code>. Whether to force the first base in each line to always be annotated regardless of whether it occurs at the <code>index_annotation_interval</code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-index-annotation-always-last-base">index_annotation_always_last_base<a class="anchor" aria-label="anchor" href="#arg-index-annotation-always-last-base"></a></dt>
<dd><p><code>logical</code>. Whether to force the last base in each line to always be annotated regardless of whether it occurs at the <code>index_annotation_interval</code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-outline-colour">outline_colour<a class="anchor" aria-label="anchor" href="#arg-outline-colour"></a></dt>
<dd><p><code>character</code>. The colour of the box outlines. Defaults to black.</p></dd>


<dt id="arg-outline-linewidth">outline_linewidth<a class="anchor" aria-label="anchor" href="#arg-outline-linewidth"></a></dt>
<dd><p><code>numeric</code>. The linewidth of the box outlines. Defaults to <code>3</code>. Set to <code>0</code> to disable box outlines.</p></dd>


<dt id="arg-outline-join">outline_join<a class="anchor" aria-label="anchor" href="#arg-outline-join"></a></dt>
<dd><p><code>character</code>. One of <code>"mitre"</code>, <code>"round"</code>, or <code>"bevel"</code> specifying how outlines should be joined at the corners of boxes. Defaults to <code>"mitre"</code>. It would be unusual to need to change this.</p></dd>


<dt id="arg-modified-bases-outline-colour">modified_bases_outline_colour<a class="anchor" aria-label="anchor" href="#arg-modified-bases-outline-colour"></a></dt>
<dd><p><code>character</code>. If <code>NA</code> (default), inherits from <code>outline_colour</code>. If not <code>NA</code>, overrides <code>outline_colour</code> for modification-assessed bases only.</p></dd>


<dt id="arg-modified-bases-outline-linewidth">modified_bases_outline_linewidth<a class="anchor" aria-label="anchor" href="#arg-modified-bases-outline-linewidth"></a></dt>
<dd><p><code>numeric</code>. If <code>NA</code> (default), inherits from <code>outline_linewidth</code>. If not <code>NA</code>, overrides <code>outline_linewidth</code> for modification-assessed bases only.</p></dd>


<dt id="arg-modified-bases-outline-join">modified_bases_outline_join<a class="anchor" aria-label="anchor" href="#arg-modified-bases-outline-join"></a></dt>
<dd><p><code>character</code>. If <code>NA</code> (default), inherits from <code>outline_join</code>. If not <code>NA</code>, overrides <code>outline_join</code> for modification-assessed bases only.</p></dd>


<dt id="arg-other-bases-outline-colour">other_bases_outline_colour<a class="anchor" aria-label="anchor" href="#arg-other-bases-outline-colour"></a></dt>
<dd><p><code>character</code>. If <code>NA</code> (default), inherits from <code>outline_colour</code>. If not <code>NA</code>, overrides <code>outline_colour</code> for non-modification-assessed bases only.</p></dd>


<dt id="arg-other-bases-outline-linewidth">other_bases_outline_linewidth<a class="anchor" aria-label="anchor" href="#arg-other-bases-outline-linewidth"></a></dt>
<dd><p><code>numeric</code>. If <code>NA</code> (default), inherits from <code>outline_linewidth</code>. If not <code>NA</code>, overrides <code>outline_linewidth</code> for non-modification-assessed bases only.</p></dd>


<dt id="arg-other-bases-outline-join">other_bases_outline_join<a class="anchor" aria-label="anchor" href="#arg-other-bases-outline-join"></a></dt>
<dd><p><code>character</code>. If <code>NA</code> (default), inherits from <code>outline_join</code>. If not <code>NA</code>, overrides <code>outline_join</code> for non-modification-assessed bases only.</p></dd>


<dt id="arg-margin">margin<a class="anchor" aria-label="anchor" href="#arg-margin"></a></dt>
<dd><p><code>numeric</code>. The size of the margin relative to the size of each base square. Defaults to <code>0.5</code> (half the side length of each base square).<br><br> Note that index annotations can require a minimum margin size at the top or bottom if present above the first/below the last row. This is handled automatically but can mean the top/bottom margin is sometimes larger than the <code>margin</code> setting.<br><br> Very small margins (\(\le\)0.25) may cause thick outlines to be cut off at the edges of the plot. Recommended to either use a wider margin or a smaller <code>outline_linewidth</code>.</p></dd>


<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p><code>logical</code>. Boolean specifying whether this function should return the ggplot object, otherwise it will return <code>invisible(NULL)</code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p><code>character</code>. Filename to which output should be saved. If set to <code>NA</code> (default), no file will be saved. Recommended to end with <code>".png"</code>, but can change if render device is changed.</p></dd>


<dt id="arg-force-raster">force_raster<a class="anchor" aria-label="anchor" href="#arg-force-raster"></a></dt>
<dd><p><code>logical</code>. Boolean specifying whether <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster()</a></code> should be used even if it will remove text and outlines. Defaults to <code>FALSE</code>.<br><br> To make the detailed plots with box outlines, sequence text, and index annotations, <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile()</a></code> is used. However, <code>geom_tile</code> is slower for huge datasets, so there is an option to use <code>geom_raster</code> instead. <code>geom_raster</code> does not support box outlines, sequence text, or index annotations, but is much faster if only the colours are wanted.<br><br><code>geom_raster</code> is automatically used if it will not change the plot (i.e. if all extraneous elements are already off), but can be forced using this argument.</p></dd>


<dt id="arg-render-device">render_device<a class="anchor" aria-label="anchor" href="#arg-render-device"></a></dt>
<dd><p><code>function/character</code>. Device to use when rendering. See <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code> documentation for options. Defaults to <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png</a></code>. Can be set to <code>NULL</code> to infer from file extension, but results may vary between systems.</p></dd>


<dt id="arg-pixels-per-base">pixels_per_base<a class="anchor" aria-label="anchor" href="#arg-pixels-per-base"></a></dt>
<dd><p><code>integer</code>. How large each box should be in pixels, if file output is turned on via setting <code>filename</code>. Corresponds to dpi of the exported image. Defaults to <code>100</code>.<br><br> Large values (e.g. 100) are required to render small text properly. Small values (e.g. 20) will work when sequence/annotation text is off, and very small values (e.g. 10) will work when sequence/annotation text and outlines are all off.</p></dd>


<dt id="arg-monitor-performance">monitor_performance<a class="anchor" aria-label="anchor" href="#arg-monitor-performance"></a></dt>
<dd><p><code>logical</code>. Boolean specifying whether verbose performance monitoring should be messaged to console. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object containing the full visualisation, or <code>invisible(NULL)</code> if <code>return = FALSE</code>. It is often more useful to use <code>filename = "myfilename.png"</code>, because then the visualisation is exported at the correct aspect ratio.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Extract info from dataframe</span></span></span>
<span class="r-in"><span><span class="va">methylation_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_and_sort_methylation.html">extract_and_sort_methylation</a></span><span class="op">(</span><span class="va">example_many_sequences</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualise example_many_sequences with all defaults</span></span></span>
<span class="r-in"><span><span class="co">## This looks ugly because it isn't at the right scale/aspect ratio</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with all defaults rather than returning</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vm_01.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vm_01.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vm_01.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with customisation</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vm_02.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    other_bases_colour <span class="op">=</span> <span class="st">"lightblue1"</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    margin <span class="op">=</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vm_02.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vm_02.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with customisation, viewing sequences</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vm_03.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    low_colour <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>    high_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    sequence_text_type <span class="op">=</span> <span class="st">"sequence"</span>,</span></span>
<span class="r-in"><span>    sequence_text_colour <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    other_bases_colour <span class="op">=</span> <span class="st">"lightblue1"</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    margin <span class="op">=</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vm_03.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vm_03.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with customisation, viewing probabilities</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vm_04.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    low_colour <span class="op">=</span> <span class="st">"cyan"</span>,</span></span>
<span class="r-in"><span>    high_colour <span class="op">=</span> <span class="st">"yellow"</span>,</span></span>
<span class="r-in"><span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span></span>
<span class="r-in"><span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    sequence_text_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    other_bases_colour <span class="op">=</span> <span class="st">"lightgreen"</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    margin <span class="op">=</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vm_04.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vm_04.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Export with customisation, viewing probability integers</span></span></span>
<span class="r-in"><span><span class="fu">visualise_methylation</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">locations</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">probabilities</span>,</span></span>
<span class="r-in"><span>    <span class="va">methylation_info</span><span class="op">$</span><span class="va">sequences</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"example_vm_05.png"</span>,</span></span>
<span class="r-in"><span>    return <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    low_colour <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>    high_colour <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>    low_clamp <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    high_clamp <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">255</span>,</span></span>
<span class="r-in"><span>    sequence_text_type <span class="op">=</span> <span class="st">"probability"</span>,</span></span>
<span class="r-in"><span>    sequence_text_scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sequence_text_rounding <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    sequence_text_size <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    sequence_text_colour <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>    index_annotation_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">23</span>, <span class="fl">37</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    index_annotation_interval <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    index_annotation_full_line <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_first_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    index_annotation_always_last_base <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_linewidth <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    other_bases_outline_colour <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_linewidth <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    modified_bases_outline_colour <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>    margin <span class="op">=</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## View exported image</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="st">"example_vm_05.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"example_vm_05.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualise_methylation-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evelyn Jade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert MM tag to absolute index locations (read_modified_fastq() helper) — convert_MM_vector_to_locations • ggDNAvis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Convert MM tag to absolute index locations (read_modified_fastq() helper) — convert_MM_vector_to_locations"><meta name="description" content='This function takes a sequence, a SAM-style vector of number of potential
target bases to skip in between each target base that was actually assessed,
and a target base type (defaults to "C" as 5-methylcytosine is most common).
It identifies the indices/locations of all instances of the target base within the
sequence, and then goes along the vector of these indices, skipping them if requested
by skips.
For example, the sequence "GGCGGCGGCGGC" with target "C" and skips c(0, 0, 1)
would identify that the indices where "C" occurs are c(3, 6, 9, 12). It would then
take the first index, the second index, skip one, and take the fourth index i.e.
return c(3, 6, 12). If instead the skips were given as c(0, 2) it would take the
first index, skip two, and take the fourth index i.e. return c(3, 12). If the skips
were given as c(1, 1) it would skip one, take the second index, skip one, and take
the fourth index i.e. return c(6, 12).
The length of skips corresponds to the number of indices/locations that will be returned
(i.e. the length of the returned locations vector).
Ideally the length of skips plus the sum of skips (i.e. the number returned plus the
total number skipped) is the same or less than the number of possible locations. If it is
the same, then the last possible location will be taken; if it is less then some number of
possible locations at the end will be skipped.
Important: if the length of skips plus the sum of skips is greater than the number
of possible locations (instances of the target base within the sequence), then the total
number of taken or skipped locations will be greater than the number of available locations.
In this case, the returned vector will contain NA after the available locations have run out.
In the example above, skips = c(0, 0, 0, 0, 0) would return c(3, 6, 9, 12, NA), and
skips = c(0, 2, 0) would return c(3, 12, NA).
Therefore, if the target base is totally absent from the sequence (e.g. target "A" in
"GGCGGCGGCGGC"), then any non-zero length of skips will return the same length of NAs e.g.
skips = c(0) would return NA, and skips = c(0, 1, 0) would return c(NA, NA, NA).
If skips has length zero, it will return numeric(0).
This function is reversed by convert_locations_to_MM_vector().'><meta property="og:description" content='This function takes a sequence, a SAM-style vector of number of potential
target bases to skip in between each target base that was actually assessed,
and a target base type (defaults to "C" as 5-methylcytosine is most common).
It identifies the indices/locations of all instances of the target base within the
sequence, and then goes along the vector of these indices, skipping them if requested
by skips.
For example, the sequence "GGCGGCGGCGGC" with target "C" and skips c(0, 0, 1)
would identify that the indices where "C" occurs are c(3, 6, 9, 12). It would then
take the first index, the second index, skip one, and take the fourth index i.e.
return c(3, 6, 12). If instead the skips were given as c(0, 2) it would take the
first index, skip two, and take the fourth index i.e. return c(3, 12). If the skips
were given as c(1, 1) it would skip one, take the second index, skip one, and take
the fourth index i.e. return c(6, 12).
The length of skips corresponds to the number of indices/locations that will be returned
(i.e. the length of the returned locations vector).
Ideally the length of skips plus the sum of skips (i.e. the number returned plus the
total number skipped) is the same or less than the number of possible locations. If it is
the same, then the last possible location will be taken; if it is less then some number of
possible locations at the end will be skipped.
Important: if the length of skips plus the sum of skips is greater than the number
of possible locations (instances of the target base within the sequence), then the total
number of taken or skipped locations will be greater than the number of available locations.
In this case, the returned vector will contain NA after the available locations have run out.
In the example above, skips = c(0, 0, 0, 0, 0) would return c(3, 6, 9, 12, NA), and
skips = c(0, 2, 0) would return c(3, 12, NA).
Therefore, if the target base is totally absent from the sequence (e.g. target "A" in
"GGCGGCGGCGGC"), then any non-zero length of skips will return the same length of NAs e.g.
skips = c(0) would return NA, and skips = c(0, 1, 0) would return c(NA, NA, NA).
If skips has length zero, it will return numeric(0).
This function is reversed by convert_locations_to_MM_vector().'><meta property="og:image" content="https://ejade42.github.io/ggDNAvis/logo.png"></head><body><p>









  pkgdown/google0acd00d8574ec2df.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggDNAvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ejade42/ggDNAvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Convert MM tag to absolute index locations (<code><a href="read_modified_fastq.html">read_modified_fastq()</a></code> helper)</h1>
      <small class="dont-index">Source: <a href="https://github.com/ejade42/ggDNAvis/blob/main/R/parse_methylation_from_fastq.R" class="external-link"><code>R/parse_methylation_from_fastq.R</code></a></small>
      <div class="d-none name"><code>convert_MM_vector_to_locations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a sequence, a SAM-style vector of number of potential
target bases to skip in between each target base that was actually assessed,
and a target base type (defaults to <code>"C"</code> as 5-methylcytosine is most common).<br><br>
It identifies the indices/locations of all instances of the target base within the
sequence, and then goes along the vector of these indices, skipping them if requested
by <code>skips</code>.<br><br>
For example, the sequence <code>"GGCGGCGGCGGC"</code> with target <code>"C"</code> and skips <code>c(0, 0, 1)</code>
would identify that the indices where <code>"C"</code> occurs are <code>c(3, 6, 9, 12)</code>. It would then
take the first index, the second index, skip one, and take the fourth index i.e.
return <code>c(3, 6, 12)</code>. If instead the skips were given as <code>c(0, 2)</code> it would take the
first index, skip two, and take the fourth index i.e. return <code>c(3, 12)</code>. If the skips
were given as <code>c(1, 1)</code> it would skip one, take the second index, skip one, and take
the fourth index i.e. return <code>c(6, 12)</code>. <br><br>
The length of <code>skips</code> corresponds to the number of indices/locations that will be returned
(i.e. the length of the returned locations vector).<br><br>
Ideally the length of <code>skips</code> plus the sum of <code>skips</code> (i.e. the number returned plus the
total number skipped) is the same or less than the number of possible locations. If it is
the same, then the last possible location will be taken; if it is less then some number of
possible locations at the end will be skipped.<br><br><strong>Important:</strong> if the length of <code>skips</code> plus the sum of <code>skips</code> is greater than the number
of possible locations (instances of the target base within the sequence), then the total
number of taken or skipped locations will be greater than the number of available locations.
In this case, the returned vector will contain NA after the available locations have run out.
In the example above, <code>skips = c(0, 0, 0, 0, 0)</code> would return <code>c(3, 6, 9, 12, NA)</code>, and
<code>skips = c(0, 2, 0)</code> would return <code>c(3, 12, NA)</code>.<br><br>
Therefore, if the target base is totally absent from the sequence (e.g. target <code>"A"</code> in
<code>"GGCGGCGGCGGC"</code>), then any non-zero length of <code>skips</code> will return the same length of <code>NA</code>s e.g.
<code>skips = c(0)</code> would return <code>NA</code>, and <code>skips = c(0, 1, 0)</code> would return <code>c(NA, NA, NA)</code>.<br><br>
If <code>skips</code> has length zero, it will return <code>numeric(0)</code>.<br><br>
This function is reversed by <code><a href="convert_locations_to_MM_vector.html">convert_locations_to_MM_vector()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">convert_MM_vector_to_locations</span><span class="op">(</span><span class="va">sequence</span>, <span class="va">skips</span>, target_base <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sequence">sequence<a class="anchor" aria-label="anchor" href="#arg-sequence"></a></dt>
<dd><p><code>character</code>. The DNA sequence about which the methylation information is being processed.</p></dd>


<dt id="arg-skips">skips<a class="anchor" aria-label="anchor" href="#arg-skips"></a></dt>
<dd><p><code>integer vector</code>. A component of a SAM MM tag, representing the number of skipped target bases in between each assessed base.</p></dd>


<dt id="arg-target-base">target_base<a class="anchor" aria-label="anchor" href="#arg-target-base"></a></dt>
<dd><p><code>character</code>. The base type that has been assessed or skipped (defaults to <code>"C"</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>integer vector</code>. All of the base indices at which methylation/modification information was processed. Will all be instances of the target base.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">convert_MM_vector_to_locations</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"GGCGGCGGCGGC"</span>,</span></span>
<span class="r-in"><span>    skips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    target_base <span class="op">=</span> <span class="st">"C"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  3  6  9 12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">convert_MM_vector_to_locations</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"GGCGGCGGCGGC"</span>,</span></span>
<span class="r-in"><span>    skips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    target_base <span class="op">=</span> <span class="st">"G"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2  5  8 11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">convert_MM_vector_to_locations</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"GGCGGCGGCGGC"</span>,</span></span>
<span class="r-in"><span>    skips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    target_base <span class="op">=</span> <span class="st">"G"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  2  7 10 11</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evelyn Jade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  
</body></html>


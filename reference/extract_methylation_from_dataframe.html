<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract methylation information from dataframe for visualisation — extract_methylation_from_dataframe • ggDNAvis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Extract methylation information from dataframe for visualisation — extract_methylation_from_dataframe"><meta name="description" content='This function takes a dataframe that contains methylation information in the form of
locations (indices along the read signifying bases at which modification probability
was assessed) and  probabilities (the probability of modification at each assessed
location, as an integer from 0 to 255).
Each observation/row in the dataframe represents one sequence (e.g. a Nanopore read).
In the locations and probabilities column, each sequence (row) has many numbers associated.
These are stored as one string per observation e.g. "3,6,9,12", with the column representing
a character vector of such strings (e.g. c("3,6,9,12", "1,2,3,4")).
This function calls extract_and_sort_sequences() on each of these three columns and returns
a list of vectors stored in $locations, $probabilities, and $lengths.
These can then be used as input for visualise_methylation().
Default arguments are set up to work with the included example_many_sequences data.'><meta property="og:description" content='This function takes a dataframe that contains methylation information in the form of
locations (indices along the read signifying bases at which modification probability
was assessed) and  probabilities (the probability of modification at each assessed
location, as an integer from 0 to 255).
Each observation/row in the dataframe represents one sequence (e.g. a Nanopore read).
In the locations and probabilities column, each sequence (row) has many numbers associated.
These are stored as one string per observation e.g. "3,6,9,12", with the column representing
a character vector of such strings (e.g. c("3,6,9,12", "1,2,3,4")).
This function calls extract_and_sort_sequences() on each of these three columns and returns
a list of vectors stored in $locations, $probabilities, and $lengths.
These can then be used as input for visualise_methylation().
Default arguments are set up to work with the included example_many_sequences data.'><meta property="og:image" content="https://ejade42.github.io/ggDNAvis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggDNAvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-version" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Version</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-version"><li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/">Latest release</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/dev/">Latest dev</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.2/">v0.3.2</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.1/">v0.3.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.3.0/">v0.3.0</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.1/">v0.2.1</a></li>
    <li><a class="dropdown-item" href="https://ejade42.github.io/ggDNAvis/v0.2.0/">v0.2.0</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ejade42/ggDNAvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract methylation information from dataframe for visualisation</h1>
      <small class="dont-index">Source: <a href="https://github.com/ejade42/ggDNAvis/blob/main/R/visualise_methylation.R" class="external-link"><code>R/visualise_methylation.R</code></a></small>
      <div class="d-none name"><code>extract_methylation_from_dataframe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a dataframe that contains methylation information in the form of
locations (indices along the read signifying bases at which modification probability
was assessed) and  probabilities (the probability of modification at each assessed
location, as an integer from 0 to 255).<br><br>
Each observation/row in the dataframe represents one sequence (e.g. a Nanopore read).
In the locations and probabilities column, each sequence (row) has many numbers associated.
These are stored as one string per observation e.g. <code>"3,6,9,12"</code>, with the column representing
a character vector of such strings (e.g. <code>c("3,6,9,12", "1,2,3,4")</code>).<br><br>
This function calls <code><a href="extract_and_sort_sequences.html">extract_and_sort_sequences()</a></code> on each of these three columns and returns
a list of vectors stored in <code>$locations</code>, <code>$probabilities</code>, and <code>$lengths</code>.
These can then be used as input for <code><a href="visualise_methylation.html">visualise_methylation()</a></code>. <br><br>
Default arguments are set up to work with the included <code><a href="example_many_sequences.html">example_many_sequences</a></code> data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_methylation_from_dataframe</span><span class="op">(</span></span>
<span>  <span class="va">modification_data</span>,</span>
<span>  locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span>
<span>  probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span>
<span>  lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>  grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>family <span class="op">=</span> <span class="fl">8</span>, individual <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span>
<span>  desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-modification-data">modification_data<a class="anchor" aria-label="anchor" href="#arg-modification-data"></a></dt>
<dd><p><code>dataframe</code>. A dataframe that must contain columns for methylation locations, methylation probabilities, and sequence length for each read. The former two should be condensed strings as produced by <code><a href="vector_to_string.html">vector_to_string()</a></code> e.g. <code>"1,2,3,4"</code>. The latter should be integer.<br><br> See <code><a href="example_many_sequences.html">example_many_sequences</a></code> for an example of a compatible dataframe.</p></dd>


<dt id="arg-locations-colname">locations_colname<a class="anchor" aria-label="anchor" href="#arg-locations-colname"></a></dt>
<dd><p><code>character</code>. The name of the column within the input dataframe that contains methylation/modification location information. Defaults to <code>"methylation_locations"</code>.<br><br> Values within this column must be a comma-separated string representing a condensed numerical vector (e.g. <code>"3,6,9,12"</code>, produced via <code><a href="vector_to_string.html">vector_to_string()</a></code>) of the indices along the read at which modification was assessed. Indexing starts at 1.</p></dd>


<dt id="arg-probabilities-colname">probabilities_colname<a class="anchor" aria-label="anchor" href="#arg-probabilities-colname"></a></dt>
<dd><p><code>character</code>. The name of the column within the input dataframe that contains methylation/modification probability information. Defaults to <code>"methylation_probabilities"</code>.<br><br> Values within this column must be a comma-separated string representing a condensed numerical vector (e.g. <code>"2,212,128,64"</code>, produced via <code><a href="vector_to_string.html">vector_to_string()</a></code>) of the probability of modification as an 8-bit (0-255) integer for each base where modification was assessed.</p></dd>


<dt id="arg-lengths-colname">lengths_colname<a class="anchor" aria-label="anchor" href="#arg-lengths-colname"></a></dt>
<dd><p><code>character</code>. The name of the column within the input dataframe that contains the length of each sequence. Defaults to <code>"sequence_length"</code>.<br><br> Values within this column must be non-negative integers.</p></dd>


<dt id="arg-grouping-levels">grouping_levels<a class="anchor" aria-label="anchor" href="#arg-grouping-levels"></a></dt>
<dd><p><code>named character vector</code>. What variables should be used to define the groups/chunks, and how large a gap should be left between groups at that level. Set to <code>NA</code> to turn off grouping.<br><br> Defaults to <code>c("family" = 8, "individual" = 2)</code>, meaning the highest-level groups are defined by the <code>family</code> column, and there is a gap of 8 between each family. Likewise the second-level groups (within each family) are defined by the <code>individual</code> column, and there is a gap of 2 between each individual.<br><br> Any number of grouping variables and gaps can be given, as long as each grouping variable is a column within the dataframe. It is recommended that lower-level groups are more granular and subdivide higher-level groups (e.g. first divide into families, then into individuals within families). <br><br> To change the order of groups within a level, make that column a factor with the order specified e.g. <code>example_many_sequences$family &lt;- factor(example_many_sequences$family, levels = c("Family 2", "Family 3", "Family 1"))</code> to change the order to Family 2, Family 3, Family 1.</p></dd>


<dt id="arg-sort-by">sort_by<a class="anchor" aria-label="anchor" href="#arg-sort-by"></a></dt>
<dd><p><code>character</code>. The name of the column within the dataframe that should be used to sort/order the rows within each lowest-level group. Set to <code>NA</code> to turn off sorting within groups.<br><br> Recommended to be the length of the sequence information, as is the case for the default <code>"sequence_length"</code> which was generated via <code>example_many_sequences$sequence_legnth &lt;- nchar(example_many_sequences$sequence)</code>.</p></dd>


<dt id="arg-desc-sort">desc_sort<a class="anchor" aria-label="anchor" href="#arg-desc-sort"></a></dt>
<dd><p><code>logical</code>. Boolean specifying whether rows within groups should be sorted by the <code>sort_by</code> variable descending (<code>TRUE</code>, default) or ascending (<code>FALSE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>list</code>, containing <code>$locations</code> (<code>character vector</code>), <code>$probabilities</code> (<code>character vector</code>), and <code>$lengths</code> (<code>numeric vector</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## See documentation for extract_and_sort_sequences()</span></span></span>
<span class="r-in"><span><span class="co">## for more examples of changing sorting/grouping</span></span></span>
<span class="r-in"><span><span class="fu">extract_methylation_from_dataframe</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">example_many_sequences</span>,</span></span>
<span class="r-in"><span>    locations_colname <span class="op">=</span> <span class="st">"methylation_locations"</span>,</span></span>
<span class="r-in"><span>    probabilities_colname <span class="op">=</span> <span class="st">"methylation_probabilities"</span>,</span></span>
<span class="r-in"><span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span></span>
<span class="r-in"><span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span></span>
<span class="r-in"><span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in extract_methylation_from_dataframe(example_many_sequences, locations_colname = "methylation_locations",     probabilities_colname = "methylation_probabilities", lengths_colname = "sequence_length",     grouping_levels = c(family = 8, individual = 2), sort_by = "sequence_length",     desc_sort = TRUE):</span> '...' used in an incorrect context</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract_methylation_from_dataframe</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">example_many_sequences</span>,</span></span>
<span class="r-in"><span>    locations_colname <span class="op">=</span> <span class="st">"hydroxymethylation_locations"</span>,</span></span>
<span class="r-in"><span>    probabilities_colname <span class="op">=</span> <span class="st">"hydroxymethylation_probabilities"</span>,</span></span>
<span class="r-in"><span>    lengths_colname <span class="op">=</span> <span class="st">"sequence_length"</span>,</span></span>
<span class="r-in"><span>    grouping_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"individual"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sort_by <span class="op">=</span> <span class="st">"sequence_length"</span>,</span></span>
<span class="r-in"><span>    desc_sort <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in extract_methylation_from_dataframe(example_many_sequences, locations_colname = "hydroxymethylation_locations",     probabilities_colname = "hydroxymethylation_probabilities",     lengths_colname = "sequence_length", grouping_levels = c(family = 8,         individual = 2), sort_by = "sequence_length", desc_sort = TRUE):</span> '...' used in an incorrect context</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evelyn Jade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

